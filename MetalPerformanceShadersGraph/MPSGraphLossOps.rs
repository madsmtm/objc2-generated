//! This file has been automatically generated by `objc2`'s `header-translator`.
//! DO NOT EDIT
use core::ptr::NonNull;
use objc2::__framework_prelude::*;
use objc2_foundation::*;

use crate::*;

/// The type of the reduction the graph applies in the loss operations.
/// The type of the reduction the graph applies in the loss operations.
// NS_ENUM
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord, Default)]
pub struct MPSGraphLossReductionType(pub u64);
impl MPSGraphLossReductionType {
    /// Computes the loss without reduction.
    /// Computes the loss without reduction.
    #[doc(alias = "MPSGraphLossReductionTypeNone")]
    pub const None: Self = Self(0);
    /// Computes the loss without reduction.
    /// Computes the loss without reduction.
    #[doc(alias = "MPSGraphLossReductionTypeAxis")]
    pub const Axis: Self = Self(MPSGraphLossReductionType::None.0);
    /// Reduces the loss down to a scalar with a sum operation.
    /// Reduces the loss down to a scalar with a sum operation.
    #[doc(alias = "MPSGraphLossReductionTypeSum")]
    pub const Sum: Self = Self(1);
    /// Reduces the loss down to a scalar with a mean operation.
    /// Reduces the loss down to a scalar with a mean operation.
    #[doc(alias = "MPSGraphLossReductionTypeMean")]
    pub const Mean: Self = Self(2);
}

unsafe impl Encode for MPSGraphLossReductionType {
    const ENCODING: Encoding = u64::ENCODING;
}

unsafe impl RefEncode for MPSGraphLossReductionType {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

/// MPSGraphLossOps.
#[cfg(all(feature = "MPSGraph", feature = "MPSGraphCore"))]
impl MPSGraph {
    extern_methods!(
        #[cfg(feature = "MPSGraphTensor")]
        /// Creates a softmax cross-entropy loss operation and returns the result tensor.
        ///
        /// The softmax cross-entropy operation computes:
        /// ```md
        /// loss = reduction( - labels*ln( softmax(source) )), where
        /// sotfmax(source) = exp(source) / sum( exp(source) ), and
        /// ```
        /// the operation performs the reduction over the `axis` dimension.
        ///
        /// - Parameters:
        /// - sourceTensor: The source tensor.
        /// - labelsTensor: The labels tensor.
        /// - axis: The axis over which the operation computes the softmax reduction.
        /// - reductionType: The type of reduction MPSGraph uses to reduce across all other axes than `axis`. See: ``MPSGraphLossReductionType``.
        /// - name: The name for the operation.
        /// - Returns: A valid MPSGraphTensor object.
        #[unsafe(method(softMaxCrossEntropyWithSourceTensor:labelsTensor:axis:reductionType:name:))]
        #[unsafe(method_family = none)]
        pub unsafe fn softMaxCrossEntropyWithSourceTensor_labelsTensor_axis_reductionType_name(
            &self,
            source_tensor: &MPSGraphTensor,
            labels_tensor: &MPSGraphTensor,
            axis: NSInteger,
            reduction_type: MPSGraphLossReductionType,
            name: Option<&NSString>,
        ) -> Retained<MPSGraphTensor>;

        #[cfg(feature = "MPSGraphTensor")]
        /// Creates the gradient of a softmax cross-entropy loss operation and returns the result tensor.
        ///
        /// - Parameters:
        /// - gradientTensor: The input gradientTensor. Note: in most cases this is the initial gradient tensor, which is a constant tensor with value one.
        /// - sourceTensor: The source tensor.
        /// - labelsTensor: The labels tensor.
        /// - axis: The axis over which the operation computes the softmax reduction.
        /// - reductionType: The type of reduction MPSGraph uses to reduce across all other axes than `axis`. See: ``MPSGraphLossReductionType``.
        /// - name: The name for the operation.
        /// - Returns: A valid MPSGraphTensor object.
        #[unsafe(method(softMaxCrossEntropyGradientWithIncomingGradientTensor:sourceTensor:labelsTensor:axis:reductionType:name:))]
        #[unsafe(method_family = none)]
        pub unsafe fn softMaxCrossEntropyGradientWithIncomingGradientTensor_sourceTensor_labelsTensor_axis_reductionType_name(
            &self,
            gradient_tensor: &MPSGraphTensor,
            source_tensor: &MPSGraphTensor,
            labels_tensor: &MPSGraphTensor,
            axis: NSInteger,
            reduction_type: MPSGraphLossReductionType,
            name: Option<&NSString>,
        ) -> Retained<MPSGraphTensor>;
    );
}
