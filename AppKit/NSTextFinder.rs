//! This file has been automatically generated by `objc2`'s `header-translator`.
//! DO NOT EDIT
use core::ffi::*;
use core::ptr::NonNull;
use objc2::__framework_prelude::*;
use objc2_foundation::*;

use crate::*;

/// These constants specify the user interface item tags that correspond find action. These constants are passed to the [`performTextFinderAction:`](https://developer.apple.com/documentation/appkit/nsresponder/performtextfinderaction(_:)) method, the responder will call the appropriate method for the tag. That method will, in turn, determine the desired action and invoke the appropriate method in the `NSTextFinder` object’s `NSTextFinderClient` protocol.
// NS_ENUM
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord)]
pub struct NSTextFinderAction(pub NSInteger);
impl NSTextFinderAction {
    /// The find bar interface is displayed.
    #[doc(alias = "NSTextFinderActionShowFindInterface")]
    pub const ShowFindInterface: Self = Self(1);
    /// The next match, if any, is displayed.
    #[doc(alias = "NSTextFinderActionNextMatch")]
    pub const NextMatch: Self = Self(2);
    /// The previous match, if any, is displayed.
    #[doc(alias = "NSTextFinderActionPreviousMatch")]
    pub const PreviousMatch: Self = Self(3);
    /// All occurrences of the string are replaced.
    #[doc(alias = "NSTextFinderActionReplaceAll")]
    pub const ReplaceAll: Self = Self(4);
    /// Replaces a single instance of the string.
    #[doc(alias = "NSTextFinderActionReplace")]
    pub const Replace: Self = Self(5);
    /// Replaces a single instance of the string and searches for the next match.
    #[doc(alias = "NSTextFinderActionReplaceAndFind")]
    pub const ReplaceAndFind: Self = Self(6);
    /// Sets the search string.
    #[doc(alias = "NSTextFinderActionSetSearchString")]
    pub const SetSearchString: Self = Self(7);
    /// Replaces all occurrences of the string within the current selection.
    #[doc(alias = "NSTextFinderActionReplaceAllInSelection")]
    pub const ReplaceAllInSelection: Self = Self(8);
    /// Selects all matching search strings.
    #[doc(alias = "NSTextFinderActionSelectAll")]
    pub const SelectAll: Self = Self(9);
    /// Selects all matching search strings within the current selection.
    #[doc(alias = "NSTextFinderActionSelectAllInSelection")]
    pub const SelectAllInSelection: Self = Self(10);
    /// Hides the find bar interface.
    #[doc(alias = "NSTextFinderActionHideFindInterface")]
    pub const HideFindInterface: Self = Self(11);
    /// Displays the find bar interface including the replace functionality.
    #[doc(alias = "NSTextFinderActionShowReplaceInterface")]
    pub const ShowReplaceInterface: Self = Self(12);
    /// Displays the find bar interface including the replace functionality.
    #[doc(alias = "NSTextFinderActionHideReplaceInterface")]
    pub const HideReplaceInterface: Self = Self(13);
}

unsafe impl Encode for NSTextFinderAction {
    const ENCODING: Encoding = NSInteger::ENCODING;
}

unsafe impl RefEncode for NSTextFinderAction {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

/// Search options for text in Finder.
// NS_TYPED_ENUM
pub type NSPasteboardTypeTextFinderOptionKey = NSString;

extern "C" {
    /// A Boolean value indicating whether the search is case insensitive.
    ///
    /// ## Discussion
    ///
    /// The value of this key must be an [`NSValue`](https://developer.apple.com/documentation/foundation/nsvalue) object containing a Boolean value. The value [`true`](https://developer.apple.com/documentation/swift/true) indicates a case-insensitive search; [`false`](https://developer.apple.com/documentation/swift/false) indicates a case-sensitive search.
    ///
    ///
    pub static NSTextFinderCaseInsensitiveKey: &'static NSPasteboardTypeTextFinderOptionKey;
}

extern "C" {
    /// A number object containing the match type to use.
    ///
    /// ## Discussion
    ///
    /// The value of this key must be an [`NSNumber`](https://developer.apple.com/documentation/foundation/nsnumber) containing an [`NSTextFinderMatchingType`](https://developer.apple.com/documentation/appkit/nstextfinder/matchingtype) value that indicates the type of search matching to perform.
    ///
    ///
    pub static NSTextFinderMatchingTypeKey: &'static NSPasteboardTypeTextFinderOptionKey;
}

/// The following constants indicate the type of search anchor an action should perform.
// NS_ENUM
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord, Default)]
pub struct NSTextFinderMatchingType(pub NSInteger);
impl NSTextFinderMatchingType {
    /// The match contains the string.
    #[doc(alias = "NSTextFinderMatchingTypeContains")]
    pub const Contains: Self = Self(0);
    /// The match begins with the string.
    #[doc(alias = "NSTextFinderMatchingTypeStartsWith")]
    pub const StartsWith: Self = Self(1);
    /// The match exactly matches the string.
    #[doc(alias = "NSTextFinderMatchingTypeFullWord")]
    pub const FullWord: Self = Self(2);
    /// The match ends with the string.
    #[doc(alias = "NSTextFinderMatchingTypeEndsWith")]
    pub const EndsWith: Self = Self(3);
}

unsafe impl Encode for NSTextFinderMatchingType {
    const ENCODING: Encoding = NSInteger::ENCODING;
}

unsafe impl RefEncode for NSTextFinderMatchingType {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

extern_class!(
    /// An optional search-and-replace find interface inside a view, usually a scroll view.
    ///
    /// ## Overview
    ///
    /// The class serves as a controller for the standard Cocoa find bar. The `NSTextFinder` class interacts heavily with a `client` object which supports the [`NSTextFinderClient`](https://developer.apple.com/documentation/appkit/nstextfinderclient) protocol. The client object provides access to the content being searched and provides visual feedback for a search operation.
    ///
    /// All menu items related to finding (Find…, Find Next, Find Previous, Use Selection for Find, etc.) should have the same action, [`performTextFinderAction:`](https://developer.apple.com/documentation/appkit/nsresponder/performtextfinderaction(_:)), which gets sent down the responder chain in the standard method.
    ///
    /// <div class="warning">
    ///
    /// ### Note
    ///  Before OS X v10.7, the default action for these menu items was [`performFindPanelAction:`](https://developer.apple.com/documentation/appkit/nstextview/performfindpanelaction(_:)). Applications that wish to use OS X v10.7 should adopt the new behavior, if appropriate.
    ///
    ///
    ///
    /// </div>
    /// ### Implementing a Find Bar
    ///
    /// A responder of [`performTextFinderAction:`](https://developer.apple.com/documentation/appkit/nsresponder/performtextfinderaction(_:)) is responsible for creating and owning an instance of `NSTextFinder`. Before any other messages are sent to the `NSTextFinder`, you should set its [`client`](https://developer.apple.com/documentation/appkit/nstextfinder/client) property to an object which implements the [`NSTextFinderClient`](https://developer.apple.com/documentation/appkit/nstextfinderclient) protocol.
    ///
    /// Each user interface item used for finding has a different tag value , which corresponds to the appropriate value in [`NSTextFinderAction`](https://developer.apple.com/documentation/appkit/nstextfinder/action). Upon receipt of the  [`performTextFinderAction:`](https://developer.apple.com/documentation/appkit/nsresponder/performtextfinderaction(_:)) message, the responder should call the following on its `NSTextFinder` instance:
    ///
    /// ```objc
    /// - (void)performAction:(NSTextFinderAction)action;
    /// ```
    ///
    /// This method will determine the desired action from the tag and make various callbacks to [`client`](https://developer.apple.com/documentation/appkit/nstextfinder/client) to perform that action. These callbacks are defined in the [`NSTextFinderClient`](https://developer.apple.com/documentation/appkit/nstextfinderclient) protocol.
    ///
    /// Validation occurs by a similar pattern. The responder should implement [`validateUserInterfaceItem:`](https://developer.apple.com/documentation/appkit/nsuserinterfacevalidations/validateuserinterfaceitem(_:)) and, when the item’s action is the [`performTextFinderAction:`](https://developer.apple.com/documentation/appkit/nsresponder/performtextfinderaction(_:)) method, it should pass the item’s tag to the following method and return the result:
    ///
    /// ```objc
    /// - (BOOL)validateAction:(NSTextFinderAction)action;
    /// ```
    ///
    /// This method will invoke the required client methods to determine what the appropriate response should be. These callbacks are also defined in the [`NSTextFinderClient`](https://developer.apple.com/documentation/appkit/nstextfinderclient) protocol.
    ///
    /// When an action is performed, the text finder will ask its client for the string to search. There are two ways the client can provide this string. It can either implement the `string` method, and simply return an `NSString` instance, or it can implement the following methods: [`stringAtIndex:effectiveRange:endsWithSearchBoundary:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/string(at:effectiverange:endswithsearchboundary:)) and [`stringLength`](https://developer.apple.com/documentation/appkit/nstextfinderclient/stringlength()).
    ///
    /// These methods make it possible to use the text finder with data that cannot be easily or efficiently flattened into a single string. In the first method, the client should return the string which contains the character at the given index in as conceptual concatenation of all strings that are to be searched.
    ///
    /// For example, if a client had the strings “The quick”, “brown fox” , “jumped over the lazy”, and “dog”, and a `NSTextFinder` instance requests the string at index 17, then the client should return “brown fox”. If all the strings were concatenated together, this would be the ‘x’ in “fox”. Additionally, the client should return, by-reference through the `outRange` parameter, the effective range of the string that is returned. In this example, the range of “brown fox” is {9, 9}, because, in the imagined concatenation, the substring starts at index 9 and is 9 characters long.
    ///
    /// In some cases, it is not desirable for a match to be found which overlaps multiple strings returned by the [`stringAtIndex:effectiveRange:endsWithSearchBoundary:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/string(at:effectiverange:endswithsearchboundary:)) method. For example, suppose a client has a list of names like “John Doe”, and “Jane Doe”, etc. Normally, if the string is concatenated together like so: “John Doe Jane Doe”, then a search for “Doe Jane” would succeed. To prevent this often undesirable behavior, the client should return [`true`](https://developer.apple.com/documentation/swift/true), by-reference, through the `outFlag` parameter, when returning each individual string. This indicates that there is a boundary between the current string and the next string that should not be crossed when searching for a match.
    ///
    /// One of the two approaches (implementing the `string` method the [`stringAtIndex:effectiveRange:endsWithSearchBoundary:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/string(at:effectiverange:endswithsearchboundary:)) and [`stringLength`](https://developer.apple.com/documentation/appkit/nstextfinderclient/stringlength()) methods) must be implemented by the client or the `NSTextFinder` instance will not function. If all three methods are implemented, [`stringAtIndex:effectiveRange:endsWithSearchBoundary:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/string(at:effectiverange:endswithsearchboundary:)) will be used by default.
    ///
    /// The text finder may require additional information from the [`client`](https://developer.apple.com/documentation/appkit/nstextfinder/client) object to perform an action, or it may require the `client` to perform some parts of the action on its behalf. The  methods and properties described in [Text Finder Client Implementation Requirements](https://developer.apple.com/documentation/appkit/nstextfinder#text-finder-client-implementation-requirements) describes the hooks the text finder requires for each of the actions it supports. If the client does not implement one of these methods or properties, then the action that requires it will be disabled.
    ///
    /// #### Text Finder Client Implementation Requirements
    ///
    /// The text finder’s client may implement the following properties for by the [`validateAction:`](https://developer.apple.com/documentation/appkit/nstextfinder/validateaction(_:)) method: [`selectable`](https://developer.apple.com/documentation/appkit/nstextfinderclient/isselectable), [`allowsMultipleSelection`](https://developer.apple.com/documentation/appkit/nstextfinderclient/allowsmultipleselection), and `editable`. If any of these properties is not implemented, a value of [`true`](https://developer.apple.com/documentation/swift/true) is assumed. Returning [`false`](https://developer.apple.com/documentation/swift/false) from any of these methods will disable the actions that require them. For more information about these properties see [`NSTextFinderClient`](https://developer.apple.com/documentation/appkit/nstextfinderclient).
    ///
    /// The following implementation’s are required by the text client to support the specified actions:
    ///
    /// - The [`NSTextFinderClient`](https://developer.apple.com/documentation/appkit/nstextfinderclient) protocol must implement the [`firstSelectedRange`](https://developer.apple.com/documentation/appkit/nstextfinderclient/firstselectedrange) property to support the following functionality: [`NSTextFinderActionNextMatch`](https://developer.apple.com/documentation/appkit/nstextfinder/action/nextmatch), [`NSTextFinderActionPreviousMatch`](https://developer.apple.com/documentation/appkit/nstextfinder/action/previousmatch), [`NSTextFinderActionReplace`](https://developer.apple.com/documentation/appkit/nstextfinder/action/replace), [`NSTextFinderActionReplaceAndFind`](https://developer.apple.com/documentation/appkit/nstextfinder/action/replaceandfind), and [`NSTextFinderActionSetSearchString`](https://developer.apple.com/documentation/appkit/nstextfinder/action/setsearchstring) actions. The `client` implementation of [`firstSelectedRange`](https://developer.apple.com/documentation/appkit/nstextfinderclient/firstselectedrange) needs to return its first selected range, or {index, 0} to indicate the location of the insertion point if there is no selection.
    ///
    /// - The [`selectedRanges`](https://developer.apple.com/documentation/appkit/nstextfinderclient/selectedranges) property is required for the [`NSTextFinderActionReplaceAllInSelection`](https://developer.apple.com/documentation/appkit/nstextfinder/action/replaceallinselection), [`NSTextFinderActionSelectAll`](https://developer.apple.com/documentation/appkit/nstextfinder/action/selectall), and [`NSTextFinderActionSelectAllInSelection`](https://developer.apple.com/documentation/appkit/nstextfinder/action/selectallinselection) actions. The array should contain `NSRange` structures wrapped in `NSValue` instances.
    ///
    /// - The [`scrollRangeToVisible:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/scrollrangetovisible(_:)) method is used by many actions, but is not strictly required by any to perform correctly.
    ///
    /// - The client protocol’s [`shouldReplaceCharactersInRanges:withStrings:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/shouldreplacecharacters(inranges:with:)), [`replaceCharactersInRange:withString:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/replacecharacters(in:with:)) and [`didReplaceCharacters`](https://developer.apple.com/documentation/appkit/nstextfinderclient/didreplacecharacters()) methods are used by the [`NSTextFinderActionReplace`](https://developer.apple.com/documentation/appkit/nstextfinder/action/replace), [`NSTextFinderActionReplaceAll`](https://developer.apple.com/documentation/appkit/nstextfinder/action/replaceall), [`NSTextFinderActionReplaceAllInSelection`](https://developer.apple.com/documentation/appkit/nstextfinder/action/replaceallinselection), and [`NSTextFinderActionReplaceAndFind`](https://developer.apple.com/documentation/appkit/nstextfinder/action/replaceandfind) actions. The NSTextFinder instance does not have the ability to directly make changes to the [`client`](https://developer.apple.com/documentation/appkit/nstextfinder/client) content, so the `client` is responsible for performing replace operations in these methods.
    ///
    /// - Before a replace operation is performed, the `NSTextFinder` instance calls the [`shouldReplaceCharactersInRanges:withStrings:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/shouldreplacecharacters(inranges:with:)) method to determine if a replacement should take place. If it returns [`false`](https://developer.apple.com/documentation/swift/false), then the given range will not be replaced. If the method returns [`true`](https://developer.apple.com/documentation/swift/true), or is not implemented, then the `NSTextFinder` instance will call the [`replaceCharactersInRange:withString:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/replacecharacters(in:with:)) method, instructing the `client` to carry out the replacement. Finally, the [`didReplaceCharacters`](https://developer.apple.com/documentation/appkit/nstextfinderclient/didreplacecharacters()) method will be called, if implemented, to indicate that the replacement was completed. For [`NSTextFinderActionReplaceAll`](https://developer.apple.com/documentation/appkit/nstextfinder/action/replaceall) actions, these methods may be called multiple times, starting from the end of the string and moving toward the beginning, in order to preserve the indexes of the matches which precede the current one.
    ///
    /// ### Incremental Search Support
    ///
    /// A common feature used in conjunction with the find bar is incremental search. This feature allows users to find matches immediately as they are typing. In OS X v10.7, the text finder provides this feature for its clients with minimal additional API.
    ///
    /// Incremental searching can be enabled by setting the [`incrementalSearchingEnabled`](https://developer.apple.com/documentation/appkit/nstextfinder/isincrementalsearchingenabled) property [`true`](https://developer.apple.com/documentation/swift/true). This property alone is sufficient to start searching incrementally.
    ///
    /// For improved responsiveness, when a document is sufficiently long, the text finder will search the document in the background. To ensure thread-safety, a client using incremental search must call the [`noteClientStringWillChange`](https://developer.apple.com/documentation/appkit/nstextfinder/noteclientstringwillchange()) method before any changes are made to the string provided to the text finder.
    ///
    /// During incremental search, all visible matches are highlighted. If the `client` object that conforms to the [`NSTextFinderClient`](https://developer.apple.com/documentation/appkit/nstextfinderclient) protocol implements the read-only [`visibleCharacterRanges`](https://developer.apple.com/documentation/appkit/nstextfinderclient/visiblecharacterranges) property, then by default a gray overlay will appear over your find bar container’s content view with transparent areas for each match. This view should be a superview of all subviews reported by the text finder client. The `NSScrollView` class already implements this property, so you only need to implement this property when using a different container class.
    ///
    /// Finally, this mode also requires the same two [`NSTextFinderClient`](https://developer.apple.com/documentation/appkit/nstextfinderclient) protocol methods that are used to display the find indicator: [`contentViewAtIndex:effectiveCharacterRange:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/contentview(at:effectivecharacterrange:)) and [`rectsForCharacterRange:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/rects(forcharacterrange:)) be implemented. However, the implementation of these methods is identical for both purposes, so no additional work is required to support incremental search.
    ///
    /// ### Replacing Text
    ///
    /// The text replacement methods:[`NSTextFinderAction`](https://developer.apple.com/documentation/appkit/nstextfinder/action), [`findIndicatorNeedsUpdate`](https://developer.apple.com/documentation/appkit/nstextfinder/findindicatorneedsupdate), and [`validateAction:`](https://developer.apple.com/documentation/appkit/nstextfinder/validateaction(_:)) are used by the replace, replace all, replace all in section, and replace and find actions.
    ///
    /// Before a replace operation is performed, the `NSTextFinder` instance calls the `client` object’s [`NSTextFinderAction`](https://developer.apple.com/documentation/appkit/nstextfinder/action) method to determine if a replacement should take place. If it returns [`false`](https://developer.apple.com/documentation/swift/false), then the characters in the given ranges will not be replaced. If the method returns [`true`](https://developer.apple.com/documentation/swift/true), or is not implemented, then the second method, [`findIndicatorNeedsUpdate`](https://developer.apple.com/documentation/appkit/nstextfinder/findindicatorneedsupdate), instructing the client to carry out the replacement. Finally, [`validateAction:`](https://developer.apple.com/documentation/appkit/nstextfinder/validateaction(_:)), if implemented, is invoked to indicate that the replacement was completed.
    ///
    /// For replace all actions, these methods will be called multiple times, starting from the last match and moving toward the first, in order to preserve the indexes of the matches which precede the current one.
    ///
    /// ### The Text Finder Container
    ///
    /// In order to display the find bar, a container for the find bar must be specified. The container is an object that conforms to the [`NSTextFinderBarContainer`](https://developer.apple.com/documentation/appkit/nstextfinderbarcontainer) protocol. You specify a find bar container using the following NSTextFinder class’s [`findBarContainer`](https://developer.apple.com/documentation/appkit/nstextfinder/findbarcontainer) property.
    ///
    /// When a new NSTextFinder instance is created and instructed to display the find bar, it will create a view for the find bar and assign that to the container via the [`NSTextFinderBarContainer`](https://developer.apple.com/documentation/appkit/nstextfinderbarcontainer) class’s [`findBarView`](https://developer.apple.com/documentation/appkit/nstextfinderbarcontainer/findbarview) property. The container then owns that view and should release it when the container is deallocated. The container should make the find bar visible when the container’s [`findBarVisible`](https://developer.apple.com/documentation/appkit/nstextfinderbarcontainer/isfindbarvisible) property is set to [`true`](https://developer.apple.com/documentation/swift/true). The container should implement the [`findBarViewDidChangeHeight`](https://developer.apple.com/documentation/appkit/nstextfinderbarcontainer/findbarviewdidchangeheight()) method so it can reposition the find bar when its height changes, usually in response to user action.
    ///
    /// <div class="warning">
    ///
    /// ### Note
    ///  The container is free to modify the width of the find bar view, but it should never modify its height directly.
    ///
    ///
    ///
    /// </div>
    /// ### Implementation by AppKit Classes
    ///
    /// Two AppKit classes already provide support for the `NSTextFinder` class, including: the [`NSScrollView`](https://developer.apple.com/documentation/appkit/nsscrollview) and [`NSTextView`](https://developer.apple.com/documentation/appkit/nstextview) classes.
    ///
    /// #### Scroll View Support for the Find Bar
    ///
    /// The [`NSScrollView`](https://developer.apple.com/documentation/appkit/nsscrollview) class conforms to [`NSTextFinderBarContainer`](https://developer.apple.com/documentation/appkit/nstextfinderbarcontainer) protocol in order to support the find bar for any document view searched by the find bar. The find bar can be positioned either above or below the document view by assigning one of the values of the [`NSScrollViewFindBarPosition`](https://developer.apple.com/documentation/appkit/nsscrollview/findbarposition-swift.enum) constants to the [`findBarPosition`](https://developer.apple.com/documentation/appkit/nsscrollview/findbarposition-swift.property) property.
    ///
    /// <div class="warning">
    ///
    /// ### Note
    ///  The actual values for the constants `NSScrollViewFindBarPosition` constants will change from the current values.
    ///
    ///
    ///
    /// </div>
    /// #### Text View Support for the Find Bar
    ///
    /// The [`NSTextView`](https://developer.apple.com/documentation/appkit/nstextview) class also supports the find bar. The find bar can be enabled or disabled on a text view with the [`usesFindBar`](https://developer.apple.com/documentation/appkit/nstextview/usesfindbar) property.
    ///
    /// Since OS X v10.5, the `NSTextView` class has used an animated find indicator to give feedback to the user about a successful find action. The find indicator could be activated manually on an text view via the [`showFindIndicatorForRange:`](https://developer.apple.com/documentation/appkit/nstextview/showfindindicator(for:)) method.
    ///
    /// To provide this functionality for text finder clients in OS X v10.7, the `NSTextFinder` class shows the find indicator at the appropriate time automatically when performing a find. However, text finder needs to know where to show the indicator and it needs assistance in drawing the text contents of the find indicator. During incremental search the `NSTextFinder` class needs also to know the locations of all the visible matches so it can highlight them as well. The following method additions to the `NSTextFinderClient` protocol provide these capabilities: [`contentViewAtIndex:effectiveCharacterRange:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/contentview(at:effectivecharacterrange:)) and [`rectsForCharacterRange:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/rects(forcharacterrange:)).
    ///
    /// The [`contentViewAtIndex:effectiveCharacterRange:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/contentview(at:effectivecharacterrange:)) method is called to determine what view the content is displayed in, that is, over which the find indicator will be displayed. Since content may potentially be spread over multiple views (like the [`NSLayoutManager`](https://developer.apple.com/documentation/appkit/nslayoutmanager) class , which supports multiple text views), the method asks for the view at a given index, and the full range of the string that is contained by that view.
    ///
    /// In the [`rectsForCharacterRange:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/rects(forcharacterrange:)) method, the client should determine and return the rectangles in which the content with the given range is displayed in its `contentView`. The given range is guaranteed not to span multiple content views. The returned rectangles tell the `NSTextFinder` instance where the matched range is found, so it can show the find indicator there.
    ///
    /// The `NSTextFinder` and [`NSView`](https://developer.apple.com/documentation/appkit/nsview) classes will handle the find indicator correctly when the [`contentView`](https://developer.apple.com/documentation/appkit/nstextfinderbarcontainer/contentview()) is resized, moved, or removed from the view hierarchy. If your content view’s scrolling is done by an [`NSScrollView`](https://developer.apple.com/documentation/appkit/nsscrollview) object, the find indicator will also be handled for you during scrolling. Beyond these cases, there may be some circumstances where the find indicator should be immediately cancelled and hidden, such as when the view’s content or selection is changed without the knowledge of the text finder . The find indicator can be cancelled using the `NSTextFinder` [`cancelFindIndicator`](https://developer.apple.com/documentation/appkit/nstextfinder/cancelfindindicator()) method. If your document is not scrolled by `NSScrollView`, then you should set the [`findIndicatorNeedsUpdate`](https://developer.apple.com/documentation/appkit/nstextfinder/findindicatorneedsupdate) property to [`true`](https://developer.apple.com/documentation/swift/true).
    ///
    /// `NSTextFinder` is responsible for drawing the yellow find indicator background bezel, but the view must provide the contents. `NSTextFinder` also sets up a drawing context and causes the content view to draw into it. There are two ways this can happen.
    ///
    /// - The `NSTextFinder` instance invokes the `client` object’s [`drawCharactersInRange:forContentView:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/drawcharacters(in:forcontentview:)) method, if implemented. The client should then draw the requested characters (or ask the containing view to draw the characters, which is provided as a convenience) at the origin of the current context. If the requested character range partially intersects a glyph range, the client may draw the entire glyph, if necessary for performance.
    ///
    /// - If [`drawCharactersInRange:forContentView:`](https://developer.apple.com/documentation/appkit/nstextfinderclient/drawcharacters(in:forcontentview:)) method is not implemented, then the `NSTextFinder` instance uses the normal view drawing mechanisms. The `contentView` does not need take any additional action to make this happen
    ///
    /// In OS X v10.7, the [`NSTextView`](https://developer.apple.com/documentation/appkit/nstextview) class also provides incremental search support. It is disabled by default, but can be enabled by setting the [`incrementalSearchingEnabled`](https://developer.apple.com/documentation/appkit/nstextview/isincrementalsearchingenabled) property to [`true`](https://developer.apple.com/documentation/swift/true). Also, because incremental searching requires the find bar, [`usesFindBar`](https://developer.apple.com/documentation/appkit/nstextview/usesfindbar) must be set to [`true`](https://developer.apple.com/documentation/swift/true) for incremental searching to be occur.
    ///
    ///
    #[unsafe(super(NSObject))]
    #[derive(Debug, PartialEq, Eq, Hash)]
    pub struct NSTextFinder;
);

extern_conformance!(
    unsafe impl NSCoding for NSTextFinder {}
);

extern_conformance!(
    unsafe impl NSObjectProtocol for NSTextFinder {}
);

impl NSTextFinder {
    extern_methods!(
        #[unsafe(method(init))]
        #[unsafe(method_family = init)]
        pub fn init(this: Allocated<Self>) -> Retained<Self>;

        /// # Safety
        ///
        /// `coder` possibly has further requirements.
        #[unsafe(method(initWithCoder:))]
        #[unsafe(method_family = init)]
        pub unsafe fn initWithCoder(this: Allocated<Self>, coder: &NSCoder) -> Retained<Self>;

        /// # Safety
        ///
        /// This is not retained internally, you must ensure the object is still alive.
        #[unsafe(method(client))]
        #[unsafe(method_family = none)]
        pub unsafe fn client(&self) -> Option<Retained<ProtocolObject<dyn NSTextFinderClient>>>;

        /// Setter for [`client`][Self::client].
        ///
        /// # Safety
        ///
        /// This is unretained, you must ensure the object is kept alive while in use.
        #[unsafe(method(setClient:))]
        #[unsafe(method_family = none)]
        pub unsafe fn setClient(&self, client: Option<&ProtocolObject<dyn NSTextFinderClient>>);

        #[unsafe(method(performAction:))]
        #[unsafe(method_family = none)]
        pub fn performAction(&self, op: NSTextFinderAction);

        #[unsafe(method(validateAction:))]
        #[unsafe(method_family = none)]
        pub fn validateAction(&self, op: NSTextFinderAction) -> bool;

        /// # Safety
        ///
        /// This is not retained internally, you must ensure the object is still alive.
        #[unsafe(method(findBarContainer))]
        #[unsafe(method_family = none)]
        pub unsafe fn findBarContainer(
            &self,
        ) -> Option<Retained<ProtocolObject<dyn NSTextFinderBarContainer>>>;

        /// Setter for [`findBarContainer`][Self::findBarContainer].
        ///
        /// # Safety
        ///
        /// This is unretained, you must ensure the object is kept alive while in use.
        #[unsafe(method(setFindBarContainer:))]
        #[unsafe(method_family = none)]
        pub unsafe fn setFindBarContainer(
            &self,
            find_bar_container: Option<&ProtocolObject<dyn NSTextFinderBarContainer>>,
        );

        #[unsafe(method(cancelFindIndicator))]
        #[unsafe(method_family = none)]
        pub fn cancelFindIndicator(&self);

        #[unsafe(method(findIndicatorNeedsUpdate))]
        #[unsafe(method_family = none)]
        pub fn findIndicatorNeedsUpdate(&self) -> bool;

        /// Setter for [`findIndicatorNeedsUpdate`][Self::findIndicatorNeedsUpdate].
        #[unsafe(method(setFindIndicatorNeedsUpdate:))]
        #[unsafe(method_family = none)]
        pub fn setFindIndicatorNeedsUpdate(&self, find_indicator_needs_update: bool);

        #[unsafe(method(isIncrementalSearchingEnabled))]
        #[unsafe(method_family = none)]
        pub fn isIncrementalSearchingEnabled(&self) -> bool;

        /// Setter for [`isIncrementalSearchingEnabled`][Self::isIncrementalSearchingEnabled].
        #[unsafe(method(setIncrementalSearchingEnabled:))]
        #[unsafe(method_family = none)]
        pub fn setIncrementalSearchingEnabled(&self, incremental_searching_enabled: bool);

        #[unsafe(method(incrementalSearchingShouldDimContentView))]
        #[unsafe(method_family = none)]
        pub fn incrementalSearchingShouldDimContentView(&self) -> bool;

        /// Setter for [`incrementalSearchingShouldDimContentView`][Self::incrementalSearchingShouldDimContentView].
        #[unsafe(method(setIncrementalSearchingShouldDimContentView:))]
        #[unsafe(method_family = none)]
        pub fn setIncrementalSearchingShouldDimContentView(
            &self,
            incremental_searching_should_dim_content_view: bool,
        );

        #[unsafe(method(incrementalMatchRanges))]
        #[unsafe(method_family = none)]
        pub fn incrementalMatchRanges(&self) -> Retained<NSArray<NSValue>>;

        #[unsafe(method(drawIncrementalMatchHighlightInRect:))]
        #[unsafe(method_family = none)]
        pub fn drawIncrementalMatchHighlightInRect(rect: NSRect);

        #[unsafe(method(noteClientStringWillChange))]
        #[unsafe(method_family = none)]
        pub fn noteClientStringWillChange(&self);
    );
}

/// Methods declared on superclass `NSObject`.
impl NSTextFinder {
    extern_methods!(
        #[unsafe(method(new))]
        #[unsafe(method_family = new)]
        pub fn new() -> Retained<Self>;
    );
}

impl DefaultRetained for NSTextFinder {
    #[inline]
    fn default_retained() -> Retained<Self> {
        Self::new()
    }
}

extern_protocol!(
    /// A set of methods implemented by objects that support searching using the [`NSTextFinder`](https://developer.apple.com/documentation/appkit/nstextfinder) class and the in-window text find bar.
    ///
    /// ## Overview
    ///
    /// See [`NSTextFinder`](https://developer.apple.com/documentation/appkit/nstextfinder) for details.
    ///
    ///
    pub unsafe trait NSTextFinderClient: NSObjectProtocol {
        #[optional]
        #[unsafe(method(isSelectable))]
        #[unsafe(method_family = none)]
        fn isSelectable(&self) -> bool;

        #[optional]
        #[unsafe(method(allowsMultipleSelection))]
        #[unsafe(method_family = none)]
        fn allowsMultipleSelection(&self) -> bool;

        #[optional]
        #[unsafe(method(isEditable))]
        #[unsafe(method_family = none)]
        fn isEditable(&self) -> bool;

        #[optional]
        #[unsafe(method(string))]
        #[unsafe(method_family = none)]
        fn string(&self) -> Retained<NSString>;

        /// # Safety
        ///
        /// - `out_range` must be a valid pointer.
        /// - `out_flag` must be a valid pointer.
        #[optional]
        #[unsafe(method(stringAtIndex:effectiveRange:endsWithSearchBoundary:))]
        #[unsafe(method_family = none)]
        unsafe fn stringAtIndex_effectiveRange_endsWithSearchBoundary(
            &self,
            character_index: NSUInteger,
            out_range: NSRangePointer,
            out_flag: NonNull<Bool>,
        ) -> Retained<NSString>;

        #[optional]
        #[unsafe(method(stringLength))]
        #[unsafe(method_family = none)]
        fn stringLength(&self) -> NSUInteger;

        #[optional]
        #[unsafe(method(firstSelectedRange))]
        #[unsafe(method_family = none)]
        fn firstSelectedRange(&self) -> NSRange;

        #[optional]
        #[unsafe(method(selectedRanges))]
        #[unsafe(method_family = none)]
        fn selectedRanges(&self) -> Retained<NSArray<NSValue>>;

        /// Setter for [`selectedRanges`][Self::selectedRanges].
        ///
        /// This is [copied][objc2_foundation::NSCopying::copy] when set.
        #[optional]
        #[unsafe(method(setSelectedRanges:))]
        #[unsafe(method_family = none)]
        fn setSelectedRanges(&self, selected_ranges: &NSArray<NSValue>);

        #[optional]
        #[unsafe(method(scrollRangeToVisible:))]
        #[unsafe(method_family = none)]
        fn scrollRangeToVisible(&self, range: NSRange);

        #[optional]
        #[unsafe(method(shouldReplaceCharactersInRanges:withStrings:))]
        #[unsafe(method_family = none)]
        fn shouldReplaceCharactersInRanges_withStrings(
            &self,
            ranges: &NSArray<NSValue>,
            strings: &NSArray<NSString>,
        ) -> bool;

        #[optional]
        #[unsafe(method(replaceCharactersInRange:withString:))]
        #[unsafe(method_family = none)]
        fn replaceCharactersInRange_withString(&self, range: NSRange, string: &NSString);

        #[optional]
        #[unsafe(method(didReplaceCharacters))]
        #[unsafe(method_family = none)]
        fn didReplaceCharacters(&self);

        #[cfg(all(feature = "NSResponder", feature = "NSView"))]
        /// # Safety
        ///
        /// `out_range` must be a valid pointer.
        #[optional]
        #[unsafe(method(contentViewAtIndex:effectiveCharacterRange:))]
        #[unsafe(method_family = none)]
        unsafe fn contentViewAtIndex_effectiveCharacterRange(
            &self,
            index: NSUInteger,
            out_range: NSRangePointer,
            mtm: MainThreadMarker,
        ) -> Retained<NSView>;

        #[optional]
        #[unsafe(method(rectsForCharacterRange:))]
        #[unsafe(method_family = none)]
        fn rectsForCharacterRange(&self, range: NSRange) -> Option<Retained<NSArray<NSValue>>>;

        #[optional]
        #[unsafe(method(visibleCharacterRanges))]
        #[unsafe(method_family = none)]
        fn visibleCharacterRanges(&self) -> Retained<NSArray<NSValue>>;

        #[cfg(all(feature = "NSResponder", feature = "NSView"))]
        #[optional]
        #[unsafe(method(drawCharactersInRange:forContentView:))]
        #[unsafe(method_family = none)]
        fn drawCharactersInRange_forContentView(&self, range: NSRange, view: &NSView);
    }
);

extern_protocol!(
    /// A protocol that provides a container in which the find bar is displayed.
    ///
    /// ## Overview
    ///
    /// To display the find bar, a container for the find bar must be specified. You specify a find bar container using the [`findBarContainer`](https://developer.apple.com/documentation/appkit/nstextfinder/findbarcontainer) of the [`NSTextFinder`](https://developer.apple.com/documentation/appkit/nstextfinder) class.
    ///
    /// See [`NSTextFinder`](https://developer.apple.com/documentation/appkit/nstextfinder) for more information.
    ///
    ///
    pub unsafe trait NSTextFinderBarContainer: NSObjectProtocol {
        #[cfg(all(feature = "NSResponder", feature = "NSView"))]
        #[unsafe(method(findBarView))]
        #[unsafe(method_family = none)]
        fn findBarView(&self, mtm: MainThreadMarker) -> Option<Retained<NSView>>;

        #[cfg(all(feature = "NSResponder", feature = "NSView"))]
        /// Setter for [`findBarView`][Self::findBarView].
        #[unsafe(method(setFindBarView:))]
        #[unsafe(method_family = none)]
        fn setFindBarView(&self, find_bar_view: Option<&NSView>);

        #[unsafe(method(isFindBarVisible))]
        #[unsafe(method_family = none)]
        fn isFindBarVisible(&self) -> bool;

        /// Setter for [`isFindBarVisible`][Self::isFindBarVisible].
        #[unsafe(method(setFindBarVisible:))]
        #[unsafe(method_family = none)]
        fn setFindBarVisible(&self, find_bar_visible: bool);

        #[unsafe(method(findBarViewDidChangeHeight))]
        #[unsafe(method_family = none)]
        fn findBarViewDidChangeHeight(&self);

        #[cfg(all(feature = "NSResponder", feature = "NSView"))]
        #[optional]
        #[unsafe(method(contentView))]
        #[unsafe(method_family = none)]
        fn contentView(&self, mtm: MainThreadMarker) -> Option<Retained<NSView>>;
    }
);
