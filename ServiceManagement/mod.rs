// This file has been automatically generated by `objc2`'s `header-translator`.
// DO NOT EDIT

#![allow(unused_imports)]
#![allow(deprecated)]
#![allow(non_snake_case)]
#![allow(non_camel_case_types)]
#![allow(non_upper_case_globals)]
#![allow(missing_docs)]
#![allow(clippy::too_many_arguments)]
#![allow(clippy::type_complexity)]
#![allow(clippy::upper_case_acronyms)]
#![allow(clippy::identity_op)]
#![allow(clippy::missing_safety_doc)]
#![allow(clippy::doc_lazy_continuation)]
#![allow(rustdoc::broken_intra_doc_links)]
#![allow(rustdoc::bare_urls)]
#![allow(rustdoc::invalid_html_tags)]

#[link(name = "ServiceManagement", kind = "framework")]
extern "C" {}

#[cfg(feature = "SMAppService")]
#[path = "SMAppService.rs"]
mod __SMAppService;
#[cfg(feature = "SMErrors")]
#[path = "SMErrors.rs"]
mod __SMErrors;
#[cfg(feature = "SMLoginItem")]
#[path = "SMLoginItem.rs"]
mod __SMLoginItem;

#[cfg(all(feature = "SMAppService", feature = "objc2"))]
pub use self::__SMAppService::SMAppService;
#[cfg(all(feature = "SMAppService", feature = "objc2-foundation"))]
pub use self::__SMAppService::SMAppServiceErrorDomain;
#[cfg(all(feature = "SMAppService", feature = "objc2"))]
pub use self::__SMAppService::SMAppServiceStatus;
#[cfg(feature = "SMErrors")]
pub use self::__SMErrors::kSMErrorAlreadyRegistered;
#[cfg(feature = "SMErrors")]
pub use self::__SMErrors::kSMErrorAuthorizationFailure;
#[cfg(all(feature = "SMErrors", feature = "objc2-core-foundation"))]
pub use self::__SMErrors::kSMErrorDomainFramework;
#[cfg(all(feature = "SMErrors", feature = "objc2-core-foundation"))]
pub use self::__SMErrors::kSMErrorDomainIPC;
#[cfg(all(feature = "SMErrors", feature = "objc2-core-foundation"))]
pub use self::__SMErrors::kSMErrorDomainLaunchd;
#[cfg(feature = "SMErrors")]
pub use self::__SMErrors::kSMErrorInternalFailure;
#[cfg(feature = "SMErrors")]
pub use self::__SMErrors::kSMErrorInvalidPlist;
#[cfg(feature = "SMErrors")]
pub use self::__SMErrors::kSMErrorInvalidSignature;
#[cfg(feature = "SMErrors")]
pub use self::__SMErrors::kSMErrorJobMustBeEnabled;
#[cfg(feature = "SMErrors")]
pub use self::__SMErrors::kSMErrorJobNotFound;
#[cfg(feature = "SMErrors")]
pub use self::__SMErrors::kSMErrorJobPlistNotFound;
#[cfg(feature = "SMErrors")]
pub use self::__SMErrors::kSMErrorLaunchDeniedByUser;
#[cfg(feature = "SMErrors")]
pub use self::__SMErrors::kSMErrorServiceUnavailable;
#[cfg(feature = "SMErrors")]
pub use self::__SMErrors::kSMErrorToolNotValid;
#[cfg(all(feature = "SMLoginItem", feature = "objc2-core-foundation"))]
pub use self::__SMLoginItem::SMLoginItemSetEnabled;
use core::ffi::*;
use core::ptr::NonNull;
#[cfg(feature = "objc2-core-foundation")]
use objc2_core_foundation::*;
#[cfg(feature = "objc2-security")]
use objc2_security::*;

use crate::*;

/// The authorization rights key for approving and installing a privileged helper tool.
pub const kSMRightBlessPrivilegedHelper: &CStr =
    unsafe { CStr::from_bytes_with_nul_unchecked(b"com.apple.ServiceManagement.blesshelper\0") };
/// The authorization rights key for modifying system daemons.
pub const kSMRightModifySystemDaemons: &CStr =
    unsafe { CStr::from_bytes_with_nul_unchecked(b"com.apple.ServiceManagement.daemons.modify\0") };
extern "C" {
    /// The system-level launch domain.
    /// A constant representing the privileged Mach bootstrap context. Modifications
    /// to this context require root privileges.
    #[cfg(feature = "objc2-core-foundation")]
    pub static kSMDomainSystemLaunchd: Option<&'static CFString>;
}

extern "C" {
    /// The user-level launch domain.
    /// A constant representing the Mach bootstrap context associated with the
    /// caller's UID. On iOS, this symbol is a synonym for
    /// {
    ///
    /// ```text
    ///  kSMDomainSystemLaunchd}.
    ///  
    ///
    /// ```
    #[cfg(feature = "objc2-core-foundation")]
    pub static kSMDomainUserLaunchd: Option<&'static CFString>;
}

/// Copies the job description dictionary for the specified job label.
///
/// Parameters:
/// - domain: The job’s domain (for example, [`kSMDomainSystemLaunchd`](https://developer.apple.com/documentation/servicemanagement/ksmdomainsystemlaunchd)).
///
/// - jobLabel: The label identifier of the job to copy.
///
///
/// ## Return Value
///
/// A new dictionary describing the job, or `NULL` if the system couldn’t find the job. The caller must release the dictionary.
///
///
/// Copy the job description dictionary for the given job label.
///
///
/// Parameter `domain`: The job's domain (e.g. {
///
/// ```text
///  kSMDomainSystemLaunchd} or
///  {@link kSMDomainUserLaunchd}).
///
///  @param jobLabel
///  The label identifier for the job to copy.
///
///  @result
///  A new dictionary describing the job, or NULL if the job could not be found.
///  Must be released by the caller.
///
///  @discussion
///  The contents of the returned dictionary are NOT wholy representative of the
///  property list on-disk and are not stable from release to release. This
///  routine is deprecated and will be removed in a future release. There will be
///  no provided replacement.
///  
///
/// ```
///
/// # Safety
///
/// - `domain` might not allow `None`.
/// - `job_label` might not allow `None`.
#[cfg(feature = "objc2-core-foundation")]
#[deprecated]
#[inline]
pub unsafe extern "C-unwind" fn SMJobCopyDictionary(
    domain: Option<&CFString>,
    job_label: Option<&CFString>,
) -> Option<CFRetained<CFDictionary>> {
    extern "C-unwind" {
        fn SMJobCopyDictionary(
            domain: Option<&CFString>,
            job_label: Option<&CFString>,
        ) -> Option<NonNull<CFDictionary>>;
    }
    let ret = unsafe { SMJobCopyDictionary(domain, job_label) };
    ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
}

/// Copies the job description dictionaries for all jobs in the specified domain.
///
/// Parameters:
/// - domain: The job’s domain (for example, [`kSMDomainSystemLaunchd`](https://developer.apple.com/documentation/servicemanagement/ksmdomainsystemlaunchd)).
///
///
/// ## Return Value
///
/// A new array containing all job dictionaries, or `NULL` if an error occurred. The caller must release the array.
///
///
/// Copy the job description dictionaries for all jobs in the given domain.
///
///
/// Parameter `domain`: The job's domain (e.g. {
///
/// ```text
///  kSMDomainSystemLaunchd} or
///  {@link kSMDomainUserLaunchd}).
///
///  @result
///  A new array containing all job dictionaries, or NULL if an error occurred.
///  Must be released by the caller.
///
///  @discussion
///  SMCopyAllJobDictionaries returns an array of the job description dictionaries
///  for all jobs in the given domain, or NULL if an error occurred. This routine
///  is deprecated and will be removed in a future release. There will be no
///  provided replacement.
///
///  For the specific use of testing the state of a login item that may have been
///  enabled with SMLoginItemSetEnabled() in order to show that state to the
///  user, this function remains the recommended API. A replacement API for this
///  specific use will be provided before this function is removed.
///  
///
/// ```
///
/// # Safety
///
/// `domain` might not allow `None`.
#[cfg(feature = "objc2-core-foundation")]
#[deprecated]
#[inline]
pub unsafe extern "C-unwind" fn SMCopyAllJobDictionaries(
    domain: Option<&CFString>,
) -> Option<CFRetained<CFArray>> {
    extern "C-unwind" {
        fn SMCopyAllJobDictionaries(domain: Option<&CFString>) -> Option<NonNull<CFArray>>;
    }
    let ret = unsafe { SMCopyAllJobDictionaries(domain) };
    ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
}

/// Submits the specified job to the specified domain.
///
/// Parameters:
/// - domain: The job’s domain (for example, [`kSMDomainSystemLaunchd`](https://developer.apple.com/documentation/servicemanagement/ksmdomainsystemlaunchd)).
///
/// - job: A dictionary describing a job.
///
/// - auth: An `AuthorizationRef` containing the [`kSMRightModifySystemDaemons`](https://developer.apple.com/documentation/servicemanagement/ksmrightmodifysystemdaemons) right if the specified
///
/// domain is [`kSMDomainSystemLaunchd`](https://developer.apple.com/documentation/servicemanagement/ksmdomainsystemlaunchd).
///
/// - outError: An output reference to a `CFErrorRef` describing the specific error when submitting the job, or `NULL` if no error occurred. It’s the responsibility of the app to release the error reference. This argument can be `NULL`.
///
///
/// ## Return Value
///
/// Returns true if the system successfully submits the job, otherwise `false`.
///
///
/// Submits the given job to the specified domain.
///
///
/// Parameter `domain`: The job's domain (e.g. {
///
/// ```text
///  kSMDomainSystemLaunchd} or
///  {@link kSMDomainUserLaunchd}).
///
///  @param job
///  A dictionary describing a job.
///
///  @param auth
///  An AuthorizationRef containing the {@link kSMRightModifySystemDaemons} right
///  if the given domain is kSMDomainSystemLaunchd. Otherwise, NULL may be passed.
///
///  @param outError
///  Upon unsuccessful return, a new CFError object describing the error.  Upon
///  successful return, this argument is set to NULL.  This argument may be NULL.
///  It is the responsibility of the application to release the error reference.
///
///  @result
///  True if the job was submitted successfully, otherwise false.
///
///  @discussion
///  This routine is deprecated and will be removed in a future release. A
///  replacement will be provided by libxpc.
///  
///
/// ```
///
/// # Safety
///
/// - `domain` might not allow `None`.
/// - `job` generic must be of the correct type.
/// - `job` generic must be of the correct type.
/// - `job` might not allow `None`.
/// - `auth` must be a valid pointer.
/// - `out_error` must be a valid pointer.
#[cfg(all(feature = "objc2-core-foundation", feature = "objc2-security"))]
#[deprecated]
#[inline]
pub unsafe extern "C-unwind" fn SMJobSubmit(
    domain: Option<&CFString>,
    job: Option<&CFDictionary>,
    auth: AuthorizationRef,
    out_error: *mut *mut CFError,
) -> bool {
    extern "C-unwind" {
        fn SMJobSubmit(
            domain: Option<&CFString>,
            job: Option<&CFDictionary>,
            auth: AuthorizationRef,
            out_error: *mut *mut CFError,
        ) -> Boolean;
    }
    let ret = unsafe { SMJobSubmit(domain, job, auth, out_error) };
    ret != 0
}

/// Removes the job with the specified label from the specified domain.
///
/// Parameters:
/// - domain: The job’s domain (for example, [`kSMDomainSystemLaunchd`](https://developer.apple.com/documentation/servicemanagement/ksmdomainsystemlaunchd)).
///
/// - jobLabel: The label identifier of the job to remove.
///
/// - auth: An `AuthorizationRef` containing the [`kSMRightModifySystemDaemons`](https://developer.apple.com/documentation/servicemanagement/ksmrightmodifysystemdaemons) right if the specified domain is [`kSMDomainSystemLaunchd`](https://developer.apple.com/documentation/servicemanagement/ksmdomainsystemlaunchd).
///
/// - wait: Pass `true` to block until the process for the specified job has exited.
///
/// - outError: An output reference to a `CFErrorRef` describing the specific error when removing the job, or `NULL` if no error occurred. It’s the responsibility of the app to release the error reference. This argument can be `NULL`.
///
///
/// ## Return Value
///
/// Returns `true` if the system successfully removes the job, otherwise `false`.
///
///
///
/// ## Discussion
///
/// If the job is currently running, it conditionally blocks until the running process has exited.
///
///
/// Removes the job with the given label from the specified domain. When this
/// function is used to remove a job that is running, the invocation blocks
/// until the job exits, commonly taking several seconds.
///
///
/// Parameter `domain`: The job's domain (e.g. {
///
/// ```text
///  kSMDomainSystemLaunchd} or
///  {@link kSMDomainUserLaunchd}).
///
///  @param jobLabel
///  The label for the job to remove.
///
///  @param auth
///  An AuthorizationRef containing the {@link kSMRightModifySystemDaemons} right
///  if the given domain is kSMDomainSystemLaunchd. Otherwise, NULL may be passed.
///
///  @param wait
///  Pass true to block until the process for the given job has exited.
///
///  @param outError
///  Upon unsuccessful return, a new CFError object describing the error.  Upon
///  successful return, this argument is set to NULL.  This argument may be NULL.
///  It is the responsibility of the application to release the error reference.
///
///  @result
///  True if the job was removed successfully, otherwise false.
///
///  @discussion
///  This routine is deprecated and will be removed in a future release. A
///  replacement will be provided by libxpc.
///  
///
/// ```
///
/// # Safety
///
/// - `domain` might not allow `None`.
/// - `job_label` might not allow `None`.
/// - `auth` must be a valid pointer.
/// - `out_error` must be a valid pointer.
#[cfg(all(feature = "objc2-core-foundation", feature = "objc2-security"))]
#[deprecated]
#[inline]
pub unsafe extern "C-unwind" fn SMJobRemove(
    domain: Option<&CFString>,
    job_label: Option<&CFString>,
    auth: AuthorizationRef,
    wait: bool,
    out_error: *mut *mut CFError,
) -> bool {
    extern "C-unwind" {
        fn SMJobRemove(
            domain: Option<&CFString>,
            job_label: Option<&CFString>,
            auth: AuthorizationRef,
            wait: Boolean,
            out_error: *mut *mut CFError,
        ) -> Boolean;
    }
    let ret = unsafe { SMJobRemove(domain, job_label, auth, wait as _, out_error) };
    ret != 0
}

/// Submits the executable for the given label as a job to `launchd`.
///
/// Parameters:
/// - domain: The job’s domain. The Service Management framework only supports the [`kSMDomainSystemLaunchd`](https://developer.apple.com/documentation/servicemanagement/ksmdomainsystemlaunchd) domain.
///
/// - executableLabel: The label of the privileged executable to install. This label must be one of the keys found in the [`SMPrivilegedExecutables`](https://developer.apple.com/documentation/bundleresources/information-property-list/smprivilegedexecutables) dictionary in the application’s `Info.plist`.
///
/// - auth: An authorization reference containing the [`kSMRightBlessPrivilegedHelper`](https://developer.apple.com/documentation/servicemanagement/ksmrightblessprivilegedhelper) right.
///
/// - outError: An output reference to a [`CFErrorRef`](https://developer.apple.com/documentation/corefoundation/cferror) describing the specific error encountered while submitting the executable tool; or, `NULL` if successful. It’s the responsibility of the application to release the error reference. This argument may be `NULL`.
///
///
/// ## Return Value
///
/// Returns [`true`](https://developer.apple.com/documentation/swift/true) if the job was successfully submitted; otherwise [`false`](https://developer.apple.com/documentation/swift/false).
///
///
///
/// ## Discussion
///
/// `SMJobBless` submits the executable for the given label as a `launchd` job. This function removes the need for a `setuid(_:)` helper invoked through [`AuthorizationExecuteWithPrivileges`](https://developer.apple.comhttps://developer.apple.com/documentation/security/1540038-authorizationexecutewithprivileg) in order to install a `launchd` property list. If the job is already installed, this methods returns [`true`](https://developer.apple.com/documentation/swift/true).
///
/// In order to use this function, the app must meet the following requirements:
///
/// 1. Xcode must sign both the calling app and target executable tool.
///
/// 2. The calling app’s `Info.plist` must include an [`SMPrivilegedExecutables`](https://developer.apple.com/documentation/bundleresources/information-property-list/smprivilegedexecutables) dictionary of strings. Each string is a textual representation of a code signing requirement the system uses to determine whether the app owns the privileged tool once installed (for example, in order for subsequent versions to update the installed version).
///
/// Each key of `SMPrivilegedExecutables` is a reverse-DNS label for the helper tool that must be globally unique.
///
/// 1. The helper tool must have an embedded `Info.plist` containing an [`SMAuthorizedClients`](https://developer.apple.com/documentation/bundleresources/information-property-list/smauthorizedclients) array of strings. Each string is a textual representation of a code signing requirement describing a client allowed to add and remove the tool.
///
/// 2. The helper tool must have an embedded launchd property list. The only required key in this property list is the `Label` key. When the Service Management framework extracts the `launchd` property list and writes it to disk, it sets the key for `ProgramArguments` to an array of 1 element that points to a standard location. You can’t specify your own program arguments, so don’t rely on the system passing custom command line arguments to your tool. Pass any parameters through an inter-process communication (IPC) channel.
///
/// 3. The helper tool must reside in the Contents/Library/LaunchServices directory inside the application bundle, and its name must be its launchd job label. So if your launchd job label is `com.apple.Mail.helper`, this must be the name of the tool in your application bundle.
///
///
/// If the job is already installed, success is returned.
///
/// In order to use this function the following requirements must be met:
///
/// 1.    The calling application and target executable tool must both be signed.
///
/// 2.    The calling application's Info.plist must include a
/// "SMPrivilegedExecutables" dictionary of strings. Each string is a
/// textual representation of a code signing requirement used to determine
/// whether the application owns the privileged tool once installed (i.e. in
/// order for subsequent versions to update the installed version).
///
/// Each key of SMPrivilegedExecutables is a reverse-DNS label for the helper
/// tool (must be globally unique).
///
/// 3.    The helper tool must have an embedded Info.plist containing an
/// "SMAuthorizedClients" array of strings. Each string is a textual
/// representation of a code signing requirement describing a client which
/// is allowed to add and remove the tool.
///
/// 4.    The helper tool must have an embedded launchd plist. The only required
/// key in this plist is the Label key. When the launchd plist is extracted
/// and written to disk, the key for ProgramArguments will be set to an
/// array of 1 element pointing to a standard location. You cannot specify
/// your own Program or ProgramArguments, so do not rely on custom command
/// line arguments being passed to your tool. Pass any parameters via IPC.
/// This plist must be embedded in the __TEXT,__launchd_plist section of the
/// binary.
///
/// A property list may be embedded in an executable at link-time with the
/// -sectcreate linker flag.
///
/// 5.    The helper tool must reside in the Contents/Library/LaunchServices
/// directory inside the application bundle, and its name must be its
/// launchd job label. So if your launchd job label is
/// "com.apple.Mail.helper", this must be the name of the tool in your
/// application bundle.
///
///
/// Parameter `domain`: The job's domain. Passing any value other than {
///
/// ```text
///  kSMDomainSystemLaunchd}
///  will result in undefined behavior.
///
///  @param executableLabel
///  The label of the privileged executable to install. This label must be one of
///  the keys found in the SMPrivilegedExecutables dictionary in the application's
///  Info.plist.
///
///  @param auth
///  An authorization reference containing the
///  {@link kSMRightBlessPrivilegedHelper} right.
///
///  @param outError
///  Upon unsuccessful return, a new CFError object describing the error.  Upon
///  successful return, this argument is set to NULL.  This argument may be NULL.
///  It is the responsibility of the application to release the error reference.
///
///  @result
///  True if the helper tool was successfully bootstrapped, otherwise false.
///
///  @discussion
///  SMJobBless has been deprecated in favor of using SMAppService APIs
///  to install a LaunchDaemon. See SMAppService:daemonServiceWithPlistName
///
///  SMJobBless submits the executable for the given label as a launchd job.  This
///  routine obviates the need for a setuid helper invoked via
///  AuthorizationExecuteWithPrivileges() in order to install a launchd plist.
///  
///
/// ```
///
/// # Safety
///
/// - `domain` might not allow `None`.
/// - `executable_label` might not allow `None`.
/// - `auth` must be a valid pointer.
/// - `out_error` must be a valid pointer.
#[cfg(all(feature = "objc2-core-foundation", feature = "objc2-security"))]
#[deprecated = "Please use SMAppService instead"]
#[inline]
pub unsafe extern "C-unwind" fn SMJobBless(
    domain: Option<&CFString>,
    executable_label: Option<&CFString>,
    auth: AuthorizationRef,
    out_error: *mut *mut CFError,
) -> bool {
    extern "C-unwind" {
        fn SMJobBless(
            domain: Option<&CFString>,
            executable_label: Option<&CFString>,
            auth: AuthorizationRef,
            out_error: *mut *mut CFError,
        ) -> Boolean;
    }
    let ret = unsafe { SMJobBless(domain, executable_label, auth, out_error) };
    ret != 0
}
