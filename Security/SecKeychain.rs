//! This file has been automatically generated by `objc2`'s `header-translator`.
//! DO NOT EDIT
use core::ffi::*;
use core::ptr::NonNull;
#[cfg(feature = "objc2")]
use objc2::__framework_prelude::*;
use objc2_core_foundation::*;

use crate::*;

/// Indicates the keychain is unlocked.
pub const kSecUnlockStateStatus: u32 = 1;
/// Indicates the keychain is readable.
pub const kSecReadPermStatus: u32 = 2;
/// Indicates the keychain is writable.
pub const kSecWritePermStatus: u32 = 4;

/// A structure that contains information about keychain settings.
///
/// ## Overview
///
/// This structure contains information about a keychain’s settings such as locking on sleep and the lock time interval. Use the [`SecKeychainSetSettings`](https://developer.apple.com/documentation/security/seckeychainsetsettings(_:_:)) and [`SecKeychainCopySettings`](https://developer.apple.com/documentation/security/seckeychaincopysettings(_:_:)) functions to set and copy a keychain’s settings.
///
///
/// Contains keychain settings.
/// Field: version An unsigned 32-bit integer representing the keychain version.
/// Field: lockOnSleep A boolean value indicating whether the keychain locks when the system sleeps.
/// Field: useLockInterval A boolean value indicating whether the keychain automatically locks after a certain period of time.
/// Field: lockInterval An unsigned 32-bit integer representing the number of seconds before the keychain locks.
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq, Default)]
pub struct SecKeychainSettings {
    pub version: u32,
    pub lockOnSleep: Boolean,
    pub useLockInterval: Boolean,
    pub lockInterval: u32,
}

#[cfg(feature = "objc2")]
unsafe impl Encode for SecKeychainSettings {
    const ENCODING: Encoding = Encoding::Struct(
        "SecKeychainSettings",
        &[
            <u32>::ENCODING,
            <Boolean>::ENCODING,
            <Boolean>::ENCODING,
            <u32>::ENCODING,
        ],
    );
}

#[cfg(feature = "objc2")]
unsafe impl RefEncode for SecKeychainSettings {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

/// The authentication type to use for an Internet password.
// NS_ENUM
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord, Default)]
pub struct SecAuthenticationType(pub FourCharCode);
impl SecAuthenticationType {
    /// Specifies Windows NT LAN Manager authentication.
    #[doc(alias = "kSecAuthenticationTypeNTLM")]
    pub const NTLM: Self = Self(AUTH_TYPE_FIX_!(0x6e746c6d));
    /// Specifies Microsoft Network default authentication.
    #[doc(alias = "kSecAuthenticationTypeMSN")]
    pub const MSN: Self = Self(AUTH_TYPE_FIX_!(0x6d736e61));
    /// Specifies Distributed Password authentication.
    #[doc(alias = "kSecAuthenticationTypeDPA")]
    pub const DPA: Self = Self(AUTH_TYPE_FIX_!(0x64706161));
    /// Specifies Remote Password authentication.
    #[doc(alias = "kSecAuthenticationTypeRPA")]
    pub const RPA: Self = Self(AUTH_TYPE_FIX_!(0x72706161));
    /// Specifies HTTP Basic authentication.
    #[doc(alias = "kSecAuthenticationTypeHTTPBasic")]
    pub const HTTPBasic: Self = Self(AUTH_TYPE_FIX_!(0x68747470));
    /// Specifies HTTP Digest Access authentication.
    #[doc(alias = "kSecAuthenticationTypeHTTPDigest")]
    pub const HTTPDigest: Self = Self(AUTH_TYPE_FIX_!(0x68747464));
    /// Specifies HTML form based authentication.
    #[doc(alias = "kSecAuthenticationTypeHTMLForm")]
    pub const HTMLForm: Self = Self(AUTH_TYPE_FIX_!(0x666f726d));
    /// Specifies the default authentication type.
    #[doc(alias = "kSecAuthenticationTypeDefault")]
    pub const Default: Self = Self(AUTH_TYPE_FIX_!(0x64666c74));
    /// Specifies that any authentication type is acceptable.
    ///
    /// ## Discussion
    ///
    /// When performing a search, use this value to avoid constraining your search results to a particular authentication type.
    ///
    ///
    #[doc(alias = "kSecAuthenticationTypeAny")]
    pub const Any: Self = Self(AUTH_TYPE_FIX_!(0));
}

#[cfg(feature = "objc2")]
unsafe impl Encode for SecAuthenticationType {
    const ENCODING: Encoding = FourCharCode::ENCODING;
}

#[cfg(feature = "objc2")]
unsafe impl RefEncode for SecAuthenticationType {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

/// The protocol type associated with an Internet password.
/// Defines the protocol type associated with an AppleShare or Internet password.
// NS_ENUM
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord, Default)]
pub struct SecProtocolType(pub FourCharCode);
impl SecProtocolType {
    /// Indicates FTP.
    #[doc(alias = "kSecProtocolTypeFTP")]
    pub const FTP: Self = Self(0x66747020);
    /// Indicates a client side FTP account. The usage of this constant is deprecated as of macOS 10.3.
    #[doc(alias = "kSecProtocolTypeFTPAccount")]
    pub const FTPAccount: Self = Self(0x66747061);
    /// Indicates HTTP.
    #[doc(alias = "kSecProtocolTypeHTTP")]
    pub const HTTP: Self = Self(0x68747470);
    /// Indicates IRC.
    #[doc(alias = "kSecProtocolTypeIRC")]
    pub const IRC: Self = Self(0x69726320);
    /// Indicates NNTP.
    #[doc(alias = "kSecProtocolTypeNNTP")]
    pub const NNTP: Self = Self(0x6e6e7470);
    /// Indicates POP3.
    #[doc(alias = "kSecProtocolTypePOP3")]
    pub const POP3: Self = Self(0x706f7033);
    /// Indicates SMTP.
    #[doc(alias = "kSecProtocolTypeSMTP")]
    pub const SMTP: Self = Self(0x736d7470);
    /// Indicates SOCKS.
    #[doc(alias = "kSecProtocolTypeSOCKS")]
    pub const SOCKS: Self = Self(0x736f7820);
    /// Indicates IMAP.
    #[doc(alias = "kSecProtocolTypeIMAP")]
    pub const IMAP: Self = Self(0x696d6170);
    /// Indicates LDAP.
    #[doc(alias = "kSecProtocolTypeLDAP")]
    pub const LDAP: Self = Self(0x6c646170);
    /// Indicates AFP over AppleTalk.
    #[doc(alias = "kSecProtocolTypeAppleTalk")]
    pub const AppleTalk: Self = Self(0x61746c6b);
    /// Indicates AFP over TCP.
    #[doc(alias = "kSecProtocolTypeAFP")]
    pub const AFP: Self = Self(0x61667020);
    /// Indicates Telnet.
    #[doc(alias = "kSecProtocolTypeTelnet")]
    pub const Telnet: Self = Self(0x74656c6e);
    /// Indicates SSH.
    #[doc(alias = "kSecProtocolTypeSSH")]
    pub const SSH: Self = Self(0x73736820);
    /// Indicates FTP over TLS/SSL.
    #[doc(alias = "kSecProtocolTypeFTPS")]
    pub const FTPS: Self = Self(0x66747073);
    /// Indicates HTTP over TLS/SSL.
    #[doc(alias = "kSecProtocolTypeHTTPS")]
    pub const HTTPS: Self = Self(0x68747073);
    /// Indicates HTTP proxy.
    #[doc(alias = "kSecProtocolTypeHTTPProxy")]
    pub const HTTPProxy: Self = Self(0x68747078);
    /// Indicates HTTPS proxy.
    #[doc(alias = "kSecProtocolTypeHTTPSProxy")]
    pub const HTTPSProxy: Self = Self(0x68747378);
    /// Indicates FTP proxy.
    #[doc(alias = "kSecProtocolTypeFTPProxy")]
    pub const FTPProxy: Self = Self(0x66747078);
    /// Indicates CIFS.
    #[doc(alias = "kSecProtocolTypeCIFS")]
    pub const CIFS: Self = Self(0x63696673);
    /// Indicates SMB.
    #[doc(alias = "kSecProtocolTypeSMB")]
    pub const SMB: Self = Self(0x736d6220);
    /// Indicates RTSP.
    #[doc(alias = "kSecProtocolTypeRTSP")]
    pub const RTSP: Self = Self(0x72747370);
    /// Indicates RTSP proxy.
    #[doc(alias = "kSecProtocolTypeRTSPProxy")]
    pub const RTSPProxy: Self = Self(0x72747378);
    /// Indicates DAAP.
    #[doc(alias = "kSecProtocolTypeDAAP")]
    pub const DAAP: Self = Self(0x64616170);
    /// Indicates Remote Apple Events.
    #[doc(alias = "kSecProtocolTypeEPPC")]
    pub const EPPC: Self = Self(0x65707063);
    /// Indicates IPP.
    #[doc(alias = "kSecProtocolTypeIPP")]
    pub const IPP: Self = Self(0x69707020);
    /// Indicates NNTP over TLS/SSL.
    #[doc(alias = "kSecProtocolTypeNNTPS")]
    pub const NNTPS: Self = Self(0x6e747073);
    /// Indicates LDAP over TLS/SSL.
    #[doc(alias = "kSecProtocolTypeLDAPS")]
    pub const LDAPS: Self = Self(0x6c647073);
    /// Indicates Telnet over TLS/SSL.
    #[doc(alias = "kSecProtocolTypeTelnetS")]
    pub const TelnetS: Self = Self(0x74656c73);
    /// Indicates IMAP4 over TLS/SSL.
    #[doc(alias = "kSecProtocolTypeIMAPS")]
    pub const IMAPS: Self = Self(0x696d7073);
    /// Indicates IRC over TLS/SSL.
    #[doc(alias = "kSecProtocolTypeIRCS")]
    pub const IRCS: Self = Self(0x69726373);
    /// Indicates POP3 over TLS/SSL.
    #[doc(alias = "kSecProtocolTypePOP3S")]
    pub const POP3S: Self = Self(0x706f7073);
    /// Indicates CVS pserver.
    #[doc(alias = "kSecProtocolTypeCVSpserver")]
    pub const CVSpserver: Self = Self(0x63767370);
    /// Indicates Subversion.
    #[doc(alias = "kSecProtocolTypeSVN")]
    pub const SVN: Self = Self(0x73766e20);
    /// Indicates that any protocol is acceptable.
    ///
    /// ## Discussion
    ///
    /// When performing a search, use this constant to avoid constraining your search results to a particular protocol.
    ///
    ///
    #[doc(alias = "kSecProtocolTypeAny")]
    pub const Any: Self = Self(0);
}

#[cfg(feature = "objc2")]
unsafe impl Encode for SecProtocolType {
    const ENCODING: Encoding = FourCharCode::ENCODING;
}

#[cfg(feature = "objc2")]
unsafe impl RefEncode for SecProtocolType {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

/// The list of keychain events that can trigger a callback.
///
/// ## Overview
///
/// Keychain Services includes one of these events in the callback you register with [`SecKeychainAddCallback`](https://developer.apple.com/documentation/security/seckeychainaddcallback(_:_:_:)), using the function signature defined by [`SecKeychainCallback`](https://developer.apple.com/documentation/security/seckeychaincallback), to indicate what event triggered the callback.
///
///
/// Defines the keychain-related event.
// NS_ENUM
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord)]
pub struct SecKeychainEvent(pub u32);
impl SecKeychainEvent {
    /// Indicates a keychain was locked.
    ///
    /// ## Discussion
    ///
    /// It is impossible to distinguish between a lock event caused by an explicit request and one caused by a keychain that locked itself because of a timeout. Therefore, the `pid` parameter in the [`SecKeychainCallbackInfo`](https://developer.apple.com/documentation/security/seckeychaincallbackinfo) structure does not contain useful information for this event. Note that when the login session terminates, all keychains become effectively locked; however, no `kSecLockEvent` events are generated in this case.
    ///
    ///
    #[doc(alias = "kSecLockEvent")]
    pub const LockEvent: Self = Self(1);
    /// Indicates a keychain was successfully unlocked.
    ///
    /// ## Discussion
    ///
    /// It is impossible to distinguish between an unlock event caused by an explicit request and one that occurred automatically because the keychain was needed to perform an operation. In either case, however, the `pid` parameter in the `SecKeychainCallbackInfo` structure does return the ID of the process whose actions caused the unlock event.
    ///
    ///
    #[doc(alias = "kSecUnlockEvent")]
    pub const UnlockEvent: Self = Self(2);
    /// Indicates an item was added to a keychain.
    #[doc(alias = "kSecAddEvent")]
    pub const AddEvent: Self = Self(3);
    /// Indicates an item was deleted from a keychain.
    #[doc(alias = "kSecDeleteEvent")]
    pub const DeleteEvent: Self = Self(4);
    /// Indicates a keychain item was updated.
    #[doc(alias = "kSecUpdateEvent")]
    pub const UpdateEvent: Self = Self(5);
    /// Indicates the keychain password was changed.
    #[doc(alias = "kSecPasswordChangedEvent")]
    pub const PasswordChangedEvent: Self = Self(6);
    /// Indicates that a different keychain was specified as the default.
    #[doc(alias = "kSecDefaultChangedEvent")]
    pub const DefaultChangedEvent: Self = Self(9);
    /// Indicates a process has accessed a keychain item’s data.
    #[doc(alias = "kSecDataAccessEvent")]
    #[deprecated = "Read events are no longer posted"]
    pub const DataAccessEvent: Self = Self(10);
    /// Indicates the list of keychains has changed.
    #[doc(alias = "kSecKeychainListChangedEvent")]
    pub const KeychainListChangedEvent: Self = Self(11);
    /// Indicates trust settings have changed.
    #[doc(alias = "kSecTrustSettingsChangedEvent")]
    pub const TrustSettingsChangedEvent: Self = Self(12);
}

#[cfg(feature = "objc2")]
unsafe impl Encode for SecKeychainEvent {
    const ENCODING: Encoding = u32::ENCODING;
}

#[cfg(feature = "objc2")]
unsafe impl RefEncode for SecKeychainEvent {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

/// Bit masks corresponding to the events that can trigger a keychain callback.
///
/// ## Overview
///
/// Bitwise `OR` one or more of these masks together to provide the `eventMask` input to the [`SecKeychainAddCallback`](https://developer.apple.com/documentation/security/seckeychainaddcallback(_:_:_:)) function to indicate what event or events should trigger your callback.
///
///
/// Defines keychain event constants
// NS_OPTIONS
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord, Default)]
pub struct SecKeychainEventMask(pub u32);
bitflags::bitflags! {
    impl SecKeychainEventMask: u32 {
/// If the bit specified by this mask is set, your callback function is invoked when a keychain is locked.
        #[doc(alias = "kSecLockEventMask")]
        const LockEventMask = 1<<SecKeychainEvent::LockEvent.0;
/// If the bit specified by this mask is set, your callback function is invoked when a keychain is unlocked.
        #[doc(alias = "kSecUnlockEventMask")]
        const UnlockEventMask = 1<<SecKeychainEvent::UnlockEvent.0;
/// If the bit specified by this mask is set, your callback function is invoked when an item is added to a keychain.
        #[doc(alias = "kSecAddEventMask")]
        const AddEventMask = 1<<SecKeychainEvent::AddEvent.0;
/// If the bit specified by this mask is set, your callback function is invoked when an item is deleted from a keychain.
        #[doc(alias = "kSecDeleteEventMask")]
        const DeleteEventMask = 1<<SecKeychainEvent::DeleteEvent.0;
/// If the bit specified by this mask is set, your callback function is invoked when a keychain item is updated.
        #[doc(alias = "kSecUpdateEventMask")]
        const UpdateEventMask = 1<<SecKeychainEvent::UpdateEvent.0;
/// If the bit specified by this mask is set, your callback function is invoked when the keychain password is changed.
        #[doc(alias = "kSecPasswordChangedEventMask")]
        const PasswordChangedEventMask = 1<<SecKeychainEvent::PasswordChangedEvent.0;
/// If the bit specified by this mask is set, your callback function is invoked when a different keychain is specified as the default.
        #[doc(alias = "kSecDefaultChangedEventMask")]
        const DefaultChangedEventMask = 1<<SecKeychainEvent::DefaultChangedEvent.0;
/// If the bit specified by this mask is set, your callback function is invoked when a process accesses a keychain item’s data.
        #[doc(alias = "kSecDataAccessEventMask")]
#[deprecated = "Read events are no longer posted"]
        const DataAccessEventMask = 1<<SecKeychainEvent::DataAccessEvent.0;
/// If the bit specified by this mask is set, your callback function is invoked when a keychain list is changed.
        #[doc(alias = "kSecKeychainListChangedMask")]
        const KeychainListChangedMask = 1<<SecKeychainEvent::KeychainListChangedEvent.0;
/// If the bit specified by this mask is set, your callback function is invoked when there is a change in certificate trust settings.
        #[doc(alias = "kSecTrustSettingsChangedEventMask")]
        const TrustSettingsChangedEventMask = 1<<SecKeychainEvent::TrustSettingsChangedEvent.0;
/// If all the bits are set, your callback function is invoked whenever any event occurs.
        #[doc(alias = "kSecEveryEventMask")]
        const EveryEventMask = 0xffffffff;
    }
}

#[cfg(feature = "objc2")]
unsafe impl Encode for SecKeychainEventMask {
    const ENCODING: Encoding = u32::ENCODING;
}

#[cfg(feature = "objc2")]
unsafe impl RefEncode for SecKeychainEventMask {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

/// Information about a keychain event that keychain services deliver to your app via a callback function.
///
/// ## Overview
///
/// This structure contains information about the keychain event of which your application wants to be notified. Keychain services pass a pointer to this structure in the `info` parameter of your callback function. For information on how to write a keychain event callback function, see [`SecKeychainCallback`](https://developer.apple.com/documentation/security/seckeychaincallback).
///
///
/// Contains information about a keychain event.
/// Field: version The version of this structure.
/// Field: item A reference to the keychain item associated with this event, if any. Note that some events do not involve a particular keychain item.
/// Field: keychain A reference to the keychain in which the event occurred.
/// Field: pid The id of the process that generated this event.
///
/// The SecKeychainCallbackInfo type represents a structure that contains information about the keychain event for which your application is being notified. For information on how to write a keychain event callback function, see SecKeychainCallback.
#[cfg(all(feature = "SecBase", feature = "libc"))]
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct SecKeychainCallbackInfo {
    pub version: u32,
    pub item: NonNull<SecKeychainItem>,
    pub keychain: NonNull<SecKeychain>,
    pub pid: libc::pid_t,
}

#[cfg(all(feature = "SecBase", feature = "libc", feature = "objc2"))]
unsafe impl Encode for SecKeychainCallbackInfo {
    const ENCODING: Encoding = Encoding::Struct(
        "SecKeychainCallbackInfo",
        &[
            <u32>::ENCODING,
            <NonNull<SecKeychainItem>>::ENCODING,
            <NonNull<SecKeychain>>::ENCODING,
            <libc::pid_t>::ENCODING,
        ],
    );
}

#[cfg(all(feature = "SecBase", feature = "libc", feature = "objc2"))]
unsafe impl RefEncode for SecKeychainCallbackInfo {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(feature = "SecBase")]
unsafe impl ConcreteType for SecKeychain {
    /// Returns the unique identifier of the opaque type to which a keychain object belongs.
    ///
    /// ## Return Value
    ///
    /// A value that identifies the opaque type of a [`SecKeychainRef`](https://developer.apple.com/documentation/security/seckeychain) object.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// This function returns a value that uniquely identifies the opaque type of a [`SecKeychainRef`](https://developer.apple.com/documentation/security/seckeychain) object. You can compare this value to the [`CFTypeID`](https://developer.apple.com/documentation/corefoundation/cftypeid) identifier obtained by calling the [`CFGetTypeID`](https://developer.apple.com/documentation/corefoundation/cfgettypeid(_:)) function on a specific object. These values might change from release to release or platform to platform.
    ///
    ///
    /// Returns the type identifier of SecKeychain instances.
    ///
    /// Returns: The CFTypeID of SecKeychain instances.
    #[doc(alias = "SecKeychainGetTypeID")]
    #[inline]
    fn type_id() -> CFTypeID {
        extern "C-unwind" {
            fn SecKeychainGetTypeID() -> CFTypeID;
        }
        unsafe { SecKeychainGetTypeID() }
    }
}

#[cfg(feature = "SecBase")]
impl SecKeychain {
    /// Determines the version of keychain services installed on the user’s system.
    ///
    /// Parameters:
    /// - returnVers: On return, a pointer to the version number of keychain services installed on the current system. See `Keychain Settings Version` for a list of values.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Your application can call the [`SecKeychainGetVersion`](https://developer.apple.com/documentation/security/seckeychaingetversion(_:)) function to find out which version of keychain services is installed on the user’s system.
    ///
    ///
    /// Determines the version of the Keychain Manager installed on the user�s system.
    ///
    /// Parameter `returnVers`: On return, a pointer to the version number of the Keychain Manager installed on the current system.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// # Safety
    ///
    /// `return_vers` must be a valid pointer.
    #[doc(alias = "SecKeychainGetVersion")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn version(return_vers: NonNull<u32>) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainGetVersion(return_vers: NonNull<u32>) -> OSStatus;
        }
        unsafe { SecKeychainGetVersion(return_vers) }
    }

    /// Opens a keychain.
    ///
    /// Parameters:
    /// - pathName: A constant character string representing the POSIX path to the keychain to open.
    ///
    /// - keychain: On return, a pointer to the keychain object. You must call the `CFRelease` function to release this object when you are finished using it.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Use this function to retrieve a pointer to a keychain object given the path of the keychain. You don’t need to close the keychain, but do release the memory that the pointer occupies when you are finished with it.
    ///
    ///
    /// Create a SecKeychainRef for a keychain at pathName.  This keychain might
    /// not currently exist, use SecKeychainGetStatus if you want to confirm the existence
    /// of this keychain.
    ///
    /// Parameter `pathName`: The POSIX path to a keychain.
    ///
    /// Parameter `keychain`: On return, a pointer to the keychain reference. The memory that keychain occupies must be released by calling CFRelease when finished with it.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h). In addition, errSecParam (-50) may be returned if the keychain parameter is invalid (NULL).
    ///
    /// # Safety
    ///
    /// - `path_name` must be a valid pointer.
    /// - `keychain` must be a valid pointer.
    #[doc(alias = "SecKeychainOpen")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn open(
        path_name: NonNull<c_char>,
        keychain: NonNull<*mut SecKeychain>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainOpen(
                path_name: NonNull<c_char>,
                keychain: NonNull<*mut SecKeychain>,
            ) -> OSStatus;
        }
        unsafe { SecKeychainOpen(path_name, keychain) }
    }

    /// Creates an empty keychain.
    ///
    /// Parameters:
    /// - pathName: A constant character string representing the POSIX path indicating where to store the keychain.
    ///
    /// - passwordLength: An unsigned 32-bit integer representing the length of the buffer pointed to by `password`. Pass `0` if the value of `password` is `NULL` and the value of `promptUser` is `TRUE`.
    ///
    /// - password: A pointer to the buffer containing the password which is used to protect the new keychain. The password must be in canonical UTF-8 encoding. Pass `NULL` if the value of `passwordLength` is `0` and the value of `promptUser` is `TRUE`.
    ///
    /// - promptUser: A Boolean value representing whether to display a password dialog to the user. Set this value to `TRUE` to display a password dialog or `FALSE` otherwise. If you pass `TRUE`, any values passed for `passwordLength` and `password` are ignored, and a dialog for the user to enter a password is presented.
    ///
    /// - initialAccess: Ignored. Pass `NULL` for this parameter.
    ///
    /// - keychain: On return, a pointer to a keychain object. You must call the `CFRelease` function to release this object when you are finished using it.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// This function creates an empty keychain. The `keychain`, `password`, and `initialAccess` parameters are optional. If user interaction to create a keychain is posted, the newly-created keychain is automatically unlocked after creation.
    ///
    /// The system ensures that a default keychain is created for the user at login, thus, in most cases, you do not need to call this function yourself. Users can create additional keychains, or change the default, by using the Keychain Access application. However, a missing default keychain is not recreated automatically, and you may receive an `errSecNoDefaultKeychain` error from other functions if a default keychain does not exist. In that case, you can use this function followed by [`SecKeychainSetDefault`](https://developer.apple.com/documentation/security/seckeychainsetdefault(_:)), to create a new default keychain. You can also call this function to create a private temporary keychain for your application’s use, in cases where no user interaction can occur.
    ///
    ///
    /// Creates a new keychain.
    ///
    /// Parameter `pathName`: The POSIX path to a keychain file.
    ///
    /// Parameter `passwordLength`: An unsigned 32-bit integer representing the length of the password buffer.
    ///
    /// Parameter `password`: A pointer to the buffer containing the password. The password must be in canonical UTF8 encoding.
    ///
    /// Parameter `promptUser`: A boolean representing whether to display a password dialog to the user.
    ///
    /// Parameter `initialAccess`: An access reference.
    ///
    /// Parameter `keychain`: On return, a pointer to a keychain reference. The memory that keychain occupies must be released by calling CFRelease when finished with it.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h). In addition, errSecParam (-50) may be returned if the keychain parameter is invalid (NULL).
    ///
    /// # Safety
    ///
    /// - `path_name` must be a valid pointer.
    /// - `password` must be a valid pointer or null.
    /// - `keychain` must be a valid pointer.
    #[doc(alias = "SecKeychainCreate")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn create(
        path_name: NonNull<c_char>,
        password_length: u32,
        password: *const c_void,
        prompt_user: bool,
        initial_access: Option<&SecAccess>,
        keychain: NonNull<*mut SecKeychain>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainCreate(
                path_name: NonNull<c_char>,
                password_length: u32,
                password: *const c_void,
                prompt_user: Boolean,
                initial_access: Option<&SecAccess>,
                keychain: NonNull<*mut SecKeychain>,
            ) -> OSStatus;
        }
        unsafe {
            SecKeychainCreate(
                path_name,
                password_length,
                password,
                prompt_user as _,
                initial_access,
                keychain,
            )
        }
    }

    /// Deletes one or more keychains from the default keychain search list, and removes the keychain itself if it is a file.
    ///
    /// Parameters:
    /// - keychainOrArray: A single keychain object or a reference to an array of keychains you wish to delete. To delete more than one keychain, create a `CFArray` of keychain references (type `SecKeychainRef`) and pass a reference to the array.
    ///
    /// In macOS 10.3 and later, passing `NULL` to this parameter returns an `errSecInvalidKeychain` error code. In OS X 10.2, this parameter was named `keychain` and only took a single keychain object. Passing `NULL` to this parameter deleted the user’s default keychain.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). The result code [`errSecInvalidKeychain`](https://developer.apple.com/documentation/security/errsecinvalidkeychain) is returned if the specified keychain is invalid or if the value of the `keychainOrArray` parameter is invalid or `NULL`.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// The keychain may be a file stored locally, a smart card, or retrieved from a network server using non-file-based database protocols. This function deletes the keychain only if it is a local file.
    ///
    /// This function does not release the memory used by the keychain object. In Objective-C, call the [`CFRelease`](https://developer.apple.comhttps://developer.apple.com/documentation/corefoundation/1521153-cfrelease) function to release each keychain object when you are finished with it.
    ///
    ///
    /// Removes one or more keychains from the current keychain searchlist, and deletes the keychain storage (if the keychains are file-based).
    ///
    /// Parameter `keychainOrArray`: A single keychain reference or a reference to an array of keychains to delete. IMPORTANT: SecKeychainDelete does not dispose the memory occupied by keychain references; use the CFRelease function when you are completely finished with a keychain.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h). In addition, errSecInvalidKeychain (-25295) may be returned if the keychain parameter is invalid (NULL).
    #[doc(alias = "SecKeychainDelete")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn delete(keychain_or_array: Option<&SecKeychain>) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainDelete(keychain_or_array: Option<&SecKeychain>) -> OSStatus;
        }
        unsafe { SecKeychainDelete(keychain_or_array) }
    }

    /// Changes the settings of a keychain.
    ///
    /// Parameters:
    /// - keychain: A reference to a keychain whose settings you wish to change. Pass `NULL` to change the settings of the default keychain.
    ///
    /// - newSettings: A pointer to a keychain settings structure that defines whether the keychain locks when sleeping, or locks after a set time period of inactivity.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    /// Changes the settings of a keychain.
    ///
    /// Parameter `keychain`: A reference to a keychain.
    ///
    /// Parameter `newSettings`: A pointer to the new keychain settings.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// # Safety
    ///
    /// `new_settings` must be a valid pointer.
    #[doc(alias = "SecKeychainSetSettings")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn set_settings(
        keychain: Option<&SecKeychain>,
        new_settings: NonNull<SecKeychainSettings>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainSetSettings(
                keychain: Option<&SecKeychain>,
                new_settings: NonNull<SecKeychainSettings>,
            ) -> OSStatus;
        }
        unsafe { SecKeychainSetSettings(keychain, new_settings) }
    }

    /// Obtains a keychain’s settings.
    ///
    /// Parameters:
    /// - keychain: A reference to the keychain from which to copy its settings.
    ///
    /// - outSettings: On return, a pointer to a keychain settings structure. Since this structure is versioned, you must allocate the memory for it and fill in the version of the structure before passing it to the function.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    /// Copy the keychain settings.
    ///
    /// Parameter `keychain`: A reference to the keychain from which to copy its settings.
    ///
    /// Parameter `outSettings`: A pointer to a keychain settings structure. Since this structure is versioned, you must preallocate it and fill in the version of the structure.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// # Safety
    ///
    /// `out_settings` must be a valid pointer.
    #[doc(alias = "SecKeychainCopySettings")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn copy_settings(
        keychain: Option<&SecKeychain>,
        out_settings: NonNull<SecKeychainSettings>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainCopySettings(
                keychain: Option<&SecKeychain>,
                out_settings: NonNull<SecKeychainSettings>,
            ) -> OSStatus;
        }
        unsafe { SecKeychainCopySettings(keychain, out_settings) }
    }

    /// Unlocks a keychain.
    ///
    /// Parameters:
    /// - keychain: A reference to the keychain to unlock. Pass `NULL` to specify the default keychain. If you pass a locked keychain, this function displays the Unlock Keychain dialog box if you have not provided a password. If the specified keychain is currently unlocked, the Unlock Keychain dialog box is not displayed and this function returns `noErr`. You must call the `CFRelease` function to release this object when you are finished using it.
    ///
    /// - passwordLength: An unsigned 32-bit integer representing the length of the password buffer.
    ///
    /// - password: A buffer containing the password for the keychain. Pass `NULL` if the user password is unknown. In this case, this function displays the Unlock Keychain dialog to prompt the user for the keychain password.
    ///
    /// - usePassword: A Boolean value indicating whether the password parameter is used. You should pass `TRUE` if you are passing a password or `FALSE` if it is to be ignored.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). The result code [`errSecUserCanceled`](https://developer.apple.com/documentation/security/errsecusercanceled) indicates that the user pressed the Cancel button in the Unlock Keychain dialog box. The result code [`errSecAuthFailed`](https://developer.apple.com/documentation/security/errsecauthfailed) indicates that authentication failed because of too many unsuccessful retries. The result code [`errSecInteractionRequired`](https://developer.apple.com/documentation/security/errsecinteractionrequired) indicates that user interaction is required to unlock the keychain.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// In most cases, your application does not need to call this function directly, since most Keychain Services functions that require an unlocked keychain do so for you. If your application needs to verify that a keychain is unlocked, call the function [`SecKeychainGetStatus`](https://developer.apple.com/documentation/security/seckeychaingetstatus(_:_:)).
    ///
    ///
    /// Unlocks the specified keychain.
    ///
    /// Parameter `keychain`: A reference to the keychain to unlock. Pass NULL to specify the default keychain. If you pass NULL and the default keychain is currently locked, the keychain will appear as the default choice. If you pass a locked keychain, SecKeychainUnlock will use the password provided to unlock it. If the default keychain is currently unlocked, SecKeychainUnlock returns errSecSuccess.
    ///
    /// Parameter `passwordLength`: An unsigned 32-bit integer representing the length of the password buffer.
    ///
    /// Parameter `password`: A buffer containing the password for the keychain. Pass NULL if the user password is unknown. In this case, SecKeychainUnlock displays the Unlock Keychain dialog box, and the authentication user interface associated with the keychain about to be unlocked.
    ///
    /// Parameter `usePassword`: A boolean indicating whether the password parameter is used.  You should pass TRUE if it is used or FALSE if it is ignored.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// In most cases, your application does not need to call the SecKeychainUnlock function directly, since most Keychain Manager functions that require an unlocked keychain call SecKeychainUnlock automatically. If your application needs to verify that a keychain is unlocked, call the function SecKeychainGetStatus.
    ///
    /// # Safety
    ///
    /// `password` must be a valid pointer or null.
    #[doc(alias = "SecKeychainUnlock")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn unlock(
        keychain: Option<&SecKeychain>,
        password_length: u32,
        password: *const c_void,
        use_password: bool,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainUnlock(
                keychain: Option<&SecKeychain>,
                password_length: u32,
                password: *const c_void,
                use_password: Boolean,
            ) -> OSStatus;
        }
        unsafe { SecKeychainUnlock(keychain, password_length, password, use_password as _) }
    }

    /// Locks a keychain.
    ///
    /// Parameters:
    /// - keychain: A reference to the keychain to lock. Pass `NULL` to lock the default keychain.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). The result code [`errSecNoSuchKeychain`](https://developer.apple.com/documentation/security/errsecnosuchkeychain) indicates that specified keychain could not be found. The result code [`errSecInvalidKeychain`](https://developer.apple.com/documentation/security/errsecinvalidkeychain) indicates that the specified keychain is invalid.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Your application should not call this function unless you are responding to a user’s request to lock a keychain. In general, you should leave the keychain unlocked so that the user does not have to unlock it again in another application.
    ///
    ///
    /// Locks the specified keychain.
    ///
    /// Parameter `keychain`: A reference to the keychain to lock.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    #[doc(alias = "SecKeychainLock")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn lock(keychain: Option<&SecKeychain>) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainLock(keychain: Option<&SecKeychain>) -> OSStatus;
        }
        unsafe { SecKeychainLock(keychain) }
    }

    /// Locks all keychains belonging to the current user.
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Your application should not call this function unless you are responding to a user’s request to lock a keychain. In general, you should leave the keychain unlocked so that the user does not have to unlock it again in another application.
    ///
    ///
    /// Locks all keychains belonging to the current user.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    #[doc(alias = "SecKeychainLockAll")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn lock_all() -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainLockAll() -> OSStatus;
        }
        unsafe { SecKeychainLockAll() }
    }

    /// Retrieves a pointer to the default keychain.
    ///
    /// Parameters:
    /// - keychain: On return, a pointer to the default keychain object. In Objective-C, call the [`CFRelease`](https://developer.apple.comhttps://developer.apple.com/documentation/corefoundation/1521153-cfrelease) function to release this object when you are finished using it.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). The result code [`errSecNoDefaultKeychain`](https://developer.apple.com/documentation/security/errsecnodefaultkeychain) indicates that there is no default keychain.
    ///
    ///
    /// Retrieves a reference to the default keychain.
    ///
    /// Parameter `keychain`: On return, a pointer to the default keychain reference.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// # Safety
    ///
    /// `keychain` must be a valid pointer.
    #[doc(alias = "SecKeychainCopyDefault")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn copy_default(keychain: NonNull<*mut SecKeychain>) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainCopyDefault(keychain: NonNull<*mut SecKeychain>) -> OSStatus;
        }
        unsafe { SecKeychainCopyDefault(keychain) }
    }

    /// Sets the default keychain.
    ///
    /// Parameters:
    /// - keychain: A reference to the keychain you wish to make the default.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). The result code [`errSecNoSuchKeychain`](https://developer.apple.com/documentation/security/errsecnosuchkeychain) indicates that the specified keychain could not be found. The result code [`errSecInvalidKeychain`](https://developer.apple.com/documentation/security/errsecinvalidkeychain) indicates that the specified keychain is invalid.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// In most cases, your application should not need to set the default keychain, because this is a choice normally made by the user. You may call this function to change where a password or other keychain items are added, but since this is a user choice, you should set the default keychain back to the user specified keychain when you are done.
    ///
    ///
    /// Sets the default keychain.
    ///
    /// Parameter `keychain`: A reference to the keychain to set as default.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h). In addition, errSecParam (-50) may be returned if the keychain parameter is invalid (NULL).
    #[doc(alias = "SecKeychainSetDefault")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn set_default(keychain: Option<&SecKeychain>) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainSetDefault(keychain: Option<&SecKeychain>) -> OSStatus;
        }
        unsafe { SecKeychainSetDefault(keychain) }
    }

    /// Retrieves a keychain search list.
    ///
    /// Parameters:
    /// - searchList: On return, the returned keychain search list. In Objective-C, call the [`CFRelease`](https://developer.apple.comhttps://developer.apple.com/documentation/corefoundation/1521153-cfrelease) function to release this object when you are finished using it.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    /// Retrieves a keychain search list.
    ///
    /// Parameter `searchList`: The returned list of keychains to search. When finished with the array, you must call CFRelease() to release the memory.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h). In addition, errSecParam (-50) may be returned if the keychain list is not specified (NULL).
    ///
    /// # Safety
    ///
    /// `search_list` must be a valid pointer.
    #[doc(alias = "SecKeychainCopySearchList")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn copy_search_list(search_list: NonNull<*const CFArray>) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainCopySearchList(search_list: NonNull<*const CFArray>) -> OSStatus;
        }
        unsafe { SecKeychainCopySearchList(search_list) }
    }

    /// Specifies the list of keychains to use in the default keychain search list.
    ///
    /// Parameters:
    /// - searchList: An array of keychain references (of type [`SecKeychainRef`](https://developer.apple.com/documentation/security/seckeychain)) specifying the list of keychains to use in the default keychain search list. Passing an empty array clears the search list.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// The default keychain search list is used by several functions; see for example [`SecKeychainSearchCreateFromAttributes`](https://developer.apple.com/documentation/security/seckeychainsearchcreatefromattributes), [`SecKeychainFindInternetPassword`](https://developer.apple.com/documentation/security/seckeychainfindinternetpassword(_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:)), or [`SecKeychainFindGenericPassword`](https://developer.apple.com/documentation/security/seckeychainfindgenericpassword(_:_:_:_:_:_:_:_:)). To obtain the current default keychain search list, use the [`SecKeychainCopySearchList`](https://developer.apple.com/documentation/security/seckeychaincopysearchlist(_:)) function.
    ///
    /// The default keychain search list is displayed as the keychain list in the Keychain Access utility. If you use [`SecKeychainSetSearchList`](https://developer.apple.com/documentation/security/seckeychainsetsearchlist(_:)) to change the keychain search list, the list displayed in Keychain Access changes accordingly.
    ///
    ///
    /// Specifies the list of keychains to use in a keychain search list.
    ///
    /// Parameter `searchList`: The list of keychains to use in a search list when the SecKeychainCopySearchList function is called. An empty array clears the search list.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h). In addition, errSecParam (-50) may be returned if the keychain list is not specified (NULL).
    ///
    /// # Safety
    ///
    /// `search_list` generic must be of the correct type.
    #[doc(alias = "SecKeychainSetSearchList")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn set_search_list(search_list: &CFArray) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainSetSearchList(search_list: &CFArray) -> OSStatus;
        }
        unsafe { SecKeychainSetSearchList(search_list) }
    }
}

/// The keychain preference domains.
///
/// ## Overview
///
/// A preference domain is a set of security-related preferences, such as the default keychain and the current keychain search list. The default preference domain for system daemons (that is, for daemons running in the root session) is the system domain. The default preference domain for all other programs is the user domain. A common preference appears for all users and the system. For example, if you add a keychain to the keychain search list using [`kSecPreferencesDomainCommon`](https://developer.apple.com/documentation/security/secpreferencesdomain/common) for the preference domain, the keychain is added to the search list for all users and the system.
///
///
// NS_ENUM
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord, Default)]
pub struct SecPreferencesDomain(pub c_int);
impl SecPreferencesDomain {
    /// Indicates the user preference domain preferences.
    #[doc(alias = "kSecPreferencesDomainUser")]
    pub const User: Self = Self(0);
    /// Indicates the system or daemon preference domain preferences.
    #[doc(alias = "kSecPreferencesDomainSystem")]
    pub const System: Self = Self(1);
    /// Indicates the preferences are common to everyone.
    #[doc(alias = "kSecPreferencesDomainCommon")]
    pub const Common: Self = Self(2);
    /// Indicates a dynamic search list (typically provided by removable keychains such as smart cards).
    #[doc(alias = "kSecPreferencesDomainDynamic")]
    pub const Dynamic: Self = Self(3);
}

#[cfg(feature = "objc2")]
unsafe impl Encode for SecPreferencesDomain {
    const ENCODING: Encoding = c_int::ENCODING;
}

#[cfg(feature = "objc2")]
unsafe impl RefEncode for SecPreferencesDomain {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(feature = "SecBase")]
impl SecKeychain {
    /// Retrieves the default keychain from a specified preference domain.
    ///
    /// Parameters:
    /// - domain: The preference domain from which you wish to retrieve the default keychain. See [`SecPreferencesDomain`](https://developer.apple.com/documentation/security/secpreferencesdomain) for possible domain values.
    ///
    /// - keychain: On return, a pointer to the keychain object of the default keychain in the specified preference domain.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// A preference domain is a set of security-related preferences, such as the default keychain and the current keychain search list. Use this function if you want to retrieve the default keychain for a specific preference domain. Use the [`SecKeychainCopyDefault`](https://developer.apple.com/documentation/security/seckeychaincopydefault(_:)) function if you want the default keychain for the current preference domain. See the [`SecKeychainSetPreferenceDomain`](https://developer.apple.com/documentation/security/seckeychainsetpreferencedomain(_:)) function for a discussion of current and default preference domains.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `keychain` must be a valid pointer.
    #[doc(alias = "SecKeychainCopyDomainDefault")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn copy_domain_default(
        domain: SecPreferencesDomain,
        keychain: NonNull<*mut SecKeychain>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainCopyDomainDefault(
                domain: SecPreferencesDomain,
                keychain: NonNull<*mut SecKeychain>,
            ) -> OSStatus;
        }
        unsafe { SecKeychainCopyDomainDefault(domain, keychain) }
    }

    /// Sets the default keychain for a specified preference domain.
    ///
    /// Parameters:
    /// - domain: The preference domain for which you wish to set the default keychain. See [`SecPreferencesDomain`](https://developer.apple.com/documentation/security/secpreferencesdomain) for possible domain values.
    ///
    /// - keychain: A reference to the keychain you wish to set as default in the specified preference domain.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// A preference domain is a set of security-related preferences, such as the default keychain and the current keychain search list. Use this function if you want to set the default keychain for a specific preference domain. Use the [`SecKeychainSetDefault`](https://developer.apple.com/documentation/security/seckeychainsetdefault(_:)) function if you want to set the default keychain for the current preference domain. See the [`SecKeychainSetPreferenceDomain`](https://developer.apple.com/documentation/security/seckeychainsetpreferencedomain(_:)) function for a discussion of current and default preference domains.
    ///
    ///
    #[doc(alias = "SecKeychainSetDomainDefault")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn set_domain_default(
        domain: SecPreferencesDomain,
        keychain: Option<&SecKeychain>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainSetDomainDefault(
                domain: SecPreferencesDomain,
                keychain: Option<&SecKeychain>,
            ) -> OSStatus;
        }
        unsafe { SecKeychainSetDomainDefault(domain, keychain) }
    }

    /// Retrieves the keychain search list for a specified preference domain.
    ///
    /// Parameters:
    /// - domain: The preference domain from which you wish to retrieve the keychain search list. See [`SecPreferencesDomain`](https://developer.apple.com/documentation/security/secpreferencesdomain) for possible domain values.
    ///
    /// - searchList: On return, a pointer to the keychain search list of the specified preference domain.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// A preference domain is a set of security-related preferences, such as the default keychain and the current keychain search list. Use this function if you want to retrieve the keychain search list for a specific preference domain. Use the [`SecKeychainCopySearchList`](https://developer.apple.com/documentation/security/seckeychaincopysearchlist(_:)) function if you want the keychain search list for the current preference domain. See the [`SecKeychainSetPreferenceDomain`](https://developer.apple.com/documentation/security/seckeychainsetpreferencedomain(_:)) function for a discussion of current and default preference domains.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `search_list` must be a valid pointer.
    #[doc(alias = "SecKeychainCopyDomainSearchList")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn copy_domain_search_list(
        domain: SecPreferencesDomain,
        search_list: NonNull<*const CFArray>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainCopyDomainSearchList(
                domain: SecPreferencesDomain,
                search_list: NonNull<*const CFArray>,
            ) -> OSStatus;
        }
        unsafe { SecKeychainCopyDomainSearchList(domain, search_list) }
    }

    /// Sets the keychain search list for a specified preference domain.
    ///
    /// Parameters:
    /// - domain: The preference domain for which you wish to set the default keychain search list. See [`SecPreferencesDomain`](https://developer.apple.com/documentation/security/secpreferencesdomain)for possible domain values.
    ///
    /// - searchList: A pointer to a keychain search list to set in the preference domain.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// A preference domain is a set of security-related preferences, such as the default keychain and the current keychain search list. Use this function if you want to set the keychain search list for a specific preference domain. Use the [`SecKeychainSetSearchList`](https://developer.apple.com/documentation/security/seckeychainsetsearchlist(_:)) function if you want to set the keychain search list for the current preference domain. See the [`SecKeychainSetPreferenceDomain`](https://developer.apple.com/documentation/security/seckeychainsetpreferencedomain(_:)) function for a discussion of current and default preference domains.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `search_list` generic must be of the correct type.
    #[doc(alias = "SecKeychainSetDomainSearchList")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn set_domain_search_list(
        domain: SecPreferencesDomain,
        search_list: &CFArray,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainSetDomainSearchList(
                domain: SecPreferencesDomain,
                search_list: &CFArray,
            ) -> OSStatus;
        }
        unsafe { SecKeychainSetDomainSearchList(domain, search_list) }
    }

    /// Sets the keychain preference domain.
    ///
    /// Parameters:
    /// - domain: The keychain preference domain to set. See [`SecPreferencesDomain`](https://developer.apple.com/documentation/security/secpreferencesdomain) for possible domain values.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// A preference domain is a set of security-related preferences, such as the default keychain and the current keychain search list. The default preference domain for system daemons (that is, for daemons running in the root session) is the system domain. The default preference domain for all other programs is the user domain.
    ///
    /// This function changes the preference domain for all subsequent function calls; for example, if you change from the system domain to the user domain and then call [`SecKeychainLock`](https://developer.apple.com/documentation/security/seckeychainlock(_:)) specifying `NULL` for the keychain, the function locks the default system keychain rather than the default user keychain. You might want to use this function, for example, when launching a system daemon from a user session so that the daemon uses system preferences rather than user preferences.
    ///
    ///
    #[doc(alias = "SecKeychainSetPreferenceDomain")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn set_preference_domain(domain: SecPreferencesDomain) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainSetPreferenceDomain(domain: SecPreferencesDomain) -> OSStatus;
        }
        unsafe { SecKeychainSetPreferenceDomain(domain) }
    }

    /// Gets the current keychain preference domain.
    ///
    /// Parameters:
    /// - domain: On return, a pointer to the keychain preference domain. See [`SecPreferencesDomain`](https://developer.apple.com/documentation/security/secpreferencesdomain) for possible domain values.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// A preference domain is a set of security-related preferences, such as the default keychain and the current keychain search list. The default preference domain for system daemons (that is, for daemons running in the root session) is the system domain. The default preference domain for all other programs is the user domain. Use the [`SecKeychainSetPreferenceDomain`](https://developer.apple.com/documentation/security/seckeychainsetpreferencedomain(_:)) function to change the preference domain.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `domain` must be a valid pointer.
    #[doc(alias = "SecKeychainGetPreferenceDomain")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn preference_domain(domain: NonNull<SecPreferencesDomain>) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainGetPreferenceDomain(domain: NonNull<SecPreferencesDomain>) -> OSStatus;
        }
        unsafe { SecKeychainGetPreferenceDomain(domain) }
    }

    /// Retrieves status information of a keychain.
    ///
    /// Parameters:
    /// - keychain: A keychain object of the keychain whose status you wish to determine for the user session. Pass `NULL` to obtain the status of the default keychain.
    ///
    /// - keychainStatus: On return, a pointer to the status of the specified keychain. See [`SecKeychainStatus`](https://developer.apple.com/documentation/security/seckeychainstatus) for valid status constants.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). The result code [`errSecNoSuchKeychain`](https://developer.apple.com/documentation/security/errsecnosuchkeychain) indicates that the specified keychain could not be found. The result code [`errSecInvalidKeychain`](https://developer.apple.com/documentation/security/errsecinvalidkeychain) indicates that the specified keychain is invalid.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// This function retrieves the status of a specified keychain. You can use this function to determine if the keychain is unlocked, readable, or writable. Note that the lock status of a keychain can change at any time due to user or system activity. Because the system automatically prompts the user to unlock a keychain when necessary, you do not usually have to worry about the lock status of a keychain. If you do need to track the lock status of a keychain, use the [`SecKeychainAddCallback`](https://developer.apple.com/documentation/security/seckeychainaddcallback(_:_:_:)) function to register for keychain notifications.
    ///
    ///
    /// Retrieves status information for the specified keychain.
    ///
    /// Parameter `keychain`: A keychain reference. Pass NULL to specify the default keychain.
    ///
    /// Parameter `keychainStatus`: On return, a pointer to the status of the specified keychain.  See KeychainStatus for valid status constants.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// # Safety
    ///
    /// `keychain_status` must be a valid pointer.
    #[doc(alias = "SecKeychainGetStatus")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn status(
        keychain: Option<&SecKeychain>,
        keychain_status: NonNull<SecKeychainStatus>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainGetStatus(
                keychain: Option<&SecKeychain>,
                keychain_status: NonNull<SecKeychainStatus>,
            ) -> OSStatus;
        }
        unsafe { SecKeychainGetStatus(keychain, keychain_status) }
    }

    /// Determines the path of a keychain.
    ///
    /// Parameters:
    /// - keychain: A reference to a keychain whose path you wish to obtain.
    ///
    /// - ioPathLength: On entry, a pointer to a variable containing the length (in bytes) of the buffer specified by `pathName`.
    ///
    /// On return, the string length of `pathName`, not including the null termination.
    ///
    /// - pathName: On entry, a pointer to a buffer that you have allocated. On return, the buffer contains POSIX path of the keychain as a null-terminated UTF-8 encoded string. The function returns [`errSecBufferTooSmall`](https://developer.apple.com/documentation/security/errsecbuffertoosmall) if the provided buffer is too small to hold the string with the null terminator byte.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    /// Get the path of the specified keychain.
    ///
    /// Parameter `keychain`: A reference to a keychain.
    ///
    /// Parameter `ioPathLength`: On input, a pointer to the size of the buffer pointed to by pathName. On return, the size of the buffer without the zero termination.
    ///
    /// Parameter `pathName`: On return, the POSIX path to the keychain.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// # Safety
    ///
    /// - `io_path_length` must be a valid pointer.
    /// - `path_name` must be a valid pointer.
    #[doc(alias = "SecKeychainGetPath")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn path(
        keychain: Option<&SecKeychain>,
        io_path_length: NonNull<u32>,
        path_name: NonNull<c_char>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainGetPath(
                keychain: Option<&SecKeychain>,
                io_path_length: NonNull<u32>,
                path_name: NonNull<c_char>,
            ) -> OSStatus;
        }
        unsafe { SecKeychainGetPath(keychain, io_path_length, path_name) }
    }

    /// Obtains tags for all possible attributes of a given item class.
    ///
    /// Parameters:
    /// - keychain: A keychain object.
    ///
    /// - itemID: The relation identifier of the item tags. An `itemID` is a `CSSM_DB_RECORDTYPE` type as defined in `cssmtype.h`.
    ///
    /// - info: On return, a pointer to the keychain attribute information. Your application should call the [`SecKeychainFreeAttributeInfo`](https://developer.apple.com/documentation/security/seckeychainfreeattributeinfo(_:)) function to release this structure when done with it.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// This call returns more attributes than are supported by the old style Keychain API and passing them into older calls yields an invalid attribute error. The recommended call to retrieve the attribute values is the [`SecKeychainItemCopyAttributesAndData`](https://developer.apple.com/documentation/security/seckeychainitemcopyattributesanddata(_:_:_:_:_:_:)) function.
    ///
    /// <div class="warning">
    ///
    /// ### Note
    ///  This is a CSSM-based API. CSSM is deprecated.
    ///
    /// For new development, where possible, you should generally use [`SecItemCopyMatching`](https://developer.apple.com/documentation/security/secitemcopymatching(_:_:)) to obtain the attributes of keychain items instead, because that function is based on Core Foundation types.
    ///
    ///
    ///
    /// </div>
    ///
    /// Obtains tags for all possible attributes for a given item class.
    ///
    /// Parameter `keychain`: A keychain reference.
    ///
    /// Parameter `itemID`: The relation identifier of the item tags (an itemID is a CSSM_DB_RECORDTYPE defined in cssmapple.h).
    ///
    /// Parameter `info`: On return, a pointer to the keychain attribute information. User should call the SecKeychainFreeAttributeInfo function to release the structure when done with it.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h). In addition, errSecParam (-50) may be returned if not enough valid parameters were supplied (NULL).
    ///
    /// Warning, this call returns more attributes than are support by the old style Keychain API and passing them into older calls will yield an invalid attribute error. The recommended call to retrieve the attribute values is the SecKeychainItemCopyAttributesAndData function.
    ///
    /// # Safety
    ///
    /// `info` must be a valid pointer.
    #[doc(alias = "SecKeychainAttributeInfoForItemID")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn attribute_info_for_item_id(
        keychain: Option<&SecKeychain>,
        item_id: u32,
        info: NonNull<*mut SecKeychainAttributeInfo>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainAttributeInfoForItemID(
                keychain: Option<&SecKeychain>,
                item_id: u32,
                info: NonNull<*mut SecKeychainAttributeInfo>,
            ) -> OSStatus;
        }
        unsafe { SecKeychainAttributeInfoForItemID(keychain, item_id, info) }
    }

    /// Releases the memory acquired by calling the `SecKeychainAttributeInfoForItemID` function.
    ///
    /// Parameters:
    /// - info: A pointer to the keychain attribute information to release.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    /// Releases the memory acquired by calling the SecKeychainAttributeInfoForItemID function.
    ///
    /// Parameter `info`: A pointer to the keychain attribute information to release.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h). In addition, errSecParam (-50) may be returned if not enough valid parameters were supplied (NULL).
    ///
    /// # Safety
    ///
    /// `info` must be a valid pointer.
    #[doc(alias = "SecKeychainFreeAttributeInfo")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn free_attribute_info(info: NonNull<SecKeychainAttributeInfo>) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainFreeAttributeInfo(info: NonNull<SecKeychainAttributeInfo>) -> OSStatus;
        }
        unsafe { SecKeychainFreeAttributeInfo(info) }
    }
}

/// A customized callback function that keychain services call when a keychain event has occurred.
///
/// Parameters:
/// - keychainEvent: The keychain event that occurred. The type of event that can trigger your callback depends on the bit mask you passed in the `eventMask` parameter of the function [`SecKeychainAddCallback`](https://developer.apple.com/documentation/security/seckeychainaddcallback(_:_:_:)). See [`SecKeychainEvent`](https://developer.apple.com/documentation/security/seckeychainevent) for a list of possible values.
///
/// - info: A pointer to a structure of type [`SecKeychainCallbackInfo`](https://developer.apple.com/documentation/security/seckeychaincallbackinfo). This structure provides your callback with information about the keychain event.
///
/// - context: A pointer to application-defined storage that your application previously passed to the function [`SecKeychainAddCallback`](https://developer.apple.com/documentation/security/seckeychainaddcallback(_:_:_:)). You can use this value to provide information that the callback function needs in order to properly handle the event, such as an object on which the callback function should call a method.
///
///
/// ## Return Value
///
/// A result code. See `Codes`.
///
///
///
/// ## Discussion
///
/// You would declare your keychain callback function like this if you were to name it `MyKeychainCallback`:
///
/// Listing 1. Declaring a keychain callback function
///
/// ```objc
/// OSStatus MyKeychainCallback (
///     SecKeychainEvent keychainEvent,
///     SecKeychainCallbackInfo *info,
///     void *context
/// );
/// ```
///
/// To add your callback function, use the [`SecKeychainAddCallback`](https://developer.apple.com/documentation/security/seckeychainaddcallback(_:_:_:)) function. To remove your callback function, use the [`SecKeychainRemoveCallback`](https://developer.apple.com/documentation/security/seckeychainremovecallback(_:)) function.
///
///
/// Defines a pointer to a customized callback function.  You supply the customized callback function to do a callback tailored to your application's needs.
///
/// Parameter `keychainEvent`: The keychain event that your application wishes to be notified of. See SecKeychainEvent for a description of possible values. The type of event that can trigger your callback depends on the bit mask you passed in the eventMask parameter of the function SecKeychainAddCallback. For more information, see the discussion.
///
/// Parameter `info`: A pointer to a structure of type SecKeychainCallbackInfo. On return, the structure contains information about the keychain event that occurred. The Keychain Manager passes this information to your callback function via the info parameter.
///
/// Parameter `context`: A pointer to application-defined storage that your application previously passed to the function SecKeychainAddCallback. You can use this value to perform operations like track which instance of a function is operating.
///
/// Returns: A result code.  See "Security Error Codes" (SecBase.h).
///
/// If you name your function MyKeychainEventCallback, you would declare it like this:
/// OSStatus MyKeychainEventCallback (
/// SecKeychainEvent keychainEvent,
/// SecKeychainCallbackInfo *info,
/// void *context);
///
/// To add your callback function, use the SecKeychainAddCallback function.  To remove your callback function, use the SecKeychainRemoveCallback function.
#[deprecated = "SecKeychain is deprecated"]
#[cfg(all(feature = "SecBase", feature = "libc"))]
pub type SecKeychainCallback = Option<
    unsafe extern "C-unwind" fn(
        SecKeychainEvent,
        NonNull<SecKeychainCallbackInfo>,
        *mut c_void,
    ) -> OSStatus,
>;

#[cfg(feature = "SecBase")]
impl SecKeychain {
    /// Registers your keychain event callback function.
    ///
    /// Parameters:
    /// - callbackFunction: A pointer to your keychain event callback function, described in [`SecKeychainCallback`](https://developer.apple.com/documentation/security/seckeychaincallback).
    ///
    /// - eventMask: A bit mask indicating the keychain events of which your application wishes to be notified. See [`SecKeychainEventMask`](https://developer.apple.com/documentation/security/seckeychaineventmask) for valid values. Keychain Services tests this mask to determine the keychain events that you wish to receive, and passes these events in the `keychainEvent` parameter of your callback function.
    ///
    /// - userContext: A pointer to application-defined storage that will be passed to your callback function. Your application can use this to associate any particular call of this function with any particular call of your keychain event callback function.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// It is important to note that the current Foundation or Core Foundation run loop must be active when making this call or the callbacks are not registered. In multithreaded programs, the notifications are registered in the run loop of the thread calling [`SecKeychainAddCallback`](https://developer.apple.com/documentation/security/seckeychainaddcallback(_:_:_:)); therefore, delivery of notifications depends on the functioning of that thread’s run loop. If that thread terminates, or is so busy that it doesn’t operate its run loop in a timely manner, notifications will be delayed, and may eventually be dropped without any notification.
    ///
    /// For that reason, it is inadvisable for your program to depend on delivery of notifications caused by your own actions (such as depending on receiving a deletion notification before updating a UI view) unless your program is multithreaded and can take notifications on a thread different from the one generating the events.
    ///
    ///
    /// Registers your keychain event callback function
    ///
    /// Parameter `callbackFunction`: A pointer to your keychain event callback function, described in SecKeychainCallback. You indicate the type of keychain events you want to receive by passing a bit mask of the desired events in the eventMask parameter.
    ///
    /// Parameter `eventMask`: A bit mask indicating the keychain events that your application wishes to be notified of. See SecKeychainEventMask for a description of this bit mask. The Keychain Manager tests this mask to determine the keychain events that you wish to receive, and passes these events in the keychainEvent parameter of your callback function. See SecKeychainEvent for a description of these events.
    ///
    /// Parameter `userContext`: A pointer to application-defined storage that will be passed to your callback function. Your application can use this to associate any particular call of SecKeychainAddCallback with any particular call of your keychain event callback function.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// # Safety
    ///
    /// - `callback_function` must be implemented correctly.
    /// - `user_context` must be a valid pointer or null.
    #[doc(alias = "SecKeychainAddCallback")]
    #[cfg(all(feature = "SecBase", feature = "libc"))]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn add_callback(
        callback_function: SecKeychainCallback,
        event_mask: SecKeychainEventMask,
        user_context: *mut c_void,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainAddCallback(
                callback_function: SecKeychainCallback,
                event_mask: SecKeychainEventMask,
                user_context: *mut c_void,
            ) -> OSStatus;
        }
        unsafe { SecKeychainAddCallback(callback_function, event_mask, user_context) }
    }

    /// Unregisters your keychain event callback function.
    ///
    /// Parameters:
    /// - callbackFunction: The callback function pointer to remove.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Once removed, keychain events are not sent to the owner of the callback.
    ///
    ///
    /// Unregisters your keychain event callback function. Once removed, keychain events won't be sent to the owner of the callback.
    ///
    /// Parameter `callbackFunction`: The callback function pointer to remove
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// # Safety
    ///
    /// `callback_function` must be implemented correctly.
    #[doc(alias = "SecKeychainRemoveCallback")]
    #[cfg(all(feature = "SecBase", feature = "libc"))]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn remove_callback(callback_function: SecKeychainCallback) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainRemoveCallback(callback_function: SecKeychainCallback) -> OSStatus;
        }
        unsafe { SecKeychainRemoveCallback(callback_function) }
    }

    /// Adds a new Internet password to a keychain.
    ///
    /// Parameters:
    /// - keychain: A reference to the keychain in which to store an Internet password. Pass `NULL` to specify the user’s default keychain.
    ///
    /// - serverNameLength: The length of the `serverName` character string.
    ///
    /// - serverName: A UTF-8 encoded character string representing the server name.
    ///
    /// - securityDomainLength: The length of the `securityDomain` character string.
    ///
    /// - securityDomain: A UTF-8 encoded character string representing the security domain. This parameter is optional. Pass NULL if the protocol does not require it.
    ///
    /// - accountNameLength: The length of the `accountName` character string.
    ///
    /// - accountName: A UTF-8 encoded character string representing the account name.
    ///
    /// - pathLength: The length of the `path` character string.
    ///
    /// - path: A UTF-8 encoded character string representing the path.
    ///
    /// - port: The TCP/IP port number. If no specific port number is associated with this password, pass `0`.
    ///
    /// - protocol: The protocol associated with this password. See [`SecProtocolType`](https://developer.apple.com/documentation/security/secprotocoltype) for a description of possible values.
    ///
    /// - authenticationType: The authentication scheme used. See [`SecAuthenticationType`](https://developer.apple.com/documentation/security/secauthenticationtype) for a description of possible values. Pass the constant `kSecAuthenticationTypeDefault`, to specify the default authentication scheme.
    ///
    /// - passwordLength: The length of the `passwordData` buffer.
    ///
    /// - passwordData: A pointer to a buffer containing the password data to be stored in the keychain.
    ///
    /// - itemRef: On return, a pointer to a reference to the new keychain item. Pass `NULL` if you don’t want to obtain this object. You must allocate the memory for this pointer. You must call the `CFRelease` function to release this object when you are finished using it.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). The result code [`errSecNoDefaultKeychain`](https://developer.apple.com/documentation/security/errsecnodefaultkeychain) indicates that no default keychain could be found. The result code [`errSecDuplicateItem`](https://developer.apple.com/documentation/security/errsecduplicateitem) indicates that you tried to add a password that already exists in the keychain. The result code [`errSecDataTooLarge`](https://developer.apple.com/documentation/security/errsecdatatoolarge) indicates that you tried to add more data than is allowed for a structure of this type.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// This function adds a new Internet server password to the specified keychain. Required parameters to identify the password are `serverName` and `accountName` (you cannot pass `NULL` for both parameters). In addition, some protocols may require an optional `securityDomain` when authentication is requested. This function optionally returns a reference to the newly added item.
    ///
    /// This function sets the initial access rights for the new keychain item so that the application creating the item is given trusted access.
    ///
    /// This function automatically calls the function [`SecKeychainUnlock`](https://developer.apple.com/documentation/security/seckeychainunlock(_:_:_:_:)) to display the Unlock Keychain dialog box if the keychain is currently locked.
    ///
    ///
    /// Adds an Internet password to the specified keychain.
    ///
    /// Parameter `keychain`: A reference to a keychain in which to store an Internet password. Pass NULL to specify the user's default keychain.
    ///
    /// Parameter `serverNameLength`: The length of the buffer pointed to by serverName.
    ///
    /// Parameter `serverName`: A pointer to a string containing the server name associated with this password.
    ///
    /// Parameter `securityDomainLength`: The length of the buffer pointed to by securityDomain.
    ///
    /// Parameter `securityDomain`: A pointer to a string containing the security domain associated with this password, or NULL if there is no relevant security domain.
    ///
    /// Parameter `accountNameLength`: The length of the buffer pointed to by accountName.
    ///
    /// Parameter `accountName`: A pointer to a string containing the account name associated with this password.
    ///
    /// Parameter `pathLength`: The length of the buffer pointed to by path.
    ///
    /// Parameter `path`: A pointer to a string containing the path associated with this password, or NULL if there is no relevant path string.
    ///
    /// Parameter `port`: The TCP/IP port number. If no specific port number is associated with this item, pass 0.
    ///
    /// Parameter `protocol`: The protocol associated with this password. See SecProtocolType for a description of possible values.
    ///
    /// Parameter `authenticationType`: The authentication scheme used. See SecAuthenticationType for a description of possible values. Pass the constant kSecAuthenticationTypeDefault to specify the default authentication scheme.
    ///
    /// Parameter `passwordLength`: The length of the buffer pointed to by passwordData.
    ///
    /// Parameter `passwordData`: A pointer to a buffer containing the password data to be stored in the keychain.
    ///
    /// Parameter `itemRef`: On return, a reference to the new keychain item.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// The SecKeychainAddInternetPassword function adds a new Internet server password to the specified keychain. Required parameters to identify the password are serverName and accountName (you cannot pass NULL for both parameters). In addition, some protocols may require an optional securityDomain when authentication is requested. SecKeychainAddInternetPassword optionally returns a reference to the newly added item.
    ///
    /// # Safety
    ///
    /// - `server_name` must be a valid pointer or null.
    /// - `security_domain` must be a valid pointer or null.
    /// - `account_name` must be a valid pointer or null.
    /// - `path` must be a valid pointer or null.
    /// - `password_data` must be a valid pointer.
    /// - `item_ref` must be a valid pointer or null.
    #[doc(alias = "SecKeychainAddInternetPassword")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn add_internet_password(
        keychain: Option<&SecKeychain>,
        server_name_length: u32,
        server_name: *const c_char,
        security_domain_length: u32,
        security_domain: *const c_char,
        account_name_length: u32,
        account_name: *const c_char,
        path_length: u32,
        path: *const c_char,
        port: u16,
        protocol: SecProtocolType,
        authentication_type: SecAuthenticationType,
        password_length: u32,
        password_data: NonNull<c_void>,
        item_ref: *mut *mut SecKeychainItem,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainAddInternetPassword(
                keychain: Option<&SecKeychain>,
                server_name_length: u32,
                server_name: *const c_char,
                security_domain_length: u32,
                security_domain: *const c_char,
                account_name_length: u32,
                account_name: *const c_char,
                path_length: u32,
                path: *const c_char,
                port: u16,
                protocol: SecProtocolType,
                authentication_type: SecAuthenticationType,
                password_length: u32,
                password_data: NonNull<c_void>,
                item_ref: *mut *mut SecKeychainItem,
            ) -> OSStatus;
        }
        unsafe {
            SecKeychainAddInternetPassword(
                keychain,
                server_name_length,
                server_name,
                security_domain_length,
                security_domain,
                account_name_length,
                account_name,
                path_length,
                path,
                port,
                protocol,
                authentication_type,
                password_length,
                password_data,
                item_ref,
            )
        }
    }

    /// Finds the first Internet password based on the attributes passed.
    ///
    /// Parameters:
    /// - keychainOrArray: A reference to an array of keychains to search, a single keychain or `NULL` to search the user’s default keychain search list.
    ///
    /// - serverNameLength: The length of the `serverName` character string.
    ///
    /// - serverName: A UTF-8 encoded character string representing the server name.
    ///
    /// - securityDomainLength: The length of the `securityDomain` character string.
    ///
    /// - securityDomain: A UTF-8 encoded character string representing the security domain. This parameter is optional, as not all protocols require it. Pass `NULL` if it is not required.
    ///
    /// - accountNameLength: The length of the `accountName` character string.
    ///
    /// - accountName: A UTF-8 encoded character string representing the account name.
    ///
    /// - pathLength: The length of the `path` character string.
    ///
    /// - path: A UTF-8 encoded character string representing the path.
    ///
    /// - port: The TCP/IP port number. Pass `0` to ignore the port number.
    ///
    /// - protocol: The protocol associated with this password. See [`SecProtocolType`](https://developer.apple.com/documentation/security/secprotocoltype) for a description of possible values.
    ///
    /// - authenticationType: The authentication scheme used. See [`SecAuthenticationType`](https://developer.apple.com/documentation/security/secauthenticationtype) for a description of possible values. Pass the constant `kSecAuthenticationTypeDefault`, to specify the default authentication scheme.
    ///
    /// - passwordLength: On return, the length of the buffer pointed to by `passwordData`.
    ///
    /// - passwordData: On return, a pointer to a buffer containing the password data. Pass `NULL` if you want to obtain the item object but not the password data. In this case, you must also pass `NULL` in the `passwordLength` parameter. You should use the [`SecKeychainItemFreeContent`](https://developer.apple.com/documentation/security/seckeychainitemfreecontent(_:_:)) function to free the memory pointed to by this parameter.
    ///
    /// - itemRef: On return, a pointer to the item object of the Internet password. You are responsible for releasing your reference to this object. Pass `NULL` if you don’t want to obtain this object.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// This function finds the first Internet password item that matches the attributes you provide. This function optionally returns a reference to the found item.
    ///
    /// This function decrypts the password before returning it to you. If the calling application is not in the list of trusted applications, the user is prompted before access is allowed. If the access controls for this item do not allow decryption, the function returns the `errSecAuthFailed` result code.
    ///
    /// This function automatically calls the function [`SecKeychainUnlock`](https://developer.apple.com/documentation/security/seckeychainunlock(_:_:_:_:)) to display the Unlock Keychain dialog box if the keychain is currently locked.
    ///
    ///
    /// Finds an Internet password based on the attributes passed.
    ///
    /// Parameter `keychainOrArray`: A reference to an array of keychains to search, a single keychain, or NULL to search the user's default keychain search list.
    ///
    /// Parameter `serverNameLength`: The length of the buffer pointed to by serverName.
    ///
    /// Parameter `serverName`: A pointer to a string containing the server name.
    ///
    /// Parameter `securityDomainLength`: The length of the buffer pointed to by securityDomain.
    ///
    /// Parameter `securityDomain`: A pointer to a string containing the security domain. This parameter is optional, as not all protocols will require it.
    ///
    /// Parameter `accountNameLength`: The length of the buffer pointed to by accountName.
    ///
    /// Parameter `accountName`: A pointer to a string containing the account name.
    ///
    /// Parameter `pathLength`: The length of the buffer pointed to by path.
    ///
    /// Parameter `path`: A pointer to a string containing the path.
    ///
    /// Parameter `port`: The TCP/IP port number. Pass 0 to ignore the port number.
    ///
    /// Parameter `protocol`: The protocol associated with this password. See SecProtocolType for a description of possible values.
    ///
    /// Parameter `authenticationType`: The authentication scheme used. See SecAuthenticationType for a description of possible values. Pass the constant kSecAuthenticationTypeDefault to specify the default authentication scheme.
    ///
    /// Parameter `passwordLength`: On return, the length of the buffer pointed to by passwordData.
    ///
    /// Parameter `passwordData`: On return, a pointer to a data buffer containing the password. Your application must call SecKeychainItemFreeContent(NULL, passwordData) to release this data buffer when it is no longer needed. Pass NULL if you are not interested in retrieving the password data at this time, but simply want to find the item reference.
    ///
    /// Parameter `itemRef`: On return, a reference to the keychain item which was found.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// The SecKeychainFindInternetPassword function finds the first Internet password item which matches the attributes you provide. Most attributes are optional; you should pass only as many as you need to narrow the search sufficiently for your application's intended use. SecKeychainFindInternetPassword optionally returns a reference to the found item.
    ///
    /// # Safety
    ///
    /// - `keychain_or_array` should be of the correct type.
    /// - `server_name` must be a valid pointer or null.
    /// - `security_domain` must be a valid pointer or null.
    /// - `account_name` must be a valid pointer or null.
    /// - `path` must be a valid pointer or null.
    /// - `password_length` must be a valid pointer or null.
    /// - `password_data` must be a valid pointer or null.
    /// - `item_ref` must be a valid pointer or null.
    #[doc(alias = "SecKeychainFindInternetPassword")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn find_internet_password(
        keychain_or_array: Option<&CFType>,
        server_name_length: u32,
        server_name: *const c_char,
        security_domain_length: u32,
        security_domain: *const c_char,
        account_name_length: u32,
        account_name: *const c_char,
        path_length: u32,
        path: *const c_char,
        port: u16,
        protocol: SecProtocolType,
        authentication_type: SecAuthenticationType,
        password_length: *mut u32,
        password_data: *mut *mut c_void,
        item_ref: *mut *mut SecKeychainItem,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainFindInternetPassword(
                keychain_or_array: Option<&CFType>,
                server_name_length: u32,
                server_name: *const c_char,
                security_domain_length: u32,
                security_domain: *const c_char,
                account_name_length: u32,
                account_name: *const c_char,
                path_length: u32,
                path: *const c_char,
                port: u16,
                protocol: SecProtocolType,
                authentication_type: SecAuthenticationType,
                password_length: *mut u32,
                password_data: *mut *mut c_void,
                item_ref: *mut *mut SecKeychainItem,
            ) -> OSStatus;
        }
        unsafe {
            SecKeychainFindInternetPassword(
                keychain_or_array,
                server_name_length,
                server_name,
                security_domain_length,
                security_domain,
                account_name_length,
                account_name,
                path_length,
                path,
                port,
                protocol,
                authentication_type,
                password_length,
                password_data,
                item_ref,
            )
        }
    }

    /// Adds a new generic password to a keychain.
    ///
    /// Parameters:
    /// - keychain: A reference to the keychain in which to store a generic password. Pass `NULL` to specify the default keychain.
    ///
    /// - serviceNameLength: The length of the `serviceName` character string.
    ///
    /// - serviceName: A UTF-8 encoded character string representing the service name.
    ///
    /// - accountNameLength: The length of the `accountName` character string.
    ///
    /// - accountName: A UTF-8 encoded character string representing the account name.
    ///
    /// - passwordLength: The length of the `passwordData` buffer.
    ///
    /// - passwordData: A pointer to a buffer containing the password data to be stored in the keychain. Before calling this function, allocate enough memory for the buffer to hold the data you want to store.
    ///
    /// - itemRef: On return, a pointer to a reference to the new keychain item. Pass `NULL` if you don’t want to obtain this object. You must allocate the memory for this pointer. You must call the `CFRelease` function to release this object when you are finished using it.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). The result code [`errSecNoDefaultKeychain`](https://developer.apple.com/documentation/security/errsecnodefaultkeychain) indicates that no default keychain could be found. The result code [`errSecDuplicateItem`](https://developer.apple.com/documentation/security/errsecduplicateitem) indicates that you tried to add a password that already exists in the keychain. The result code [`errSecDataTooLarge`](https://developer.apple.com/documentation/security/errsecdatatoolarge) indicates that you tried to add more data than is allowed for a structure of this type.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// This function adds a new generic password to the specified keychain. Required parameters to identify the password are `serviceName` and `accountName`, which are application-defined strings. This function optionally returns a reference to the newly added item.
    ///
    /// You can use this function to add passwords for accounts other than the Internet. For example, you might add AppleShare passwords, or passwords for your database or scheduling programs.
    ///
    /// This function sets the initial access rights for the new keychain item so that the application creating the item is given trusted access.
    ///
    /// This function automatically calls the function [`SecKeychainUnlock`](https://developer.apple.com/documentation/security/seckeychainunlock(_:_:_:_:)) to display the Unlock Keychain dialog box if the keychain is currently locked.
    ///
    ///
    /// Adds a generic password to the specified keychain.
    ///
    /// Parameter `keychain`: A reference to the keychain in which to store a generic password. Pass NULL to specify the user's default keychain.
    ///
    /// Parameter `serviceNameLength`: The length of the buffer pointed to by serviceName.
    ///
    /// Parameter `serviceName`: A pointer to a string containing the service name associated with this password.
    ///
    /// Parameter `accountNameLength`: The length of the buffer pointed to by accountName.
    ///
    /// Parameter `accountName`: A pointer to a string containing the account name associated with this password.
    ///
    /// Parameter `passwordLength`: The length of the buffer pointed to by passwordData.
    ///
    /// Parameter `passwordData`: A pointer to a buffer containing the password data to be stored in the keychain.
    ///
    /// Parameter `itemRef`: On return, a reference to the new keychain item.
    ///
    /// Returns: A result code. See "Security Error Codes" (SecBase.h).
    ///
    /// The SecKeychainAddGenericPassword function adds a new generic password to the default keychain. Required parameters to identify the password are serviceName and accountName, which are application-defined strings. SecKeychainAddGenericPassword optionally returns a reference to the newly added item.
    ///
    /// # Safety
    ///
    /// - `service_name` must be a valid pointer or null.
    /// - `account_name` must be a valid pointer or null.
    /// - `password_data` must be a valid pointer.
    /// - `item_ref` must be a valid pointer or null.
    #[doc(alias = "SecKeychainAddGenericPassword")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn add_generic_password(
        keychain: Option<&SecKeychain>,
        service_name_length: u32,
        service_name: *const c_char,
        account_name_length: u32,
        account_name: *const c_char,
        password_length: u32,
        password_data: NonNull<c_void>,
        item_ref: *mut *mut SecKeychainItem,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainAddGenericPassword(
                keychain: Option<&SecKeychain>,
                service_name_length: u32,
                service_name: *const c_char,
                account_name_length: u32,
                account_name: *const c_char,
                password_length: u32,
                password_data: NonNull<c_void>,
                item_ref: *mut *mut SecKeychainItem,
            ) -> OSStatus;
        }
        unsafe {
            SecKeychainAddGenericPassword(
                keychain,
                service_name_length,
                service_name,
                account_name_length,
                account_name,
                password_length,
                password_data,
                item_ref,
            )
        }
    }

    /// Finds the first generic password based on the attributes passed.
    ///
    /// Parameters:
    /// - keychainOrArray: A reference to an array of keychains to search, a single keychain, or `NULL` to search the user’s default keychain search list.
    ///
    /// - serviceNameLength: The length of the `serviceName` character string.
    ///
    /// - serviceName: A UTF-8 encoded character string representing the service name.
    ///
    /// - accountNameLength: The length of the `accountName` character string.
    ///
    /// - accountName: A UTF-8 encoded character string representing the account name.
    ///
    /// - passwordLength: On return, the length of the buffer pointed to by `passwordData`.
    ///
    /// - passwordData: On return, a pointer to a buffer that holds the password data. Pass `NULL` if you want to obtain the item object but not the password data. In this case, you must also pass `NULL` in the `passwordLength` parameter. You should use the [`SecKeychainItemFreeContent`](https://developer.apple.com/documentation/security/seckeychainitemfreecontent(_:_:)) function to free the memory pointed to by this parameter.
    ///
    /// - itemRef: On return, a pointer to the item object of the generic password. You are responsible for releasing your reference to this object. Pass `NULL` if you don’t want to obtain this object.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// This function finds the first generic password item that matches the attributes you provide. Most attributes are optional; you should pass only as many as you need to narrow the search sufficiently for your application’s intended use. This function optionally returns a reference to the found item.
    ///
    /// This function decrypts the password before returning it to you. If the calling application is not in the list of trusted applications, the user is prompted before access is allowed. If the access controls for this item do not allow decryption, the function returns the `errSecAuthFailed` result code.
    ///
    /// This function automatically calls the function [`SecKeychainUnlock`](https://developer.apple.com/documentation/security/seckeychainunlock(_:_:_:_:)) to display the Unlock Keychain dialog box if the keychain is currently locked.
    ///
    ///
    /// Find a generic password based on the attributes passed.
    ///
    /// Parameter `keychainOrArray`: A reference to an array of keychains to search, a single keychain, or NULL to search the user's default keychain search list.
    ///
    /// Parameter `serviceNameLength`: The length of the buffer pointed to by serviceName.
    ///
    /// Parameter `serviceName`: A pointer to a string containing the service name.
    ///
    /// Parameter `accountNameLength`: The length of the buffer pointed to by accountName.
    ///
    /// Parameter `accountName`: A pointer to a string containing the account name.
    ///
    /// Parameter `passwordLength`: On return, the length of the buffer pointed to by passwordData.
    ///
    /// Parameter `passwordData`: On return, a pointer to a data buffer containing the password. Your application must call SecKeychainItemFreeContent(NULL, passwordData) to release this data buffer when it is no longer needed. Pass NULL if you are not interested in retrieving the password data at this time, but simply want to find the item reference.
    ///
    /// Parameter `itemRef`: On return, a reference to the keychain item which was found.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// The SecKeychainFindGenericPassword function finds the first generic password item which matches the attributes you provide. Most attributes are optional; you should pass only as many as you need to narrow the search sufficiently for your application's intended use. SecKeychainFindGenericPassword optionally returns a reference to the found item.
    ///
    /// # Safety
    ///
    /// - `keychain_or_array` should be of the correct type.
    /// - `service_name` must be a valid pointer or null.
    /// - `account_name` must be a valid pointer or null.
    /// - `password_length` must be a valid pointer or null.
    /// - `password_data` must be a valid pointer or null.
    /// - `item_ref` must be a valid pointer or null.
    #[doc(alias = "SecKeychainFindGenericPassword")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn find_generic_password(
        keychain_or_array: Option<&CFType>,
        service_name_length: u32,
        service_name: *const c_char,
        account_name_length: u32,
        account_name: *const c_char,
        password_length: *mut u32,
        password_data: *mut *mut c_void,
        item_ref: *mut *mut SecKeychainItem,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainFindGenericPassword(
                keychain_or_array: Option<&CFType>,
                service_name_length: u32,
                service_name: *const c_char,
                account_name_length: u32,
                account_name: *const c_char,
                password_length: *mut u32,
                password_data: *mut *mut c_void,
                item_ref: *mut *mut SecKeychainItem,
            ) -> OSStatus;
        }
        unsafe {
            SecKeychainFindGenericPassword(
                keychain_or_array,
                service_name_length,
                service_name,
                account_name_length,
                account_name,
                password_length,
                password_data,
                item_ref,
            )
        }
    }

    /// Enables or disables the user interface for keychain services functions that automatically display a user interface.
    ///
    /// Parameters:
    /// - state: A flag that indicates whether the keychain services will display a user interface. If you pass [`true`](https://developer.apple.com/documentation/swift/true), user interaction is allowed. This is the default value. If [`false`](https://developer.apple.com/documentation/swift/false), keychain services functions that normally display a user interface will instead return an error.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Certain keychain services functions that require the presence of a keychain automatically display a _Keychain Not Found_ dialog if there is none. Functions that require the keychain to be unlocked automatically display the _Unlock Keychain_ dialog. The [`SecKeychainSetUserInteractionAllowed`](https://developer.apple.com/documentation/security/seckeychainsetuserinteractionallowed(_:)) function enables you to control whether these functions display a user interface. By default, user interaction is permitted.
    ///
    /// If you are writing an application that must run unattended on a server, you may wish to disable the user interface so that any subsequent keychain calls that normally bring up the unlock UI will instead return immediately with an [`errSecInteractionRequired`](https://developer.apple.com/documentation/security/errsecinteractionrequired) result). In this case you must programmatically create a keychain or unlock the keychain when necessary.
    ///
    /// ### Special Considerations
    ///
    /// If you disable user interaction before calling a Keychain Services function, be sure to reenable it when you are finished. Failure to reenable user interaction will affect other clients of the Keychain Services.
    ///
    ///
    /// Turns on or off any optional user interaction
    ///
    /// Parameter `state`: A boolean representing the state of user interaction.  You should pass TRUE to allow user interaction, and FALSE to disallow user interaction
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    #[doc(alias = "SecKeychainSetUserInteractionAllowed")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn set_user_interaction_allowed(state: bool) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainSetUserInteractionAllowed(state: Boolean) -> OSStatus;
        }
        unsafe { SecKeychainSetUserInteractionAllowed(state as _) }
    }

    /// Indicates whether keychain services functions that normally display a user interaction are allowed to do so.
    ///
    /// Parameters:
    /// - state: On return, a Boolean value indicating whether user interaction is permitted. If [`true`](https://developer.apple.com/documentation/swift/true), user interaction is allowed, and keychain services functions that display a user interface can do so as appropriate.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    /// Retrieves the current state of user interaction.
    ///
    /// Parameter `state`: On return, a pointer to the current state of user interaction.  If this is TRUE then user interaction is allowed, if it is FALSE, then user interaction is not allowed.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// # Safety
    ///
    /// `state` must be a valid pointer.
    #[doc(alias = "SecKeychainGetUserInteractionAllowed")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn user_interaction_allowed(state: NonNull<Boolean>) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainGetUserInteractionAllowed(state: NonNull<Boolean>) -> OSStatus;
        }
        unsafe { SecKeychainGetUserInteractionAllowed(state) }
    }

    /// Returns the CSSM CSP handle for the given keychain object.
    ///
    /// Parameters:
    /// - keychain: A keychain object.
    ///
    /// - cspHandle: On return, a pointer to the CSSM CSP handle for the given keychain. The handle is valid until the keychain object is released.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// <div class="warning">
    ///
    /// ### Important
    ///  This function is deprecated. The common security services manager module is no longer used.
    ///
    ///
    ///
    /// </div>
    ///
    /// Returns the CSSM_CSP_HANDLE attachment for the given keychain reference. The handle is valid until the keychain reference is released.
    ///
    /// Parameter `keychain`: A keychain reference.
    ///
    /// Parameter `cspHandle`: On return, a pointer to the CSSM_CSP_HANDLE for the given keychain.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// This API is deprecated for 10.7. It should nho longer be needed.
    ///
    /// # Safety
    ///
    /// `csp_handle` must be a valid pointer.
    #[doc(alias = "SecKeychainGetCSPHandle")]
    #[cfg(all(feature = "SecBase", feature = "cssmconfig", feature = "cssmtype"))]
    #[deprecated]
    #[inline]
    pub unsafe fn csp_handle(
        keychain: Option<&SecKeychain>,
        csp_handle: NonNull<CSSM_CSP_HANDLE>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainGetCSPHandle(
                keychain: Option<&SecKeychain>,
                csp_handle: NonNull<CSSM_CSP_HANDLE>,
            ) -> OSStatus;
        }
        unsafe { SecKeychainGetCSPHandle(keychain, csp_handle) }
    }

    /// Returns the CSSM database handle for a given keychain object.
    ///
    /// Parameters:
    /// - keychain: A keychain object.
    ///
    /// - dldbHandle: On return, a pointer to the CSSM database handle for the given keychain. The handle is valid until the keychain object is released.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// <div class="warning">
    ///
    /// ### Important
    ///  This function is deprecated. The common security services manager module is no longer used.
    ///
    ///
    ///
    /// </div>
    ///
    /// Returns the CSSM_DL_DB_HANDLE for a given keychain reference. The handle is valid until the keychain reference is released.
    ///
    /// Parameter `keychain`: A keychain reference.
    ///
    /// Parameter `dldbHandle`: On return, a pointer to the CSSM_DL_DB_HANDLE for the given keychain.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// This API is deprecated for 10.7. It should nho longer be needed.
    ///
    /// # Safety
    ///
    /// `dldb_handle` must be a valid pointer.
    #[doc(alias = "SecKeychainGetDLDBHandle")]
    #[cfg(all(feature = "SecBase", feature = "cssmconfig", feature = "cssmtype"))]
    #[deprecated]
    #[inline]
    pub unsafe fn dldb_handle(
        keychain: Option<&SecKeychain>,
        dldb_handle: NonNull<CSSM_DL_DB_HANDLE>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainGetDLDBHandle(
                keychain: Option<&SecKeychain>,
                dldb_handle: NonNull<CSSM_DL_DB_HANDLE>,
            ) -> OSStatus;
        }
        unsafe { SecKeychainGetDLDBHandle(keychain, dldb_handle) }
    }

    /// Retrieves the application access of a keychain.
    ///
    /// Parameters:
    /// - keychain: A reference to the keychain from which to copy the access object. Pass `NULL` to specify the default keychain.
    ///
    /// - access: A pointer to an access object. On return, this points to the access object of the specified keychain.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    /// Retrieves the access for a keychain.
    ///
    /// Parameter `keychain`: A reference to the keychain from which to copy the access.
    ///
    /// Parameter `access`: On return, a pointer to the access reference.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    ///
    /// # Safety
    ///
    /// `access` must be a valid pointer.
    #[doc(alias = "SecKeychainCopyAccess")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn copy_access(
        keychain: Option<&SecKeychain>,
        access: NonNull<*mut SecAccess>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainCopyAccess(
                keychain: Option<&SecKeychain>,
                access: NonNull<*mut SecAccess>,
            ) -> OSStatus;
        }
        unsafe { SecKeychainCopyAccess(keychain, access) }
    }

    /// Sets the application access for a keychain.
    ///
    /// Parameters:
    /// - keychain: A reference to the keychain for which to set the access. Pass `NULL` to specify the default keychain.
    ///
    /// - access: An access object of type [`SecAccessRef`](https://developer.apple.com/documentation/security/secaccess) containing access control lists for the keychain. See [Access Control Lists](https://developer.apple.com/documentation/security/access-control-lists) for more information about creating an access object.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    /// Sets the access for a keychain.
    ///
    /// Parameter `keychain`: A reference to the keychain for which to set the access.
    ///
    /// Parameter `access`: An access reference.
    ///
    /// Returns: A result code.  See "Security Error Codes" (SecBase.h).
    #[doc(alias = "SecKeychainSetAccess")]
    #[cfg(feature = "SecBase")]
    #[deprecated = "SecKeychain is deprecated"]
    #[inline]
    pub unsafe fn set_access(keychain: Option<&SecKeychain>, access: &SecAccess) -> OSStatus {
        extern "C-unwind" {
            fn SecKeychainSetAccess(keychain: Option<&SecKeychain>, access: &SecAccess)
                -> OSStatus;
        }
        unsafe { SecKeychainSetAccess(keychain, access) }
    }
}

extern "C-unwind" {
    #[deprecated = "renamed to `SecKeychain::version`"]
    pub fn SecKeychainGetVersion(return_vers: NonNull<u32>) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::open`"]
    pub fn SecKeychainOpen(
        path_name: NonNull<c_char>,
        keychain: NonNull<*mut SecKeychain>,
    ) -> OSStatus;
}

#[cfg(feature = "SecBase")]
#[deprecated = "renamed to `SecKeychain::create`"]
#[inline]
pub unsafe extern "C-unwind" fn SecKeychainCreate(
    path_name: NonNull<c_char>,
    password_length: u32,
    password: *const c_void,
    prompt_user: bool,
    initial_access: Option<&SecAccess>,
    keychain: NonNull<*mut SecKeychain>,
) -> OSStatus {
    extern "C-unwind" {
        fn SecKeychainCreate(
            path_name: NonNull<c_char>,
            password_length: u32,
            password: *const c_void,
            prompt_user: Boolean,
            initial_access: Option<&SecAccess>,
            keychain: NonNull<*mut SecKeychain>,
        ) -> OSStatus;
    }
    unsafe {
        SecKeychainCreate(
            path_name,
            password_length,
            password,
            prompt_user as _,
            initial_access,
            keychain,
        )
    }
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::delete`"]
    pub fn SecKeychainDelete(keychain_or_array: Option<&SecKeychain>) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::set_settings`"]
    pub fn SecKeychainSetSettings(
        keychain: Option<&SecKeychain>,
        new_settings: NonNull<SecKeychainSettings>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::copy_settings`"]
    pub fn SecKeychainCopySettings(
        keychain: Option<&SecKeychain>,
        out_settings: NonNull<SecKeychainSettings>,
    ) -> OSStatus;
}

#[cfg(feature = "SecBase")]
#[deprecated = "renamed to `SecKeychain::unlock`"]
#[inline]
pub unsafe extern "C-unwind" fn SecKeychainUnlock(
    keychain: Option<&SecKeychain>,
    password_length: u32,
    password: *const c_void,
    use_password: bool,
) -> OSStatus {
    extern "C-unwind" {
        fn SecKeychainUnlock(
            keychain: Option<&SecKeychain>,
            password_length: u32,
            password: *const c_void,
            use_password: Boolean,
        ) -> OSStatus;
    }
    unsafe { SecKeychainUnlock(keychain, password_length, password, use_password as _) }
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::lock`"]
    pub fn SecKeychainLock(keychain: Option<&SecKeychain>) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `SecKeychain::lock_all`"]
    pub fn SecKeychainLockAll() -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::copy_default`"]
    pub fn SecKeychainCopyDefault(keychain: NonNull<*mut SecKeychain>) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::set_default`"]
    pub fn SecKeychainSetDefault(keychain: Option<&SecKeychain>) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `SecKeychain::copy_search_list`"]
    pub fn SecKeychainCopySearchList(search_list: NonNull<*const CFArray>) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `SecKeychain::set_search_list`"]
    pub fn SecKeychainSetSearchList(search_list: &CFArray) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::copy_domain_default`"]
    pub fn SecKeychainCopyDomainDefault(
        domain: SecPreferencesDomain,
        keychain: NonNull<*mut SecKeychain>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::set_domain_default`"]
    pub fn SecKeychainSetDomainDefault(
        domain: SecPreferencesDomain,
        keychain: Option<&SecKeychain>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `SecKeychain::copy_domain_search_list`"]
    pub fn SecKeychainCopyDomainSearchList(
        domain: SecPreferencesDomain,
        search_list: NonNull<*const CFArray>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `SecKeychain::set_domain_search_list`"]
    pub fn SecKeychainSetDomainSearchList(
        domain: SecPreferencesDomain,
        search_list: &CFArray,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `SecKeychain::set_preference_domain`"]
    pub fn SecKeychainSetPreferenceDomain(domain: SecPreferencesDomain) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `SecKeychain::preference_domain`"]
    pub fn SecKeychainGetPreferenceDomain(domain: NonNull<SecPreferencesDomain>) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::status`"]
    pub fn SecKeychainGetStatus(
        keychain: Option<&SecKeychain>,
        keychain_status: NonNull<SecKeychainStatus>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::path`"]
    pub fn SecKeychainGetPath(
        keychain: Option<&SecKeychain>,
        io_path_length: NonNull<u32>,
        path_name: NonNull<c_char>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::attribute_info_for_item_id`"]
    pub fn SecKeychainAttributeInfoForItemID(
        keychain: Option<&SecKeychain>,
        item_id: u32,
        info: NonNull<*mut SecKeychainAttributeInfo>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::free_attribute_info`"]
    pub fn SecKeychainFreeAttributeInfo(info: NonNull<SecKeychainAttributeInfo>) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(all(feature = "SecBase", feature = "libc"))]
    #[deprecated = "renamed to `SecKeychain::add_callback`"]
    pub fn SecKeychainAddCallback(
        callback_function: SecKeychainCallback,
        event_mask: SecKeychainEventMask,
        user_context: *mut c_void,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(all(feature = "SecBase", feature = "libc"))]
    #[deprecated = "renamed to `SecKeychain::remove_callback`"]
    pub fn SecKeychainRemoveCallback(callback_function: SecKeychainCallback) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::add_internet_password`"]
    pub fn SecKeychainAddInternetPassword(
        keychain: Option<&SecKeychain>,
        server_name_length: u32,
        server_name: *const c_char,
        security_domain_length: u32,
        security_domain: *const c_char,
        account_name_length: u32,
        account_name: *const c_char,
        path_length: u32,
        path: *const c_char,
        port: u16,
        protocol: SecProtocolType,
        authentication_type: SecAuthenticationType,
        password_length: u32,
        password_data: NonNull<c_void>,
        item_ref: *mut *mut SecKeychainItem,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::find_internet_password`"]
    pub fn SecKeychainFindInternetPassword(
        keychain_or_array: Option<&CFType>,
        server_name_length: u32,
        server_name: *const c_char,
        security_domain_length: u32,
        security_domain: *const c_char,
        account_name_length: u32,
        account_name: *const c_char,
        path_length: u32,
        path: *const c_char,
        port: u16,
        protocol: SecProtocolType,
        authentication_type: SecAuthenticationType,
        password_length: *mut u32,
        password_data: *mut *mut c_void,
        item_ref: *mut *mut SecKeychainItem,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::add_generic_password`"]
    pub fn SecKeychainAddGenericPassword(
        keychain: Option<&SecKeychain>,
        service_name_length: u32,
        service_name: *const c_char,
        account_name_length: u32,
        account_name: *const c_char,
        password_length: u32,
        password_data: NonNull<c_void>,
        item_ref: *mut *mut SecKeychainItem,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::find_generic_password`"]
    pub fn SecKeychainFindGenericPassword(
        keychain_or_array: Option<&CFType>,
        service_name_length: u32,
        service_name: *const c_char,
        account_name_length: u32,
        account_name: *const c_char,
        password_length: *mut u32,
        password_data: *mut *mut c_void,
        item_ref: *mut *mut SecKeychainItem,
    ) -> OSStatus;
}

#[deprecated = "renamed to `SecKeychain::set_user_interaction_allowed`"]
#[inline]
pub unsafe extern "C-unwind" fn SecKeychainSetUserInteractionAllowed(state: bool) -> OSStatus {
    extern "C-unwind" {
        fn SecKeychainSetUserInteractionAllowed(state: Boolean) -> OSStatus;
    }
    unsafe { SecKeychainSetUserInteractionAllowed(state as _) }
}

extern "C-unwind" {
    #[deprecated = "renamed to `SecKeychain::user_interaction_allowed`"]
    pub fn SecKeychainGetUserInteractionAllowed(state: NonNull<Boolean>) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(all(feature = "SecBase", feature = "cssmconfig", feature = "cssmtype"))]
    #[deprecated = "renamed to `SecKeychain::csp_handle`"]
    pub fn SecKeychainGetCSPHandle(
        keychain: Option<&SecKeychain>,
        csp_handle: NonNull<CSSM_CSP_HANDLE>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(all(feature = "SecBase", feature = "cssmconfig", feature = "cssmtype"))]
    #[deprecated = "renamed to `SecKeychain::dldb_handle`"]
    pub fn SecKeychainGetDLDBHandle(
        keychain: Option<&SecKeychain>,
        dldb_handle: NonNull<CSSM_DL_DB_HANDLE>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::copy_access`"]
    pub fn SecKeychainCopyAccess(
        keychain: Option<&SecKeychain>,
        access: NonNull<*mut SecAccess>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecKeychain::set_access`"]
    pub fn SecKeychainSetAccess(keychain: Option<&SecKeychain>, access: &SecAccess) -> OSStatus;
}
