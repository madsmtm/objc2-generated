//! This file has been automatically generated by `objc2`'s `header-translator`.
//! DO NOT EDIT
use core::ffi::*;
use core::ptr::NonNull;
#[cfg(feature = "objc2")]
use objc2::__framework_prelude::*;

use crate::*;

pub const CSSM_APPLE_TP_SSL_OPTS_VERSION: c_uint = 1;
pub const CSSM_APPLE_TP_CRL_OPTS_VERSION: c_uint = 0;
pub const CSSM_APPLE_TP_SMIME_OPTS_VERSION: c_uint = 0;
pub const CSSM_APPLE_TP_ACTION_VERSION: c_uint = 0;
pub const CSSM_TP_APPLE_EVIDENCE_VERSION: c_uint = 0;
pub const kKeychainSuffix: &CStr = unsafe { CStr::from_bytes_with_nul_unchecked(b".keychain\0") };
pub const kKeychainDbSuffix: &CStr =
    unsafe { CStr::from_bytes_with_nul_unchecked(b".keychain-db\0") };
pub const kSystemKeychainName: &CStr =
    unsafe { CStr::from_bytes_with_nul_unchecked(b"System.keychain\0") };
pub const kSystemKeychainDir: &CStr =
    unsafe { CStr::from_bytes_with_nul_unchecked(b"/Library/Keychains/\0") };
pub const kSystemUnlockFile: &CStr =
    unsafe { CStr::from_bytes_with_nul_unchecked(b"/var/db/SystemKey\0") };
extern "C" {
    #[cfg(all(feature = "cssmconfig", feature = "cssmtype"))]
    pub static gGuidCssm: CSSM_GUID;
}

extern "C" {
    #[cfg(all(feature = "cssmconfig", feature = "cssmtype"))]
    pub static gGuidAppleFileDL: CSSM_GUID;
}

extern "C" {
    #[cfg(all(feature = "cssmconfig", feature = "cssmtype"))]
    pub static gGuidAppleCSP: CSSM_GUID;
}

extern "C" {
    #[cfg(all(feature = "cssmconfig", feature = "cssmtype"))]
    pub static gGuidAppleCSPDL: CSSM_GUID;
}

extern "C" {
    #[cfg(all(feature = "cssmconfig", feature = "cssmtype"))]
    pub static gGuidAppleX509CL: CSSM_GUID;
}

extern "C" {
    #[cfg(all(feature = "cssmconfig", feature = "cssmtype"))]
    pub static gGuidAppleX509TP: CSSM_GUID;
}

extern "C" {
    #[cfg(all(feature = "cssmconfig", feature = "cssmtype"))]
    pub static gGuidAppleLDAPDL: CSSM_GUID;
}

extern "C" {
    #[cfg(all(feature = "cssmconfig", feature = "cssmtype"))]
    pub static gGuidAppleDotMacTP: CSSM_GUID;
}

extern "C" {
    #[cfg(all(feature = "cssmconfig", feature = "cssmtype"))]
    pub static gGuidAppleSdCSPDL: CSSM_GUID;
}

extern "C" {
    #[cfg(all(feature = "cssmconfig", feature = "cssmtype"))]
    pub static gGuidAppleDotMacDL: CSSM_GUID;
}

pub const CSSM_WORDID_KEYCHAIN_PROMPT: c_uint = 65536;
pub const CSSM_WORDID_KEYCHAIN_LOCK: c_uint = 65537;
pub const CSSM_WORDID_KEYCHAIN_CHANGE_LOCK: c_uint = 65538;
pub const CSSM_WORDID_PROCESS: c_uint = 65539;
pub const CSSM_WORDID__RESERVED_1: c_uint = 65540;
pub const CSSM_WORDID_SYMMETRIC_KEY: c_uint = 65541;
pub const CSSM_WORDID_SYSTEM: c_uint = 65542;
pub const CSSM_WORDID_KEY: c_uint = 65543;
pub const CSSM_WORDID_PIN: c_uint = 65544;
pub const CSSM_WORDID_PREAUTH: c_uint = 65545;
pub const CSSM_WORDID_PREAUTH_SOURCE: c_uint = 65546;
pub const CSSM_WORDID_ASYMMETRIC_KEY: c_uint = 65547;
pub const CSSM_WORDID_PARTITION: c_uint = 65548;
pub const CSSM_WORDID_KEYBAG_KEY: c_uint = 65549;
pub const CSSM_WORDID__FIRST_UNUSED: c_uint = 65550;

pub const CSSM_ACL_SUBJECT_TYPE_KEYCHAIN_PROMPT: c_uint = 65536;
pub const CSSM_ACL_SUBJECT_TYPE_PROCESS: c_uint = 65539;
pub const CSSM_ACL_SUBJECT_TYPE_CODE_SIGNATURE: c_uint = 116;
pub const CSSM_ACL_SUBJECT_TYPE_COMMENT: c_uint = 12;
pub const CSSM_ACL_SUBJECT_TYPE_SYMMETRIC_KEY: c_uint = 65541;
pub const CSSM_ACL_SUBJECT_TYPE_PREAUTH: c_uint = 65545;
pub const CSSM_ACL_SUBJECT_TYPE_PREAUTH_SOURCE: c_uint = 65546;
pub const CSSM_ACL_SUBJECT_TYPE_ASYMMETRIC_KEY: c_uint = 65547;
pub const CSSM_ACL_SUBJECT_TYPE_PARTITION: c_uint = 65548;

pub const CSSM_SAMPLE_TYPE_KEYCHAIN_PROMPT: c_uint = 65536;
pub const CSSM_SAMPLE_TYPE_KEYCHAIN_LOCK: c_uint = 65537;
pub const CSSM_SAMPLE_TYPE_KEYCHAIN_CHANGE_LOCK: c_uint = 65538;
pub const CSSM_SAMPLE_TYPE_PROCESS: c_uint = 65539;
pub const CSSM_SAMPLE_TYPE_COMMENT: c_uint = 12;
pub const CSSM_SAMPLE_TYPE_RETRY_ID: c_uint = 85;
pub const CSSM_SAMPLE_TYPE_SYMMETRIC_KEY: c_uint = 65541;
pub const CSSM_SAMPLE_TYPE_PREAUTH: c_uint = 65545;
pub const CSSM_SAMPLE_TYPE_ASYMMETRIC_KEY: c_uint = 65547;
pub const CSSM_SAMPLE_TYPE_KEYBAG_KEY: c_uint = 65549;

pub const CSSM_ACL_AUTHORIZATION_CHANGE_ACL: c_uint = 65536;
pub const CSSM_ACL_AUTHORIZATION_CHANGE_OWNER: c_uint = 65537;
pub const CSSM_ACL_AUTHORIZATION_PARTITION_ID: c_uint = 65538;
pub const CSSM_ACL_AUTHORIZATION_INTEGRITY: c_uint = 65539;
pub const CSSM_ACL_AUTHORIZATION_PREAUTH_BASE: c_uint = 16842752;
pub const CSSM_ACL_AUTHORIZATION_PREAUTH_END: c_uint = 16908288;

pub const CSSM_ACL_CODE_SIGNATURE_INVALID: c_uint = 0;
pub const CSSM_ACL_CODE_SIGNATURE_OSX: c_uint = 1;

pub const CSSM_ACL_MATCH_UID: c_uint = 1;
pub const CSSM_ACL_MATCH_GID: c_uint = 2;
pub const CSSM_ACL_MATCH_HONOR_ROOT: c_uint = 256;
pub const CSSM_ACL_MATCH_BITS: c_uint = 3;

pub const CSSM_ACL_PROCESS_SELECTOR_CURRENT_VERSION: c_uint = 257;

#[cfg(feature = "cssmconfig")]
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq, Default)]
pub struct cssm_acl_process_subject_selector {
    pub version: uint16,
    pub mask: uint16,
    pub uid: uint32,
    pub gid: uint32,
}

#[cfg(all(feature = "cssmconfig", feature = "objc2"))]
unsafe impl Encode for cssm_acl_process_subject_selector {
    const ENCODING: Encoding = Encoding::Struct(
        "cssm_acl_process_subject_selector",
        &[
            <uint16>::ENCODING,
            <uint16>::ENCODING,
            <uint32>::ENCODING,
            <uint32>::ENCODING,
        ],
    );
}

#[cfg(all(feature = "cssmconfig", feature = "objc2"))]
unsafe impl RefEncode for cssm_acl_process_subject_selector {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(feature = "cssmconfig")]
pub type CSSM_ACL_PROCESS_SUBJECT_SELECTOR = cssm_acl_process_subject_selector;

pub const CSSM_ACL_KEYCHAIN_PROMPT_CURRENT_VERSION: c_uint = 257;

pub const CSSM_ACL_KEYCHAIN_PROMPT_REQUIRE_PASSPHRASE: c_uint = 1;
pub const CSSM_ACL_KEYCHAIN_PROMPT_UNSIGNED: c_uint = 16;
pub const CSSM_ACL_KEYCHAIN_PROMPT_UNSIGNED_ACT: c_uint = 32;
pub const CSSM_ACL_KEYCHAIN_PROMPT_INVALID: c_uint = 64;
pub const CSSM_ACL_KEYCHAIN_PROMPT_INVALID_ACT: c_uint = 128;

#[cfg(feature = "cssmconfig")]
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq, Default)]
pub struct cssm_acl_keychain_prompt_selector {
    pub version: uint16,
    pub flags: uint16,
}

#[cfg(all(feature = "cssmconfig", feature = "objc2"))]
unsafe impl Encode for cssm_acl_keychain_prompt_selector {
    const ENCODING: Encoding = Encoding::Struct(
        "cssm_acl_keychain_prompt_selector",
        &[<uint16>::ENCODING, <uint16>::ENCODING],
    );
}

#[cfg(all(feature = "cssmconfig", feature = "objc2"))]
unsafe impl RefEncode for cssm_acl_keychain_prompt_selector {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(feature = "cssmconfig")]
pub type CSSM_ACL_KEYCHAIN_PROMPT_SELECTOR = cssm_acl_keychain_prompt_selector;

#[cfg(feature = "cssmconfig")]
pub type CSSM_ACL_PREAUTH_TRACKING_STATE = uint32;

pub const CSSM_ACL_PREAUTH_TRACKING_COUNT_MASK: c_uint = 255;
pub const CSSM_ACL_PREAUTH_TRACKING_BLOCKED: c_uint = 0;
pub const CSSM_ACL_PREAUTH_TRACKING_UNKNOWN: c_uint = 1073741824;
pub const CSSM_ACL_PREAUTH_TRACKING_AUTHORIZED: c_uint = 2147483648;

pub const CSSM_DB_ACCESS_RESET: c_uint = 65536;

pub const CSSM_ALGID_APPLE_YARROW: c_uint = 2147483648;
pub const CSSM_ALGID_AES: c_uint = 2147483649;
pub const CSSM_ALGID_FEE: c_uint = 2147483650;
pub const CSSM_ALGID_FEE_MD5: c_uint = 2147483651;
pub const CSSM_ALGID_FEE_SHA1: c_uint = 2147483652;
pub const CSSM_ALGID_FEED: c_uint = 2147483653;
pub const CSSM_ALGID_FEEDEXP: c_uint = 2147483654;
pub const CSSM_ALGID_ASC: c_uint = 2147483655;
pub const CSSM_ALGID_SHA1HMAC_LEGACY: c_uint = 2147483656;
pub const CSSM_ALGID_KEYCHAIN_KEY: c_uint = 2147483657;
pub const CSSM_ALGID_PKCS12_PBE_ENCR: c_uint = 2147483658;
pub const CSSM_ALGID_PKCS12_PBE_MAC: c_uint = 2147483659;
pub const CSSM_ALGID_SECURE_PASSPHRASE: c_uint = 2147483660;
pub const CSSM_ALGID_PBE_OPENSSL_MD5: c_uint = 2147483661;
pub const CSSM_ALGID_SHA256: c_uint = 2147483662;
pub const CSSM_ALGID_SHA384: c_uint = 2147483663;
pub const CSSM_ALGID_SHA512: c_uint = 2147483664;
pub const CSSM_ALGID_ENTROPY_DEFAULT: c_uint = 2147483665;
pub const CSSM_ALGID_SHA224: c_uint = 2147483666;
pub const CSSM_ALGID_SHA224WithRSA: c_uint = 2147483667;
pub const CSSM_ALGID_SHA256WithRSA: c_uint = 2147483668;
pub const CSSM_ALGID_SHA384WithRSA: c_uint = 2147483669;
pub const CSSM_ALGID_SHA512WithRSA: c_uint = 2147483670;
pub const CSSM_ALGID_OPENSSH1: c_uint = 2147483671;
pub const CSSM_ALGID_SHA224WithECDSA: c_uint = 2147483672;
pub const CSSM_ALGID_SHA256WithECDSA: c_uint = 2147483673;
pub const CSSM_ALGID_SHA384WithECDSA: c_uint = 2147483674;
pub const CSSM_ALGID_SHA512WithECDSA: c_uint = 2147483675;
pub const CSSM_ALGID_ECDSA_SPECIFIED: c_uint = 2147483676;
pub const CSSM_ALGID_ECDH_X963_KDF: c_uint = 2147483677;
pub const CSSM_ALGID__FIRST_UNUSED: c_uint = 2147483678;

pub const CSSM_PADDING_APPLE_SSLv2: c_uint = 2147483648;

pub const CSSM_KEYBLOB_RAW_FORMAT_VENDOR_DEFINED: c_uint = 2147483648;

pub const CSSM_KEYBLOB_RAW_FORMAT_X509: c_uint = 2147483648;
pub const CSSM_KEYBLOB_RAW_FORMAT_OPENSSH: c_uint = 2147483649;
pub const CSSM_KEYBLOB_RAW_FORMAT_OPENSSL: c_uint = 2147483650;
pub const CSSM_KEYBLOB_RAW_FORMAT_OPENSSH2: c_uint = 2147483651;

pub const CSSM_CUSTOM_COMMON_ERROR_EXTENT: c_uint = 224;
pub const CSSM_ERRCODE_NO_USER_INTERACTION: c_uint = 224;
pub const CSSM_ERRCODE_USER_CANCELED: c_uint = 225;
pub const CSSM_ERRCODE_SERVICE_NOT_AVAILABLE: c_uint = 226;
pub const CSSM_ERRCODE_INSUFFICIENT_CLIENT_IDENTIFICATION: c_uint = 227;
pub const CSSM_ERRCODE_DEVICE_RESET: c_uint = 228;
pub const CSSM_ERRCODE_DEVICE_FAILED: c_uint = 229;
pub const CSSM_ERRCODE_IN_DARK_WAKE: c_uint = 230;

pub const CSSMERR_CSSM_NO_USER_INTERACTION: c_int = -2147417888;
pub const CSSMERR_AC_NO_USER_INTERACTION: c_int = -2147405600;
pub const CSSMERR_CSP_NO_USER_INTERACTION: c_int = -2147415840;
pub const CSSMERR_CL_NO_USER_INTERACTION: c_int = -2147411744;
pub const CSSMERR_DL_NO_USER_INTERACTION: c_int = -2147413792;
pub const CSSMERR_TP_NO_USER_INTERACTION: c_int = -2147409696;
pub const CSSMERR_CSSM_USER_CANCELED: c_int = -2147417887;
pub const CSSMERR_AC_USER_CANCELED: c_int = -2147405599;
pub const CSSMERR_CSP_USER_CANCELED: c_int = -2147415839;
pub const CSSMERR_CL_USER_CANCELED: c_int = -2147411743;
pub const CSSMERR_DL_USER_CANCELED: c_int = -2147413791;
pub const CSSMERR_TP_USER_CANCELED: c_int = -2147409695;
pub const CSSMERR_CSSM_SERVICE_NOT_AVAILABLE: c_int = -2147417886;
pub const CSSMERR_AC_SERVICE_NOT_AVAILABLE: c_int = -2147405598;
pub const CSSMERR_CSP_SERVICE_NOT_AVAILABLE: c_int = -2147415838;
pub const CSSMERR_CL_SERVICE_NOT_AVAILABLE: c_int = -2147411742;
pub const CSSMERR_DL_SERVICE_NOT_AVAILABLE: c_int = -2147413790;
pub const CSSMERR_TP_SERVICE_NOT_AVAILABLE: c_int = -2147409694;
pub const CSSMERR_CSSM_INSUFFICIENT_CLIENT_IDENTIFICATION: c_int = -2147417885;
pub const CSSMERR_AC_INSUFFICIENT_CLIENT_IDENTIFICATION: c_int = -2147405597;
pub const CSSMERR_CSP_INSUFFICIENT_CLIENT_IDENTIFICATION: c_int = -2147415837;
pub const CSSMERR_CL_INSUFFICIENT_CLIENT_IDENTIFICATION: c_int = -2147411741;
pub const CSSMERR_DL_INSUFFICIENT_CLIENT_IDENTIFICATION: c_int = -2147413789;
pub const CSSMERR_TP_INSUFFICIENT_CLIENT_IDENTIFICATION: c_int = -2147409693;
pub const CSSMERR_CSSM_DEVICE_RESET: c_int = -2147417884;
pub const CSSMERR_AC_DEVICE_RESET: c_int = -2147405596;
pub const CSSMERR_CSP_DEVICE_RESET: c_int = -2147415836;
pub const CSSMERR_CL_DEVICE_RESET: c_int = -2147411740;
pub const CSSMERR_DL_DEVICE_RESET: c_int = -2147413788;
pub const CSSMERR_TP_DEVICE_RESET: c_int = -2147409692;
pub const CSSMERR_CSSM_DEVICE_FAILED: c_int = -2147417883;
pub const CSSMERR_AC_DEVICE_FAILED: c_int = -2147405595;
pub const CSSMERR_CSP_DEVICE_FAILED: c_int = -2147415835;
pub const CSSMERR_CL_DEVICE_FAILED: c_int = -2147411739;
pub const CSSMERR_DL_DEVICE_FAILED: c_int = -2147413787;
pub const CSSMERR_TP_DEVICE_FAILED: c_int = -2147409691;
pub const CSSMERR_CSSM_IN_DARK_WAKE: c_int = -2147417882;
pub const CSSMERR_AC_IN_DARK_WAKE: c_int = -2147405594;
pub const CSSMERR_CSP_IN_DARK_WAKE: c_int = -2147415834;
pub const CSSMERR_CL_IN_DARK_WAKE: c_int = -2147411738;
pub const CSSMERR_DL_IN_DARK_WAKE: c_int = -2147413786;
pub const CSSMERR_TP_IN_DARK_WAKE: c_int = -2147409690;

pub const CSSMERR_CSP_APPLE_ADD_APPLICATION_ACL_SUBJECT: c_int = -2147415040;
pub const CSSMERR_CSP_APPLE_PUBLIC_KEY_INCOMPLETE: c_int = -2147415039;
pub const CSSMERR_CSP_APPLE_SIGNATURE_MISMATCH: c_int = -2147415038;
pub const CSSMERR_CSP_APPLE_INVALID_KEY_START_DATE: c_int = -2147415037;
pub const CSSMERR_CSP_APPLE_INVALID_KEY_END_DATE: c_int = -2147415036;
pub const CSSMERR_CSPDL_APPLE_DL_CONVERSION_ERROR: c_int = -2147415035;
pub const CSSMERR_CSP_APPLE_SSLv2_ROLLBACK: c_int = -2147415034;

pub const CSSM_DL_DB_RECORD_GENERIC_PASSWORD: c_uint = 2147483648;
pub const CSSM_DL_DB_RECORD_INTERNET_PASSWORD: c_uint = 2147483649;
pub const CSSM_DL_DB_RECORD_APPLESHARE_PASSWORD: c_uint = 2147483650;
pub const CSSM_DL_DB_RECORD_X509_CERTIFICATE: c_uint = 2147487744;
pub const CSSM_DL_DB_RECORD_USER_TRUST: c_uint = 2147487745;
pub const CSSM_DL_DB_RECORD_X509_CRL: c_uint = 2147487746;
pub const CSSM_DL_DB_RECORD_UNLOCK_REFERRAL: c_uint = 2147487747;
pub const CSSM_DL_DB_RECORD_EXTENDED_ATTRIBUTE: c_uint = 2147487748;
pub const CSSM_DL_DB_RECORD_METADATA: c_uint = 2147516416;

pub const CSSM_APPLEFILEDL_TOGGLE_AUTOCOMMIT: c_uint = 0;
pub const CSSM_APPLEFILEDL_COMMIT: c_uint = 1;
pub const CSSM_APPLEFILEDL_ROLLBACK: c_uint = 2;
pub const CSSM_APPLEFILEDL_TAKE_FILE_LOCK: c_uint = 3;
pub const CSSM_APPLEFILEDL_MAKE_BACKUP: c_uint = 4;
pub const CSSM_APPLEFILEDL_MAKE_COPY: c_uint = 5;
pub const CSSM_APPLEFILEDL_DELETE_FILE: c_uint = 6;

pub const CSSM_APPLE_UNLOCK_TYPE_KEY_DIRECT: c_uint = 1;
pub const CSSM_APPLE_UNLOCK_TYPE_WRAPPED_PRIVATE: c_uint = 2;
pub const CSSM_APPLE_UNLOCK_TYPE_KEYBAG: c_uint = 3;

pub const CSSMERR_APPLEDL_INVALID_OPEN_PARAMETERS: c_int = -2147412992;
pub const CSSMERR_APPLEDL_DISK_FULL: c_int = -2147412991;
pub const CSSMERR_APPLEDL_QUOTA_EXCEEDED: c_int = -2147412990;
pub const CSSMERR_APPLEDL_FILE_TOO_BIG: c_int = -2147412989;
pub const CSSMERR_APPLEDL_INVALID_DATABASE_BLOB: c_int = -2147412988;
pub const CSSMERR_APPLEDL_INVALID_KEY_BLOB: c_int = -2147412987;
pub const CSSMERR_APPLEDL_INCOMPATIBLE_DATABASE_BLOB: c_int = -2147412986;
pub const CSSMERR_APPLEDL_INCOMPATIBLE_KEY_BLOB: c_int = -2147412985;

pub const CSSMERR_APPLETP_HOSTNAME_MISMATCH: c_int = -2147408896;
pub const CSSMERR_APPLETP_UNKNOWN_CRITICAL_EXTEN: c_int = -2147408895;
pub const CSSMERR_APPLETP_NO_BASIC_CONSTRAINTS: c_int = -2147408894;
pub const CSSMERR_APPLETP_INVALID_CA: c_int = -2147408893;
pub const CSSMERR_APPLETP_INVALID_AUTHORITY_ID: c_int = -2147408892;
pub const CSSMERR_APPLETP_INVALID_SUBJECT_ID: c_int = -2147408891;
pub const CSSMERR_APPLETP_INVALID_KEY_USAGE: c_int = -2147408890;
pub const CSSMERR_APPLETP_INVALID_EXTENDED_KEY_USAGE: c_int = -2147408889;
pub const CSSMERR_APPLETP_INVALID_ID_LINKAGE: c_int = -2147408888;
pub const CSSMERR_APPLETP_PATH_LEN_CONSTRAINT: c_int = -2147408887;
pub const CSSMERR_APPLETP_INVALID_ROOT: c_int = -2147408886;
pub const CSSMERR_APPLETP_CRL_EXPIRED: c_int = -2147408885;
pub const CSSMERR_APPLETP_CRL_NOT_VALID_YET: c_int = -2147408884;
pub const CSSMERR_APPLETP_CRL_NOT_FOUND: c_int = -2147408883;
pub const CSSMERR_APPLETP_CRL_SERVER_DOWN: c_int = -2147408882;
pub const CSSMERR_APPLETP_CRL_BAD_URI: c_int = -2147408881;
pub const CSSMERR_APPLETP_UNKNOWN_CERT_EXTEN: c_int = -2147408880;
pub const CSSMERR_APPLETP_UNKNOWN_CRL_EXTEN: c_int = -2147408879;
pub const CSSMERR_APPLETP_CRL_NOT_TRUSTED: c_int = -2147408878;
pub const CSSMERR_APPLETP_CRL_INVALID_ANCHOR_CERT: c_int = -2147408877;
pub const CSSMERR_APPLETP_CRL_POLICY_FAIL: c_int = -2147408876;
pub const CSSMERR_APPLETP_IDP_FAIL: c_int = -2147408875;
pub const CSSMERR_APPLETP_CERT_NOT_FOUND_FROM_ISSUER: c_int = -2147408874;
pub const CSSMERR_APPLETP_BAD_CERT_FROM_ISSUER: c_int = -2147408873;
pub const CSSMERR_APPLETP_SMIME_EMAIL_ADDRS_NOT_FOUND: c_int = -2147408872;
pub const CSSMERR_APPLETP_SMIME_BAD_EXT_KEY_USE: c_int = -2147408871;
pub const CSSMERR_APPLETP_SMIME_BAD_KEY_USE: c_int = -2147408870;
pub const CSSMERR_APPLETP_SMIME_KEYUSAGE_NOT_CRITICAL: c_int = -2147408869;
pub const CSSMERR_APPLETP_SMIME_NO_EMAIL_ADDRS: c_int = -2147408868;
pub const CSSMERR_APPLETP_SMIME_SUBJ_ALT_NAME_NOT_CRIT: c_int = -2147408867;
pub const CSSMERR_APPLETP_SSL_BAD_EXT_KEY_USE: c_int = -2147408866;
pub const CSSMERR_APPLETP_OCSP_BAD_RESPONSE: c_int = -2147408865;
pub const CSSMERR_APPLETP_OCSP_BAD_REQUEST: c_int = -2147408864;
pub const CSSMERR_APPLETP_OCSP_UNAVAILABLE: c_int = -2147408863;
pub const CSSMERR_APPLETP_OCSP_STATUS_UNRECOGNIZED: c_int = -2147408862;
pub const CSSMERR_APPLETP_INCOMPLETE_REVOCATION_CHECK: c_int = -2147408861;
pub const CSSMERR_APPLETP_NETWORK_FAILURE: c_int = -2147408860;
pub const CSSMERR_APPLETP_OCSP_NOT_TRUSTED: c_int = -2147408859;
pub const CSSMERR_APPLETP_OCSP_INVALID_ANCHOR_CERT: c_int = -2147408858;
pub const CSSMERR_APPLETP_OCSP_SIG_ERROR: c_int = -2147408857;
pub const CSSMERR_APPLETP_OCSP_NO_SIGNER: c_int = -2147408856;
pub const CSSMERR_APPLETP_OCSP_RESP_MALFORMED_REQ: c_int = -2147408855;
pub const CSSMERR_APPLETP_OCSP_RESP_INTERNAL_ERR: c_int = -2147408854;
pub const CSSMERR_APPLETP_OCSP_RESP_TRY_LATER: c_int = -2147408853;
pub const CSSMERR_APPLETP_OCSP_RESP_SIG_REQUIRED: c_int = -2147408852;
pub const CSSMERR_APPLETP_OCSP_RESP_UNAUTHORIZED: c_int = -2147408851;
pub const CSSMERR_APPLETP_OCSP_NONCE_MISMATCH: c_int = -2147408850;
pub const CSSMERR_APPLETP_CS_BAD_CERT_CHAIN_LENGTH: c_int = -2147408849;
pub const CSSMERR_APPLETP_CS_NO_BASIC_CONSTRAINTS: c_int = -2147408848;
pub const CSSMERR_APPLETP_CS_BAD_PATH_LENGTH: c_int = -2147408847;
pub const CSSMERR_APPLETP_CS_NO_EXTENDED_KEY_USAGE: c_int = -2147408846;
pub const CSSMERR_APPLETP_CODE_SIGN_DEVELOPMENT: c_int = -2147408845;
pub const CSSMERR_APPLETP_RS_BAD_CERT_CHAIN_LENGTH: c_int = -2147408844;
pub const CSSMERR_APPLETP_RS_BAD_EXTENDED_KEY_USAGE: c_int = -2147408843;
pub const CSSMERR_APPLETP_TRUST_SETTING_DENY: c_int = -2147408842;
pub const CSSMERR_APPLETP_INVALID_EMPTY_SUBJECT: c_int = -2147408841;
pub const CSSMERR_APPLETP_UNKNOWN_QUAL_CERT_STATEMENT: c_int = -2147408840;
pub const CSSMERR_APPLETP_MISSING_REQUIRED_EXTENSION: c_int = -2147408839;
pub const CSSMERR_APPLETP_EXT_KEYUSAGE_NOT_CRITICAL: c_int = -2147408838;
pub const CSSMERR_APPLETP_IDENTIFIER_MISSING: c_int = -2147408837;
pub const CSSMERR_APPLETP_CA_PIN_MISMATCH: c_int = -2147408836;
pub const CSSMERR_APPLETP_LEAF_PIN_MISMATCH: c_int = -2147408835;

pub const CSSMERR_APPLE_DOTMAC_REQ_QUEUED: c_int = -2147408796;
pub const CSSMERR_APPLE_DOTMAC_REQ_REDIRECT: c_int = -2147408795;
pub const CSSMERR_APPLE_DOTMAC_REQ_SERVER_ERR: c_int = -2147408794;
pub const CSSMERR_APPLE_DOTMAC_REQ_SERVER_PARAM: c_int = -2147408793;
pub const CSSMERR_APPLE_DOTMAC_REQ_SERVER_AUTH: c_int = -2147408792;
pub const CSSMERR_APPLE_DOTMAC_REQ_SERVER_UNIMPL: c_int = -2147408791;
pub const CSSMERR_APPLE_DOTMAC_REQ_SERVER_NOT_AVAIL: c_int = -2147408790;
pub const CSSMERR_APPLE_DOTMAC_REQ_SERVER_ALREADY_EXIST: c_int = -2147408789;
pub const CSSMERR_APPLE_DOTMAC_REQ_SERVER_SERVICE_ERROR: c_int = -2147408788;
pub const CSSMERR_APPLE_DOTMAC_REQ_IS_PENDING: c_int = -2147408787;
pub const CSSMERR_APPLE_DOTMAC_NO_REQ_PENDING: c_int = -2147408786;
pub const CSSMERR_APPLE_DOTMAC_CSR_VERIFY_FAIL: c_int = -2147408785;
pub const CSSMERR_APPLE_DOTMAC_FAILED_CONSISTENCY_CHECK: c_int = -2147408784;

pub const CSSM_APPLEDL_OPEN_PARAMETERS_VERSION: c_uint = 1;

#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord)]
pub struct cssm_appledl_open_parameters_mask(pub c_uint);
impl cssm_appledl_open_parameters_mask {
    #[doc(alias = "kCSSM_APPLEDL_MASK_MODE")]
    pub const CSSM_APPLEDL_MASK_MODE: Self = Self(1 << 0);
}

#[cfg(feature = "objc2")]
unsafe impl Encode for cssm_appledl_open_parameters_mask {
    const ENCODING: Encoding = c_uint::ENCODING;
}

#[cfg(feature = "objc2")]
unsafe impl RefEncode for cssm_appledl_open_parameters_mask {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(all(feature = "cssmconfig", feature = "cssmtype", feature = "libc"))]
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq, Default)]
pub struct cssm_appledl_open_parameters {
    pub length: uint32,
    pub version: uint32,
    pub autoCommit: CSSM_BOOL,
    pub mask: uint32,
    pub mode: libc::mode_t,
}

#[cfg(all(
    feature = "cssmconfig",
    feature = "cssmtype",
    feature = "libc",
    feature = "objc2"
))]
unsafe impl Encode for cssm_appledl_open_parameters {
    const ENCODING: Encoding = Encoding::Struct(
        "cssm_appledl_open_parameters",
        &[
            <uint32>::ENCODING,
            <uint32>::ENCODING,
            <CSSM_BOOL>::ENCODING,
            <uint32>::ENCODING,
            <libc::mode_t>::ENCODING,
        ],
    );
}

#[cfg(all(
    feature = "cssmconfig",
    feature = "cssmtype",
    feature = "libc",
    feature = "objc2"
))]
unsafe impl RefEncode for cssm_appledl_open_parameters {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(all(feature = "cssmconfig", feature = "cssmtype", feature = "libc"))]
pub type CSSM_APPLEDL_OPEN_PARAMETERS = cssm_appledl_open_parameters;

#[cfg(all(feature = "cssmconfig", feature = "cssmtype", feature = "libc"))]
pub type CSSM_APPLEDL_OPEN_PARAMETERS_PTR = *mut cssm_appledl_open_parameters;

pub const CSSM_APPLECSPDL_DB_LOCK: c_uint = 0;
pub const CSSM_APPLECSPDL_DB_UNLOCK: c_uint = 1;
pub const CSSM_APPLECSPDL_DB_GET_SETTINGS: c_uint = 2;
pub const CSSM_APPLECSPDL_DB_SET_SETTINGS: c_uint = 3;
pub const CSSM_APPLECSPDL_DB_IS_LOCKED: c_uint = 4;
pub const CSSM_APPLECSPDL_DB_CHANGE_PASSWORD: c_uint = 5;
pub const CSSM_APPLECSPDL_DB_GET_HANDLE: c_uint = 6;
pub const CSSM_APPLESCPDL_CSP_GET_KEYHANDLE: c_uint = 7;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_8: c_uint = 8;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_9: c_uint = 9;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_10: c_uint = 10;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_11: c_uint = 11;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_12: c_uint = 12;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_13: c_uint = 13;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_14: c_uint = 14;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_15: c_uint = 15;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_16: c_uint = 16;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_17: c_uint = 17;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_18: c_uint = 18;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_19: c_uint = 19;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_20: c_uint = 20;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_21: c_uint = 21;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_22: c_uint = 22;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_23: c_uint = 23;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_24: c_uint = 24;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_25: c_uint = 25;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_26: c_uint = 26;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_27: c_uint = 27;
pub const CSSM_APPLE_PRIVATE_CSPDL_CODE_28: c_uint = 28;
pub const CSSM_APPLECSP_KEYDIGEST: c_uint = 256;
pub const CSSM_APPLECSP_PUBKEY: c_uint = 257;

#[cfg(feature = "cssmconfig")]
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq, Default)]
pub struct cssm_applecspdl_db_settings_parameters {
    pub idleTimeout: uint32,
    pub lockOnSleep: uint8,
}

#[cfg(all(feature = "cssmconfig", feature = "objc2"))]
unsafe impl Encode for cssm_applecspdl_db_settings_parameters {
    const ENCODING: Encoding = Encoding::Struct(
        "cssm_applecspdl_db_settings_parameters",
        &[<uint32>::ENCODING, <uint8>::ENCODING],
    );
}

#[cfg(all(feature = "cssmconfig", feature = "objc2"))]
unsafe impl RefEncode for cssm_applecspdl_db_settings_parameters {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(feature = "cssmconfig")]
pub type CSSM_APPLECSPDL_DB_SETTINGS_PARAMETERS = cssm_applecspdl_db_settings_parameters;

#[cfg(feature = "cssmconfig")]
pub type CSSM_APPLECSPDL_DB_SETTINGS_PARAMETERS_PTR = *mut cssm_applecspdl_db_settings_parameters;

#[cfg(feature = "cssmconfig")]
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq, Default)]
pub struct cssm_applecspdl_db_is_locked_parameters {
    pub isLocked: uint8,
}

#[cfg(all(feature = "cssmconfig", feature = "objc2"))]
unsafe impl Encode for cssm_applecspdl_db_is_locked_parameters {
    const ENCODING: Encoding = Encoding::Struct(
        "cssm_applecspdl_db_is_locked_parameters",
        &[<uint8>::ENCODING],
    );
}

#[cfg(all(feature = "cssmconfig", feature = "objc2"))]
unsafe impl RefEncode for cssm_applecspdl_db_is_locked_parameters {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(feature = "cssmconfig")]
pub type CSSM_APPLECSPDL_DB_IS_LOCKED_PARAMETERS = cssm_applecspdl_db_is_locked_parameters;

#[cfg(feature = "cssmconfig")]
pub type CSSM_APPLECSPDL_DB_IS_LOCKED_PARAMETERS_PTR = *mut cssm_applecspdl_db_is_locked_parameters;

#[cfg(all(feature = "SecAsn1Types", feature = "cssmconfig", feature = "cssmtype"))]
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct cssm_applecspdl_db_change_password_parameters {
    pub accessCredentials: *mut CSSM_ACCESS_CREDENTIALS,
}

#[cfg(all(
    feature = "SecAsn1Types",
    feature = "cssmconfig",
    feature = "cssmtype",
    feature = "objc2"
))]
unsafe impl Encode for cssm_applecspdl_db_change_password_parameters {
    const ENCODING: Encoding = Encoding::Struct(
        "cssm_applecspdl_db_change_password_parameters",
        &[<*mut CSSM_ACCESS_CREDENTIALS>::ENCODING],
    );
}

#[cfg(all(
    feature = "SecAsn1Types",
    feature = "cssmconfig",
    feature = "cssmtype",
    feature = "objc2"
))]
unsafe impl RefEncode for cssm_applecspdl_db_change_password_parameters {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(all(feature = "SecAsn1Types", feature = "cssmconfig", feature = "cssmtype"))]
pub type CSSM_APPLECSPDL_DB_CHANGE_PASSWORD_PARAMETERS =
    cssm_applecspdl_db_change_password_parameters;

#[cfg(all(feature = "SecAsn1Types", feature = "cssmconfig", feature = "cssmtype"))]
pub type CSSM_APPLECSPDL_DB_CHANGE_PASSWORD_PARAMETERS_PTR =
    *mut cssm_applecspdl_db_change_password_parameters;

pub const CSSM_KEYBLOB_WRAPPED_FORMAT_APPLE_CUSTOM: c_uint = 100;
pub const CSSM_KEYBLOB_WRAPPED_FORMAT_OPENSSL: c_uint = 101;
pub const CSSM_KEYBLOB_WRAPPED_FORMAT_OPENSSH1: c_uint = 102;

pub const CSSM_ATTRIBUTE_VENDOR_DEFINED: c_uint = 8388608;

pub const CSSM_ATTRIBUTE_PUBLIC_KEY: c_uint = 1082130432;
pub const CSSM_ATTRIBUTE_FEE_PRIME_TYPE: c_uint = 276824065;
pub const CSSM_ATTRIBUTE_FEE_CURVE_TYPE: c_uint = 276824066;
pub const CSSM_ATTRIBUTE_ASC_OPTIMIZATION: c_uint = 276824067;
pub const CSSM_ATTRIBUTE_RSA_BLINDING: c_uint = 276824068;
pub const CSSM_ATTRIBUTE_PARAM_KEY: c_uint = 1082130437;
pub const CSSM_ATTRIBUTE_PROMPT: c_uint = 545259526;
pub const CSSM_ATTRIBUTE_ALERT_TITLE: c_uint = 545259527;
pub const CSSM_ATTRIBUTE_VERIFY_PASSPHRASE: c_uint = 276824072;

pub const CSSM_FEE_PRIME_TYPE_DEFAULT: c_uint = 0;
pub const CSSM_FEE_PRIME_TYPE_MERSENNE: c_uint = 1;
pub const CSSM_FEE_PRIME_TYPE_FEE: c_uint = 2;
pub const CSSM_FEE_PRIME_TYPE_GENERAL: c_uint = 3;

pub const CSSM_FEE_CURVE_TYPE_DEFAULT: c_uint = 0;
pub const CSSM_FEE_CURVE_TYPE_MONTGOMERY: c_uint = 1;
pub const CSSM_FEE_CURVE_TYPE_WEIERSTRASS: c_uint = 2;
pub const CSSM_FEE_CURVE_TYPE_ANSI_X9_62: c_uint = 3;

pub const CSSM_ASC_OPTIMIZE_DEFAULT: c_uint = 0;
pub const CSSM_ASC_OPTIMIZE_SIZE: c_uint = 1;
pub const CSSM_ASC_OPTIMIZE_SECURITY: c_uint = 2;
pub const CSSM_ASC_OPTIMIZE_TIME: c_uint = 3;
pub const CSSM_ASC_OPTIMIZE_TIME_SIZE: c_uint = 4;
pub const CSSM_ASC_OPTIMIZE_ASCII: c_uint = 5;

pub const CSSM_KEYATTR_PARTIAL: c_uint = 65536;
pub const CSSM_KEYATTR_PUBLIC_KEY_ENCRYPT: c_uint = 131072;

#[cfg(feature = "SecAsn1Types")]
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct CSSM_APPLE_TP_NAME_OID {
    pub string: *const c_char,
    pub oid: *const SecAsn1Oid,
}

#[cfg(all(feature = "SecAsn1Types", feature = "objc2"))]
unsafe impl Encode for CSSM_APPLE_TP_NAME_OID {
    const ENCODING: Encoding = Encoding::Struct(
        "?",
        &[<*const c_char>::ENCODING, <*const SecAsn1Oid>::ENCODING],
    );
}

#[cfg(all(feature = "SecAsn1Types", feature = "objc2"))]
unsafe impl RefEncode for CSSM_APPLE_TP_NAME_OID {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(all(
    feature = "SecAsn1Types",
    feature = "certextensions",
    feature = "cssmconfig",
    feature = "cssmtype",
    feature = "x509defs"
))]
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct CSSM_APPLE_TP_CERT_REQUEST {
    pub cspHand: CSSM_CSP_HANDLE,
    pub clHand: CSSM_CL_HANDLE,
    pub serialNumber: uint32,
    pub numSubjectNames: uint32,
    pub subjectNames: *mut CSSM_APPLE_TP_NAME_OID,
    pub numIssuerNames: uint32,
    pub issuerNames: *mut CSSM_APPLE_TP_NAME_OID,
    pub issuerNameX509: CSSM_X509_NAME_PTR,
    pub certPublicKey: *const CSSM_KEY,
    pub issuerPrivateKey: *const CSSM_KEY,
    pub signatureAlg: CSSM_ALGORITHMS,
    pub signatureOid: SecAsn1Oid,
    pub notBefore: uint32,
    pub notAfter: uint32,
    pub numExtensions: uint32,
    pub extensions: *mut CE_DataAndType,
    pub challengeString: *const c_char,
}

#[cfg(all(
    feature = "SecAsn1Types",
    feature = "certextensions",
    feature = "cssmconfig",
    feature = "cssmtype",
    feature = "objc2",
    feature = "x509defs"
))]
unsafe impl Encode for CSSM_APPLE_TP_CERT_REQUEST {
    const ENCODING: Encoding = Encoding::Struct(
        "?",
        &[
            <CSSM_CSP_HANDLE>::ENCODING,
            <CSSM_CL_HANDLE>::ENCODING,
            <uint32>::ENCODING,
            <uint32>::ENCODING,
            <*mut CSSM_APPLE_TP_NAME_OID>::ENCODING,
            <uint32>::ENCODING,
            <*mut CSSM_APPLE_TP_NAME_OID>::ENCODING,
            <CSSM_X509_NAME_PTR>::ENCODING,
            <*const CSSM_KEY>::ENCODING,
            <*const CSSM_KEY>::ENCODING,
            <CSSM_ALGORITHMS>::ENCODING,
            <SecAsn1Oid>::ENCODING,
            <uint32>::ENCODING,
            <uint32>::ENCODING,
            <uint32>::ENCODING,
            <*mut CE_DataAndType>::ENCODING,
            <*const c_char>::ENCODING,
        ],
    );
}

#[cfg(all(
    feature = "SecAsn1Types",
    feature = "certextensions",
    feature = "cssmconfig",
    feature = "cssmtype",
    feature = "objc2",
    feature = "x509defs"
))]
unsafe impl RefEncode for CSSM_APPLE_TP_CERT_REQUEST {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(feature = "cssmconfig")]
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct CSSM_APPLE_TP_SSL_OPTIONS {
    pub Version: uint32,
    pub ServerNameLen: uint32,
    pub ServerName: *const c_char,
    pub Flags: uint32,
}

#[cfg(all(feature = "cssmconfig", feature = "objc2"))]
unsafe impl Encode for CSSM_APPLE_TP_SSL_OPTIONS {
    const ENCODING: Encoding = Encoding::Struct(
        "?",
        &[
            <uint32>::ENCODING,
            <uint32>::ENCODING,
            <*const c_char>::ENCODING,
            <uint32>::ENCODING,
        ],
    );
}

#[cfg(all(feature = "cssmconfig", feature = "objc2"))]
unsafe impl RefEncode for CSSM_APPLE_TP_SSL_OPTIONS {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(feature = "cssmconfig")]
pub type CSSM_APPLE_TP_CRL_OPT_FLAGS = uint32;

pub const CSSM_TP_ACTION_REQUIRE_CRL_PER_CERT: c_uint = 1;
pub const CSSM_TP_ACTION_FETCH_CRL_FROM_NET: c_uint = 2;
pub const CSSM_TP_ACTION_CRL_SUFFICIENT: c_uint = 4;
pub const CSSM_TP_ACTION_REQUIRE_CRL_IF_PRESENT: c_uint = 8;

#[cfg(all(feature = "cssmconfig", feature = "cssmtype"))]
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct CSSM_APPLE_TP_CRL_OPTIONS {
    pub Version: uint32,
    pub CrlFlags: CSSM_APPLE_TP_CRL_OPT_FLAGS,
    pub crlStore: CSSM_DL_DB_HANDLE_PTR,
}

#[cfg(all(feature = "cssmconfig", feature = "cssmtype", feature = "objc2"))]
unsafe impl Encode for CSSM_APPLE_TP_CRL_OPTIONS {
    const ENCODING: Encoding = Encoding::Struct(
        "?",
        &[
            <uint32>::ENCODING,
            <CSSM_APPLE_TP_CRL_OPT_FLAGS>::ENCODING,
            <CSSM_DL_DB_HANDLE_PTR>::ENCODING,
        ],
    );
}

#[cfg(all(feature = "cssmconfig", feature = "cssmtype", feature = "objc2"))]
unsafe impl RefEncode for CSSM_APPLE_TP_CRL_OPTIONS {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(all(feature = "certextensions", feature = "cssmconfig"))]
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct CSSM_APPLE_TP_SMIME_OPTIONS {
    pub Version: uint32,
    pub IntendedUsage: CE_KeyUsage,
    pub SenderEmailLen: uint32,
    pub SenderEmail: *const c_char,
}

#[cfg(all(feature = "certextensions", feature = "cssmconfig", feature = "objc2"))]
unsafe impl Encode for CSSM_APPLE_TP_SMIME_OPTIONS {
    const ENCODING: Encoding = Encoding::Struct(
        "?",
        &[
            <uint32>::ENCODING,
            <CE_KeyUsage>::ENCODING,
            <uint32>::ENCODING,
            <*const c_char>::ENCODING,
        ],
    );
}

#[cfg(all(feature = "certextensions", feature = "cssmconfig", feature = "objc2"))]
unsafe impl RefEncode for CSSM_APPLE_TP_SMIME_OPTIONS {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(feature = "cssmconfig")]
pub type CSSM_APPLE_TP_ACTION_FLAGS = uint32;

pub const CSSM_TP_ACTION_ALLOW_EXPIRED: c_uint = 1;
pub const CSSM_TP_ACTION_LEAF_IS_CA: c_uint = 2;
pub const CSSM_TP_ACTION_FETCH_CERT_FROM_NET: c_uint = 4;
pub const CSSM_TP_ACTION_ALLOW_EXPIRED_ROOT: c_uint = 8;
pub const CSSM_TP_ACTION_REQUIRE_REV_PER_CERT: c_uint = 16;
pub const CSSM_TP_ACTION_TRUST_SETTINGS: c_uint = 32;
pub const CSSM_TP_ACTION_IMPLICIT_ANCHORS: c_uint = 64;

#[cfg(feature = "cssmconfig")]
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq, Default)]
pub struct CSSM_APPLE_TP_ACTION_DATA {
    pub Version: uint32,
    pub ActionFlags: CSSM_APPLE_TP_ACTION_FLAGS,
}

#[cfg(all(feature = "cssmconfig", feature = "objc2"))]
unsafe impl Encode for CSSM_APPLE_TP_ACTION_DATA {
    const ENCODING: Encoding = Encoding::Struct(
        "?",
        &[<uint32>::ENCODING, <CSSM_APPLE_TP_ACTION_FLAGS>::ENCODING],
    );
}

#[cfg(all(feature = "cssmconfig", feature = "objc2"))]
unsafe impl RefEncode for CSSM_APPLE_TP_ACTION_DATA {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(feature = "cssmconfig")]
pub type CSSM_TP_APPLE_CERT_STATUS = uint32;

pub const CSSM_CERT_STATUS_EXPIRED: c_uint = 1;
pub const CSSM_CERT_STATUS_NOT_VALID_YET: c_uint = 2;
pub const CSSM_CERT_STATUS_IS_IN_INPUT_CERTS: c_uint = 4;
pub const CSSM_CERT_STATUS_IS_IN_ANCHORS: c_uint = 8;
pub const CSSM_CERT_STATUS_IS_ROOT: c_uint = 16;
pub const CSSM_CERT_STATUS_IS_FROM_NET: c_uint = 32;
pub const CSSM_CERT_STATUS_TRUST_SETTINGS_FOUND_USER: c_uint = 64;
pub const CSSM_CERT_STATUS_TRUST_SETTINGS_FOUND_ADMIN: c_uint = 128;
pub const CSSM_CERT_STATUS_TRUST_SETTINGS_FOUND_SYSTEM: c_uint = 256;
pub const CSSM_CERT_STATUS_TRUST_SETTINGS_TRUST: c_uint = 512;
pub const CSSM_CERT_STATUS_TRUST_SETTINGS_DENY: c_uint = 1024;
pub const CSSM_CERT_STATUS_TRUST_SETTINGS_IGNORED_ERROR: c_uint = 2048;

#[cfg(feature = "cssmconfig")]
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq, Default)]
pub struct CSSM_TP_APPLE_EVIDENCE_HEADER {
    pub Version: uint32,
}

#[cfg(all(feature = "cssmconfig", feature = "objc2"))]
unsafe impl Encode for CSSM_TP_APPLE_EVIDENCE_HEADER {
    const ENCODING: Encoding = Encoding::Struct("?", &[<uint32>::ENCODING]);
}

#[cfg(all(feature = "cssmconfig", feature = "objc2"))]
unsafe impl RefEncode for CSSM_TP_APPLE_EVIDENCE_HEADER {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

pub const CSSM_EVIDENCE_FORM_APPLE_HEADER: c_uint = 2147483648;
pub const CSSM_EVIDENCE_FORM_APPLE_CERTGROUP: c_uint = 2147483649;
pub const CSSM_EVIDENCE_FORM_APPLE_CERT_INFO: c_uint = 2147483650;

pub const CSSM_APPLEX509CL_OBTAIN_CSR: c_uint = 0;
pub const CSSM_APPLEX509CL_VERIFY_CSR: c_uint = 1;

#[cfg(all(
    feature = "SecAsn1Types",
    feature = "cssmconfig",
    feature = "cssmtype",
    feature = "x509defs"
))]
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct CSSM_APPLE_CL_CSR_REQUEST {
    pub subjectNameX509: CSSM_X509_NAME_PTR,
    pub signatureAlg: CSSM_ALGORITHMS,
    pub signatureOid: SecAsn1Oid,
    pub cspHand: CSSM_CSP_HANDLE,
    pub subjectPublicKey: *const CSSM_KEY,
    pub subjectPrivateKey: *const CSSM_KEY,
    pub challengeString: *const c_char,
}

#[cfg(all(
    feature = "SecAsn1Types",
    feature = "cssmconfig",
    feature = "cssmtype",
    feature = "objc2",
    feature = "x509defs"
))]
unsafe impl Encode for CSSM_APPLE_CL_CSR_REQUEST {
    const ENCODING: Encoding = Encoding::Struct(
        "?",
        &[
            <CSSM_X509_NAME_PTR>::ENCODING,
            <CSSM_ALGORITHMS>::ENCODING,
            <SecAsn1Oid>::ENCODING,
            <CSSM_CSP_HANDLE>::ENCODING,
            <*const CSSM_KEY>::ENCODING,
            <*const CSSM_KEY>::ENCODING,
            <*const c_char>::ENCODING,
        ],
    );
}

#[cfg(all(
    feature = "SecAsn1Types",
    feature = "cssmconfig",
    feature = "cssmtype",
    feature = "objc2",
    feature = "x509defs"
))]
unsafe impl RefEncode for CSSM_APPLE_CL_CSR_REQUEST {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

extern "C-unwind" {
    /// # Safety
    ///
    /// `how` must be a valid pointer.
    #[cfg(all(feature = "cssmconfig", feature = "cssmtype"))]
    pub fn cssmPerror(how: *const c_char, error: CSSM_RETURN);
}

extern "C-unwind" {
    /// # Safety
    ///
    /// - `oid` must be a valid pointer.
    /// - `alg` must be a valid pointer.
    #[cfg(all(feature = "SecAsn1Types", feature = "cssmconfig", feature = "cssmtype"))]
    pub fn cssmOidToAlg(oid: *const SecAsn1Oid, alg: *mut CSSM_ALGORITHMS) -> bool;
}

extern "C-unwind" {
    #[cfg(all(feature = "SecAsn1Types", feature = "cssmconfig", feature = "cssmtype"))]
    pub fn cssmAlgToOid(alg_id: CSSM_ALGORITHMS) -> *const SecAsn1Oid;
}
