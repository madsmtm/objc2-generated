//! This file has been automatically generated by `objc2`'s `header-translator`.
//! DO NOT EDIT
use core::cell::UnsafeCell;
use core::ffi::*;
use core::marker::{PhantomData, PhantomPinned};
use core::ptr::NonNull;
#[cfg(feature = "objc2")]
use objc2::__framework_prelude::*;
use objc2_core_foundation::*;

use crate::*;

/// An opaque reference to a CMS decoder object.
///
/// ## Overview
///
/// This is object is compatible with Core Foundation and uses standard Core Foundation semantics. Dispose of it with the [`CFRelease`](https://developer.apple.comhttps://developer.apple.com/documentation/corefoundation/1521153-cfrelease) function.
///
///
#[doc(alias = "CMSDecoderRef")]
#[repr(C)]
pub struct CMSDecoder {
    inner: [u8; 0],
    _p: UnsafeCell<PhantomData<(*const UnsafeCell<()>, PhantomPinned)>>,
}

cf_type!(
    unsafe impl CMSDecoder {}
);
#[cfg(feature = "objc2")]
cf_objc2_type!(
    unsafe impl RefEncode<"_CMSDecoder"> for CMSDecoder {}
);

unsafe impl ConcreteType for CMSDecoder {
    /// Returns the type identifier for the CMSDecoder opaque type.
    #[doc(alias = "CMSDecoderGetTypeID")]
    #[inline]
    fn type_id() -> CFTypeID {
        extern "C-unwind" {
            fn CMSDecoderGetTypeID() -> CFTypeID;
        }
        unsafe { CMSDecoderGetTypeID() }
    }
}

/// The constants that indicate the status of the signature and signer information in a signed message.
///
/// ## Overview
///
/// These are obtained using the [`CMSDecoderCopySignerStatus`](https://developer.apple.com/documentation/security/cmsdecodercopysignerstatus(_:_:_:_:_:_:_:)) function.
///
///
// NS_ENUM
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord, Default)]
pub struct CMSSignerStatus(pub u32);
impl CMSSignerStatus {
    /// The message was not signed.
    #[doc(alias = "kCMSSignerUnsigned")]
    pub const Unsigned: Self = Self(0);
    /// The message was signed and both the signature and the signer certificate have been verified.
    #[doc(alias = "kCMSSignerValid")]
    pub const Valid: Self = Self(1);
    /// The message was signed but has detached content. You must call the [`CMSDecoderSetDetachedContent`](https://developer.apple.com/documentation/security/cmsdecodersetdetachedcontent(_:_:)) function before ascertaining the signature status.
    #[doc(alias = "kCMSSignerNeedsDetachedContent")]
    pub const NeedsDetachedContent: Self = Self(2);
    /// The message was signed but the signature is invalid.
    #[doc(alias = "kCMSSignerInvalidSignature")]
    pub const InvalidSignature: Self = Self(3);
    /// The message was signed but the signer’s certificate could not be verified.
    #[doc(alias = "kCMSSignerInvalidCert")]
    pub const InvalidCert: Self = Self(4);
    /// The specified value for the signer index (`signerIndex` parameter) is greater than the number of signers of the message minus one (`signerIndex > (numSigners – 1)`).
    #[doc(alias = "kCMSSignerInvalidIndex")]
    pub const InvalidIndex: Self = Self(5);
}

#[cfg(feature = "objc2")]
unsafe impl Encode for CMSSignerStatus {
    const ENCODING: Encoding = u32::ENCODING;
}

#[cfg(feature = "objc2")]
unsafe impl RefEncode for CMSSignerStatus {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

impl CMSDecoder {
    /// Creates a CMSDecoder reference.
    ///
    /// Parameters:
    /// - cmsDecoderOut: On return, points to a CMSDecoder reference. You must use the `CFRelease` function to free this reference when you are finished using it.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// This is the first function in a sequence of decoder functions that you call to get information from a CMS message. The other functions in the sequence require you to pass in the CMSDecoder reference returned by this function. The next function in the sequence is `CMSDecoderUpdateMessage`.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `cms_decoder_out` must be a valid pointer.
    #[doc(alias = "CMSDecoderCreate")]
    #[inline]
    pub unsafe fn create(cms_decoder_out: NonNull<*mut CMSDecoder>) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderCreate(cms_decoder_out: NonNull<*mut CMSDecoder>) -> OSStatus;
        }
        unsafe { CMSDecoderCreate(cms_decoder_out) }
    }

    /// Feeds raw bytes of the message to be decoded into the decoder.
    ///
    /// Parameters:
    /// - cmsDecoder: The CMSDecoder reference returned by the `CMSDecoderCreate` function.
    ///
    /// - msgBytes: A pointer to the data to be decoded.
    ///
    /// - msgBytesLen: The length of the data, in bytes.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). Returns [`errSecUnknownFormat`](https://developer.apple.com/documentation/security/errsecunknownformat) upon detection of an improperly formatted CMS message.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// This function can be called multiple times. Call the `CMSDecoderFinalizeMessage` function when you have no more data to decode.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `msg_bytes` must be a valid pointer.
    #[doc(alias = "CMSDecoderUpdateMessage")]
    #[inline]
    pub unsafe fn update_message(
        &self,
        msg_bytes: NonNull<c_void>,
        msg_bytes_len: usize,
    ) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderUpdateMessage(
                cms_decoder: &CMSDecoder,
                msg_bytes: NonNull<c_void>,
                msg_bytes_len: usize,
            ) -> OSStatus;
        }
        unsafe { CMSDecoderUpdateMessage(self, msg_bytes, msg_bytes_len) }
    }

    /// Indicates that there is no more data to decode.
    ///
    /// Parameters:
    /// - cmsDecoder: The CMSDecoder reference returned by the `CMSDecoderCreate` function.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). Returns [`errSecUnknownFormat`](https://developer.apple.com/documentation/security/errsecunknownformat) upon detection of an improperly formatted CMS message.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// When you call this function, the decoder finishes decoding the message. If the message was encrypted and this function returns a result code of `noErr`, the message was successfully decrypted. Call the [`CMSDecoderCopyContent`](https://developer.apple.com/documentation/security/cmsdecodercopycontent(_:_:)) function to retrieve the message content. Call the [`CMSDecoderGetNumSigners`](https://developer.apple.com/documentation/security/cmsdecodergetnumsigners(_:_:)) function to find out if the message was signed and, if so, how many signers there were.
    ///
    ///
    #[doc(alias = "CMSDecoderFinalizeMessage")]
    #[inline]
    pub unsafe fn finalize_message(&self) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderFinalizeMessage(cms_decoder: &CMSDecoder) -> OSStatus;
        }
        unsafe { CMSDecoderFinalizeMessage(self) }
    }

    /// Specifies the message’s detached content, if any.
    ///
    /// Parameters:
    /// - cmsDecoder: The CMSDecoder reference returned by the `CMSDecoderCreate` function.
    ///
    /// - detachedContent: A reference to the message’s detached content.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// The data of a signed CMS message can optionally be sent separately from the message. If the message’s content is detached from the message, you must call this function to tell the decoder where to find the message content.
    ///
    /// Encrypted messages, including those that are also signed, cannot use detached content.
    ///
    /// You can call this function either before or after decoding the message (by calling the `CMSDecoderUpdateMessage` and `CMSDecoderFinalizeMessage` functions). If a signed message has detached content, however, you must call this function before you can use the `CMSDecoderCopySignerStatus` function to ascertain the signature status.
    ///
    ///
    #[doc(alias = "CMSDecoderSetDetachedContent")]
    #[inline]
    pub unsafe fn set_detached_content(&self, detached_content: &CFData) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderSetDetachedContent(
                cms_decoder: &CMSDecoder,
                detached_content: &CFData,
            ) -> OSStatus;
        }
        unsafe { CMSDecoderSetDetachedContent(self, detached_content) }
    }

    /// Obtains the detached content specified with the `CMSDecoderSetDetachedContent` function.
    ///
    /// Parameters:
    /// - cmsDecoder: The CMSDecoder reference returned by the `CMSDecoderCreate` function.
    ///
    /// - detachedContentOut: On return, points to the data reference specified by an earlier call to the `CMSDecoderSetDetachedContent` function. Returns a NULL data reference if no detached content has been specified. You must use the `CFRelease` function to free this reference when you are finished using it.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// # Safety
    ///
    /// `detached_content_out` must be a valid pointer.
    #[doc(alias = "CMSDecoderCopyDetachedContent")]
    #[inline]
    pub unsafe fn copy_detached_content(
        &self,
        detached_content_out: NonNull<*const CFData>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderCopyDetachedContent(
                cms_decoder: &CMSDecoder,
                detached_content_out: NonNull<*const CFData>,
            ) -> OSStatus;
        }
        unsafe { CMSDecoderCopyDetachedContent(self, detached_content_out) }
    }

    /// Specifies the keychains to search for intermediate certificates to be used in verifying a signed message’s signer certificates.
    ///
    /// Parameters:
    /// - cmsDecoder: The CMSDecoder reference returned by the `CMSDecoderCreate` function.
    ///
    /// - keychainOrArray: Either a single keychain to search, specified as a keychain object (type `SecKeychainRef`), or a set of keychains specified as a `CFArray` of keychain objects. If you specify an empty `CFArrayRef`, no keychains are searched for intermediate certificates.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// If you don’t call this function, the decoder uses the default keychain search list to search for intermediate certificates.
    ///
    /// If you do call this function, you must call it before you call the `CMSDecoderCopySignerStatus` function.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `keychain_or_array` should be of the correct type.
    #[doc(alias = "CMSDecoderSetSearchKeychain")]
    #[deprecated]
    #[inline]
    pub unsafe fn set_search_keychain(&self, keychain_or_array: &CFType) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderSetSearchKeychain(
                cms_decoder: &CMSDecoder,
                keychain_or_array: &CFType,
            ) -> OSStatus;
        }
        unsafe { CMSDecoderSetSearchKeychain(self, keychain_or_array) }
    }

    /// Obtains the number of signers of a message.
    ///
    /// Parameters:
    /// - cmsDecoder: The CMSDecoder reference returned by the `CMSDecoderCreate` function.
    ///
    /// - numSignersOut: On return, the number of signers of the message. Zero indicates that the message was not signed.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Call the `CMSDecoderCopySignerStatus` function to determine the status of a signature.
    ///
    /// You cannot call this function until after you have called the `CMSDecoderFinalizeMessage` function.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `num_signers_out` must be a valid pointer.
    #[doc(alias = "CMSDecoderGetNumSigners")]
    #[inline]
    pub unsafe fn num_signers(&self, num_signers_out: NonNull<usize>) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderGetNumSigners(
                cms_decoder: &CMSDecoder,
                num_signers_out: NonNull<usize>,
            ) -> OSStatus;
        }
        unsafe { CMSDecoderGetNumSigners(self, num_signers_out) }
    }

    /// Obtains the status of a CMS message’s signature.
    ///
    /// Parameters:
    /// - cmsDecoder: The [`CMSDecoderRef`](https://developer.apple.com/documentation/security/cmsdecoder) reference returned by the [`CMSDecoderCreate`](https://developer.apple.com/documentation/security/cmsdecodercreate(_:)) function.
    ///
    /// - signerIndex: A number indicating which signer to examine. Signer index numbers start with 0. Use the [`CMSDecoderGetNumSigners`](https://developer.apple.com/documentation/security/cmsdecodergetnumsigners(_:_:)) function to determine the total number of signers for a message.
    ///
    /// - policyOrArray: The trust policy or policies to be used to verify the signer’s certificate. You can specify either a single [`SecPolicyRef`](https://developer.apple.com/documentation/security/secpolicy) instance or a [`CFArrayRef`](https://developer.apple.com/documentation/corefoundation/cfarray) of [`SecPolicyRef`](https://developer.apple.com/documentation/security/secpolicy) instances. For more information about policy objects, see [Policies](https://developer.apple.com/documentation/security/policies).
    ///
    /// - evaluateSecTrust: Set to [`true`](https://developer.apple.com/documentation/swift/true) to cause the decoder to call the [`SecTrustEvaluate`](https://developer.apple.com/documentation/security/sectrustevaluate(_:_:)) function to evaluate the [`SecTrustRef`](https://developer.apple.com/documentation/security/sectrust) instance created for the evaluation of the signer certificate. Set to [`false`](https://developer.apple.com/documentation/swift/false) if you intend to call the [`SecTrustEvaluate`](https://developer.apple.com/documentation/security/sectrustevaluate(_:_:)) function for the [`SecTrustRef`](https://developer.apple.com/documentation/security/sectrust) instance returned by the `secTrustOut` parameter.
    ///
    /// - signerStatusOut: If you specify [`true`](https://developer.apple.com/documentation/swift/true) for the `evaluateSecTrust` parameter, on return this parameter indicates the status of the signature. See [`CMSSignerStatus`](https://developer.apple.com/documentation/security/cmssignerstatus) for possible results. Pass in `NULL` if you don’t want a value returned.
    ///
    /// - secTrustOut: On return this parameter points to a [`SecTrustRef`](https://developer.apple.com/documentation/security/sectrust) instance. If you specified [`true`](https://developer.apple.com/documentation/swift/true) for the `evaluateTrust` parameter, this is the trust instance that was used to verify the signer’s certificate. If you specified [`false`](https://developer.apple.com/documentation/swift/false) for the `evaluateTrust` parameter, you can call the [`SecTrustEvaluate`](https://developer.apple.com/documentation/security/sectrustevaluate(_:_:)) function to evaluate the [`SecTrustRef`](https://developer.apple.com/documentation/security/sectrust) instance. Pass `NULL` if you do not want this instance returned. You must use the [`CFRelease`](https://developer.apple.comhttps://developer.apple.com/documentation/corefoundation/1521153-cfrelease) function to free this reference when you are finished using it.
    ///
    /// - certVerifyResultCodeOut: If you specify [`true`](https://developer.apple.com/documentation/swift/true) for the `evaluateSecTrust` parameter, on return this parameter indicates the result of the certificate verification.  Pass in `NULL` if you don’t want a value returned.
    ///
    /// Some of the most common results returned in this parameter include:
    ///
    /// - `CSSMERR_TP_INVALID_ANCHOR_CERT`: The certificate was verified through the certificate chain to a self-signed root certificate that was present in the message, but that root certificate is not a known, trusted root certificate.
    ///
    /// - `CSSMERR_TP_NOT_TRUSTED`: The certificate could not be verified back to a root certificate.
    ///
    /// - `CSSMERR_TP_VERIFICATION_FAILURE`: The root certificate failed verification.
    ///
    /// - `CSSMERR_TP_VERIFY_ACTION_FAILED`: Trust could not be established according to the specified trust policy.
    ///
    /// - `CSSMERR_TP_INVALID_CERTIFICATE`: The signer’s leaf certificate was not valid.
    ///
    /// - `CSSMERR_TP_CERT_EXPIRED`: A certificate in the chain was expired at the time of verification.
    ///
    /// - `CSSMERR_TP_CERT_NOT_VALID_YET`: A certificate in the chain was not yet valid at the time of verification.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). A result of [`errSecSuccess`](https://developer.apple.com/documentation/security/errsecsuccess) indicates only that the function completed successfully; it does not indicate that the signature is verified or the certificates are valid. See the `signerStatusOut` and `certVerifyResultCodeOut` parameters for the verification and certificate validation results.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// You cannot call this function until after you have called the [`CMSDecoderFinalizeMessage`](https://developer.apple.com/documentation/security/cmsdecoderfinalizemessage(_:)) function. Although the message has been fully decoded when the [`CMSDecoderFinalizeMessage`](https://developer.apple.com/documentation/security/cmsdecoderfinalizemessage(_:)) function returns with no error, the signature can’t be validated or certificates verified until this function is called.
    ///
    /// A CMS message can be signed by multiple signers; this function returns the status associated with one signer as specified by the `signerIndex` parameter.
    ///
    /// If you both pass in [`false`](https://developer.apple.com/documentation/swift/false) for the `evaluateSecTrust` parameter and `NULL` for the `secTrustOut` parameter, no evaluation of the signer certificate can occur.
    ///
    ///
    ///
    /// # Safety
    ///
    /// - `policy_or_array` should be of the correct type.
    /// - `signer_status_out` must be a valid pointer or null.
    /// - `sec_trust_out` must be a valid pointer or null.
    /// - `cert_verify_result_code_out` must be a valid pointer or null.
    #[doc(alias = "CMSDecoderCopySignerStatus")]
    #[cfg(feature = "SecTrust")]
    #[inline]
    pub unsafe fn copy_signer_status(
        &self,
        signer_index: usize,
        policy_or_array: &CFType,
        evaluate_sec_trust: bool,
        signer_status_out: *mut CMSSignerStatus,
        sec_trust_out: *mut *mut SecTrust,
        cert_verify_result_code_out: *mut OSStatus,
    ) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderCopySignerStatus(
                cms_decoder: &CMSDecoder,
                signer_index: usize,
                policy_or_array: &CFType,
                evaluate_sec_trust: Boolean,
                signer_status_out: *mut CMSSignerStatus,
                sec_trust_out: *mut *mut SecTrust,
                cert_verify_result_code_out: *mut OSStatus,
            ) -> OSStatus;
        }
        unsafe {
            CMSDecoderCopySignerStatus(
                self,
                signer_index,
                policy_or_array,
                evaluate_sec_trust as _,
                signer_status_out,
                sec_trust_out,
                cert_verify_result_code_out,
            )
        }
    }

    /// Obtains the email address of the specified signer of a CMS message.
    ///
    /// Parameters:
    /// - cmsDecoder: The CMSDecoder reference returned by the `CMSDecoderCreate` function.
    ///
    /// - signerIndex: A number indicating which signer’s email address to return. Signer index numbers start with 0. Use the [`CMSDecoderGetNumSigners`](https://developer.apple.com/documentation/security/cmsdecodergetnumsigners(_:_:)) function to determine the total number of signers for a message.
    ///
    /// - signerEmailAddressOut: On return, points to the email address of the specified signer.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). Returns [`errSecParam`](https://developer.apple.com/documentation/security/errsecparam) if the CMS message was not signed or if `signerIndex` is greater than the number of signers of the message minus one (`signerIndex > (numSigners – 1)`).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// You cannot call this function until after you have called the [`CMSDecoderFinalizeMessage`](https://developer.apple.com/documentation/security/cmsdecoderfinalizemessage(_:)) function.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `signer_email_address_out` must be a valid pointer.
    #[doc(alias = "CMSDecoderCopySignerEmailAddress")]
    #[inline]
    pub unsafe fn copy_signer_email_address(
        &self,
        signer_index: usize,
        signer_email_address_out: NonNull<*const CFString>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderCopySignerEmailAddress(
                cms_decoder: &CMSDecoder,
                signer_index: usize,
                signer_email_address_out: NonNull<*const CFString>,
            ) -> OSStatus;
        }
        unsafe { CMSDecoderCopySignerEmailAddress(self, signer_index, signer_email_address_out) }
    }

    /// Obtains the certificate of the specified signer of a CMS message.
    ///
    /// Parameters:
    /// - cmsDecoder: The CMSDecoder reference returned by the `CMSDecoderCreate` function.
    ///
    /// - signerIndex: A number indicating which signer’s email address to return. Signer index numbers start with 0. Use the [`CMSDecoderGetNumSigners`](https://developer.apple.com/documentation/security/cmsdecodergetnumsigners(_:_:)) function to determine the total number of signers for a message.
    ///
    /// - signerCertOut: On return, points to the certificate of the specified signer.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). Returns [`errSecParam`](https://developer.apple.com/documentation/security/errsecparam) if the CMS message was not signed or if `signerIndex` is greater than the number of signers of the message minus one (signerIndex > (numSigners – 1)).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// You cannot call this function until after you have called the [`CMSDecoderFinalizeMessage`](https://developer.apple.com/documentation/security/cmsdecoderfinalizemessage(_:)) function.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `signer_cert_out` must be a valid pointer.
    #[doc(alias = "CMSDecoderCopySignerCert")]
    #[cfg(feature = "SecBase")]
    #[inline]
    pub unsafe fn copy_signer_cert(
        &self,
        signer_index: usize,
        signer_cert_out: NonNull<*mut SecCertificate>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderCopySignerCert(
                cms_decoder: &CMSDecoder,
                signer_index: usize,
                signer_cert_out: NonNull<*mut SecCertificate>,
            ) -> OSStatus;
        }
        unsafe { CMSDecoderCopySignerCert(self, signer_index, signer_cert_out) }
    }

    /// Determines whether a CMS message was encrypted.
    ///
    /// Parameters:
    /// - cmsDecoder: The CMSDecoder reference returned by the `CMSDecoderCreate` function.
    ///
    /// - isEncryptedOut: Returns `TRUE` if the message was encrypted.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Note that if the message was encrypted and the decoding succeeded (`CMSDecoderFinalizeMessage` returned `noErr`), then the message was successfully decrypted. Call [`CMSDecoderCopyContent`](https://developer.apple.com/documentation/security/cmsdecodercopycontent(_:_:)) to retrieve the decrypted content.
    ///
    /// You cannot call this function until after you have called the `CMSDecoderFinalizeMessage` function.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `is_encrypted_out` must be a valid pointer.
    #[doc(alias = "CMSDecoderIsContentEncrypted")]
    #[inline]
    pub unsafe fn is_content_encrypted(&self, is_encrypted_out: NonNull<Boolean>) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderIsContentEncrypted(
                cms_decoder: &CMSDecoder,
                is_encrypted_out: NonNull<Boolean>,
            ) -> OSStatus;
        }
        unsafe { CMSDecoderIsContentEncrypted(self, is_encrypted_out) }
    }

    /// Obtains the object identifier for the encapsulated data of a signed message.
    ///
    /// Parameters:
    /// - cmsDecoder: The CMSDecoder reference returned by the `CMSDecoderCreate` function.
    ///
    /// - eContentTypeOut: On return, the object identifier for the encapsulated data in a signed message.  Returns `NULL` if the message was not signed.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// In a signed message, the signed data consists of any type of content (referred to as the _encapsulated content_, because it is encapsulated in the signed data) plus the signature values. The content type of the encapsulated data is indicated by an object identifier. The default value for the OID is `id-data`, which indicates MIME-encoded content.
    ///
    /// You cannot call this function until after you have called the `CMSDecoderFinalizeMessage` function.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `e_content_type_out` must be a valid pointer.
    #[doc(alias = "CMSDecoderCopyEncapsulatedContentType")]
    #[inline]
    pub unsafe fn copy_encapsulated_content_type(
        &self,
        e_content_type_out: NonNull<*const CFData>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderCopyEncapsulatedContentType(
                cms_decoder: &CMSDecoder,
                e_content_type_out: NonNull<*const CFData>,
            ) -> OSStatus;
        }
        unsafe { CMSDecoderCopyEncapsulatedContentType(self, e_content_type_out) }
    }

    /// Obtains an array of all of the certificates in a message.
    ///
    /// Parameters:
    /// - cmsDecoder: The CMSDecoder reference returned by the `CMSDecoderCreate` function.
    ///
    /// - certsOut: On return, points to an array of `SecCertificateRef` objects. Returns `NULL` if the message does not contain any certificates (the message was encrypted but not signed); this is not considered an error. You must use the `CFRelease` function to free this reference when you are finished using it.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// A CMS message can contain arbitrary sets of certificates other than or in addition to those indicating the identity of signers. You can use this function to retrieve such certificates from a message. If the message was signed, it contains signer certificates. You can use the [`CMSDecoderGetNumSigners`](https://developer.apple.com/documentation/security/cmsdecodergetnumsigners(_:_:)) and [`CMSDecoderCopySignerCert`](https://developer.apple.com/documentation/security/cmsdecodercopysignercert(_:_:_:)) functions to retrieve the certificates for a specific signer.
    ///
    /// You cannot call this function until after you have called the [`CMSDecoderFinalizeMessage`](https://developer.apple.com/documentation/security/cmsdecoderfinalizemessage(_:)) function.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `certs_out` must be a valid pointer.
    #[doc(alias = "CMSDecoderCopyAllCerts")]
    #[inline]
    pub unsafe fn copy_all_certs(&self, certs_out: NonNull<*const CFArray>) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderCopyAllCerts(
                cms_decoder: &CMSDecoder,
                certs_out: NonNull<*const CFArray>,
            ) -> OSStatus;
        }
        unsafe { CMSDecoderCopyAllCerts(self, certs_out) }
    }

    /// Obtains the message content, if any.
    ///
    /// Parameters:
    /// - cmsDecoder: The CMSDecoder reference returned by the `CMSDecoderCreate` function.
    ///
    /// - contentOut: On return, points to the message’s content. Returns `NULL` if the content is detached. You must use the `CFRelease` function to free this reference when you are finished using it.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// If the message has detached content, you are responsible for retrieving the content. In that case, you use the [`CMSDecoderSetDetachedContent`](https://developer.apple.com/documentation/security/cmsdecodersetdetachedcontent(_:_:)) function to tell the decoder the location of the content.
    ///
    /// You cannot call this function until after you have called the `CMSDecoderFinalizeMessage` function.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `content_out` must be a valid pointer.
    #[doc(alias = "CMSDecoderCopyContent")]
    #[inline]
    pub unsafe fn copy_content(&self, content_out: NonNull<*const CFData>) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderCopyContent(
                cms_decoder: &CMSDecoder,
                content_out: NonNull<*const CFData>,
            ) -> OSStatus;
        }
        unsafe { CMSDecoderCopyContent(self, content_out) }
    }

    /// Obtains the signing time of a CMS message, if present.
    ///
    /// Parameters:
    /// - cmsDecoder: A CMSDecoder reference returned by the `CMSDecoderCreate` function.
    ///
    /// - signerIndex: A number indicating which signer to examine. Signer index numbers start with 0. Use the [`CMSDecoderGetNumSigners`](https://developer.apple.com/documentation/security/cmsdecodergetnumsigners(_:_:)) function to determine the total number of signers for a message.
    ///
    /// - signingTime: The address of an absolute time value where the result should be stored.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). Typically, this function returns [`errSecParam`](https://developer.apple.com/documentation/security/errsecparam) if the CMS message was not signed or if `signerIndex` is out of bounds.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// The timestamp is an unauthenticated time, although it is part of the signed attributes of the message.
    ///
    /// You must call [`CMSDecoderFinalizeMessage`](https://developer.apple.com/documentation/security/cmsdecoderfinalizemessage(_:)) before you call this function.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `signing_time` must be a valid pointer.
    #[doc(alias = "CMSDecoderCopySignerSigningTime")]
    #[inline]
    pub unsafe fn copy_signer_signing_time(
        &self,
        signer_index: usize,
        signing_time: NonNull<CFAbsoluteTime>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderCopySignerSigningTime(
                cms_decoder: &CMSDecoder,
                signer_index: usize,
                signing_time: NonNull<CFAbsoluteTime>,
            ) -> OSStatus;
        }
        unsafe { CMSDecoderCopySignerSigningTime(self, signer_index, signing_time) }
    }

    /// Returns the timestamp of a signer of a CMS message, if present.
    ///
    /// Parameters:
    /// - cmsDecoder: A CMSDecoder reference returned by the `CMSDecoderCreate` function.
    ///
    /// - signerIndex: A number indicating which signer to examine. Signer index numbers start with 0. Use the [`CMSDecoderGetNumSigners`](https://developer.apple.com/documentation/security/cmsdecodergetnumsigners(_:_:)) function to determine the total number of signers for a message.
    ///
    /// - timestamp: The address of an absolute time value where the result should be stored.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). Typically, this function returns [`errSecParam`](https://developer.apple.com/documentation/security/errsecparam) if the CMS message was not signed or if `signerIndex` is out of bounds.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// This timestamp is an authenticated timestamp provided by a time stamping authority.
    ///
    /// You must call [`CMSDecoderFinalizeMessage`](https://developer.apple.com/documentation/security/cmsdecoderfinalizemessage(_:)) before you call this function.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `timestamp` must be a valid pointer.
    #[doc(alias = "CMSDecoderCopySignerTimestamp")]
    #[inline]
    pub unsafe fn copy_signer_timestamp(
        &self,
        signer_index: usize,
        timestamp: NonNull<CFAbsoluteTime>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderCopySignerTimestamp(
                cms_decoder: &CMSDecoder,
                signer_index: usize,
                timestamp: NonNull<CFAbsoluteTime>,
            ) -> OSStatus;
        }
        unsafe { CMSDecoderCopySignerTimestamp(self, signer_index, timestamp) }
    }

    /// Returns the timestamp of a signer of a CMS message using a given policy, if present.
    ///
    /// Parameters:
    /// - cmsDecoder: A CMSDecoder reference returned by the [`CMSDecoderCreate`](https://developer.apple.com/documentation/security/cmsdecodercreate(_:)) function.
    ///
    /// - timeStampPolicy: A timestamp policy. Specify `NULL` (or use the [`CMSDecoderCopySignerTimestamp`](https://developer.apple.com/documentation/security/cmsdecodercopysignertimestamp(_:_:_:)) function instead) to get the default, which is a policy using [`kSecPolicyAppleTimeStamping`](https://developer.apple.com/documentation/security/ksecpolicyappletimestamping). See [Policies](https://developer.apple.com/documentation/security/policies) in [Certificate, Key, and Trust Services](https://developer.apple.com/documentation/security/certificate-key-and-trust-services) for more about policies.
    ///
    /// - signerIndex: A number indicating which signer to examine. Signer index numbers start with 0. Use the [`CMSDecoderGetNumSigners`](https://developer.apple.com/documentation/security/cmsdecodergetnumsigners(_:_:)) function to determine the total number of signers for a message.
    ///
    /// - timestamp: The address of an absolute time value where the result should be stored.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// # Safety
    ///
    /// - `time_stamp_policy` should be of the correct type.
    /// - `timestamp` must be a valid pointer.
    #[doc(alias = "CMSDecoderCopySignerTimestampWithPolicy")]
    #[inline]
    pub unsafe fn copy_signer_timestamp_with_policy(
        &self,
        time_stamp_policy: Option<&CFType>,
        signer_index: usize,
        timestamp: NonNull<CFAbsoluteTime>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderCopySignerTimestampWithPolicy(
                cms_decoder: &CMSDecoder,
                time_stamp_policy: Option<&CFType>,
                signer_index: usize,
                timestamp: NonNull<CFAbsoluteTime>,
            ) -> OSStatus;
        }
        unsafe {
            CMSDecoderCopySignerTimestampWithPolicy(
                self,
                time_stamp_policy,
                signer_index,
                timestamp,
            )
        }
    }

    /// Returns an array containing the certificates from a timestamp response.
    ///
    /// Parameters:
    /// - cmsDecoder: A CMSDecoder reference returned by the `CMSDecoderCreate` function.
    ///
    /// - signerIndex: A number indicating which signer to examine. Signer index numbers start with 0. Use the [`CMSDecoderGetNumSigners`](https://developer.apple.com/documentation/security/cmsdecodergetnumsigners(_:_:)) function to determine the total number of signers for a message.
    ///
    /// - certificateRefs: The address of a Core Foundation array reference where the resulting array should be stored.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). Typically, this function returns [`errSecParam`](https://developer.apple.com/documentation/security/errsecparam) if the CMS message was not signed or `signerIndex` is out of bounds, and returns [`errSecItemNotFound`](https://developer.apple.com/documentation/security/errsecitemnotfound) if no certificates were found.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// The signature must contain an authenticated timestamp provided by a time stamping authority. Elements of the returned array are of type `SecCertificateRef`. The caller is responsible for releasing the returned array by calling `CFRelease`.
    ///
    /// You must call [`CMSDecoderFinalizeMessage`](https://developer.apple.com/documentation/security/cmsdecoderfinalizemessage(_:)) before you call this function.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `certificate_refs` must be a valid pointer.
    #[doc(alias = "CMSDecoderCopySignerTimestampCertificates")]
    #[inline]
    pub unsafe fn copy_signer_timestamp_certificates(
        &self,
        signer_index: usize,
        certificate_refs: NonNull<*const CFArray>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn CMSDecoderCopySignerTimestampCertificates(
                cms_decoder: &CMSDecoder,
                signer_index: usize,
                certificate_refs: NonNull<*const CFArray>,
            ) -> OSStatus;
        }
        unsafe { CMSDecoderCopySignerTimestampCertificates(self, signer_index, certificate_refs) }
    }
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::create`"]
    pub fn CMSDecoderCreate(cms_decoder_out: NonNull<*mut CMSDecoder>) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::update_message`"]
    pub fn CMSDecoderUpdateMessage(
        cms_decoder: &CMSDecoder,
        msg_bytes: NonNull<c_void>,
        msg_bytes_len: usize,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::finalize_message`"]
    pub fn CMSDecoderFinalizeMessage(cms_decoder: &CMSDecoder) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::set_detached_content`"]
    pub fn CMSDecoderSetDetachedContent(
        cms_decoder: &CMSDecoder,
        detached_content: &CFData,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::copy_detached_content`"]
    pub fn CMSDecoderCopyDetachedContent(
        cms_decoder: &CMSDecoder,
        detached_content_out: NonNull<*const CFData>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::set_search_keychain`"]
    pub fn CMSDecoderSetSearchKeychain(
        cms_decoder: &CMSDecoder,
        keychain_or_array: &CFType,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::num_signers`"]
    pub fn CMSDecoderGetNumSigners(
        cms_decoder: &CMSDecoder,
        num_signers_out: NonNull<usize>,
    ) -> OSStatus;
}

#[cfg(feature = "SecTrust")]
#[deprecated = "renamed to `CMSDecoder::copy_signer_status`"]
#[inline]
pub unsafe extern "C-unwind" fn CMSDecoderCopySignerStatus(
    cms_decoder: &CMSDecoder,
    signer_index: usize,
    policy_or_array: &CFType,
    evaluate_sec_trust: bool,
    signer_status_out: *mut CMSSignerStatus,
    sec_trust_out: *mut *mut SecTrust,
    cert_verify_result_code_out: *mut OSStatus,
) -> OSStatus {
    extern "C-unwind" {
        fn CMSDecoderCopySignerStatus(
            cms_decoder: &CMSDecoder,
            signer_index: usize,
            policy_or_array: &CFType,
            evaluate_sec_trust: Boolean,
            signer_status_out: *mut CMSSignerStatus,
            sec_trust_out: *mut *mut SecTrust,
            cert_verify_result_code_out: *mut OSStatus,
        ) -> OSStatus;
    }
    unsafe {
        CMSDecoderCopySignerStatus(
            cms_decoder,
            signer_index,
            policy_or_array,
            evaluate_sec_trust as _,
            signer_status_out,
            sec_trust_out,
            cert_verify_result_code_out,
        )
    }
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::copy_signer_email_address`"]
    pub fn CMSDecoderCopySignerEmailAddress(
        cms_decoder: &CMSDecoder,
        signer_index: usize,
        signer_email_address_out: NonNull<*const CFString>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `CMSDecoder::copy_signer_cert`"]
    pub fn CMSDecoderCopySignerCert(
        cms_decoder: &CMSDecoder,
        signer_index: usize,
        signer_cert_out: NonNull<*mut SecCertificate>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::is_content_encrypted`"]
    pub fn CMSDecoderIsContentEncrypted(
        cms_decoder: &CMSDecoder,
        is_encrypted_out: NonNull<Boolean>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::copy_encapsulated_content_type`"]
    pub fn CMSDecoderCopyEncapsulatedContentType(
        cms_decoder: &CMSDecoder,
        e_content_type_out: NonNull<*const CFData>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::copy_all_certs`"]
    pub fn CMSDecoderCopyAllCerts(
        cms_decoder: &CMSDecoder,
        certs_out: NonNull<*const CFArray>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::copy_content`"]
    pub fn CMSDecoderCopyContent(
        cms_decoder: &CMSDecoder,
        content_out: NonNull<*const CFData>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::copy_signer_signing_time`"]
    pub fn CMSDecoderCopySignerSigningTime(
        cms_decoder: &CMSDecoder,
        signer_index: usize,
        signing_time: NonNull<CFAbsoluteTime>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::copy_signer_timestamp`"]
    pub fn CMSDecoderCopySignerTimestamp(
        cms_decoder: &CMSDecoder,
        signer_index: usize,
        timestamp: NonNull<CFAbsoluteTime>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::copy_signer_timestamp_with_policy`"]
    pub fn CMSDecoderCopySignerTimestampWithPolicy(
        cms_decoder: &CMSDecoder,
        time_stamp_policy: Option<&CFType>,
        signer_index: usize,
        timestamp: NonNull<CFAbsoluteTime>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CMSDecoder::copy_signer_timestamp_certificates`"]
    pub fn CMSDecoderCopySignerTimestampCertificates(
        cms_decoder: &CMSDecoder,
        signer_index: usize,
        certificate_refs: NonNull<*const CFArray>,
    ) -> OSStatus;
}
