//! This file has been automatically generated by `objc2`'s `header-translator`.
//! DO NOT EDIT
use core::ptr::NonNull;
#[cfg(feature = "objc2")]
use objc2::__framework_prelude::*;
use objc2_core_foundation::*;

use crate::*;

/// Allowed uses for the encryption key in a certificate.
// NS_OPTIONS
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord, Default)]
pub struct SecTrustSettingsKeyUsage(pub u32);
bitflags::bitflags! {
    impl SecTrustSettingsKeyUsage: u32 {
/// The key can be used to sign data or verify a signature.
        #[doc(alias = "kSecTrustSettingsKeyUseSignature")]
        const UseSignature = 0x00000001;
/// The key can be used to encrypt or decrypt data.
        #[doc(alias = "kSecTrustSettingsKeyUseEnDecryptData")]
        const UseEnDecryptData = 0x00000002;
/// The key can be used to encrypt or decrypt (wrap or unwrap) a key.
///
/// ## Discussion
///
/// Private keys must be wrapped before they can be exported from a keychain.
///
///
        #[doc(alias = "kSecTrustSettingsKeyUseEnDecryptKey")]
        const UseEnDecryptKey = 0x00000004;
/// The key can be used to sign a certificate or verify a signature.
        #[doc(alias = "kSecTrustSettingsKeyUseSignCert")]
        const UseSignCert = 0x00000008;
/// The key can be used to sign an OCSP (online certificate status protocol) message or CRL (certificate verification list), or to verify a signature.
///
/// ## Discussion
///
/// OCSP messages and CRLs are used to revoke certificates.
///
///
        #[doc(alias = "kSecTrustSettingsKeyUseSignRevocation")]
        const UseSignRevocation = 0x00000010;
/// The key is a private key that has been shared using a key exchange protocol, such as Diffie-Hellman key exchange.
        #[doc(alias = "kSecTrustSettingsKeyUseKeyExchange")]
        const UseKeyExchange = 0x00000020;
/// The key can be used for any purpose.
///
/// ## Discussion
///
/// This is the default key-use setting if no other key use is specified.
///
///
        #[doc(alias = "kSecTrustSettingsKeyUseAny")]
        const UseAny = 0xffffffff;
    }
}

#[cfg(feature = "objc2")]
unsafe impl Encode for SecTrustSettingsKeyUsage {
    const ENCODING: Encoding = u32::ENCODING;
}

#[cfg(feature = "objc2")]
unsafe impl RefEncode for SecTrustSettingsKeyUsage {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

/// Trust settings returned in usage constraints dictionaries.
///
/// ## Overview
///
/// These values appear in the usage constraints dictionaries returned by the [`SecTrustSettingsCopyTrustSettings`](https://developer.apple.com/documentation/security/sectrustsettingscopytrustsettings(_:_:_:)) and [`SecTrustSettingsSetTrustSettings`](https://developer.apple.com/documentation/security/sectrustsettingssettrustsettings(_:_:_:)) functions.
///
///
/// Result of a trust settings evaluation.
// NS_ENUM
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord, Default)]
pub struct SecTrustSettingsResult(pub u32);
impl SecTrustSettingsResult {
    /// Never valid in a trust settings array or in an API call.
    #[doc(alias = "kSecTrustSettingsResultInvalid")]
    pub const Invalid: Self = Self(0);
    /// This root certificate is explicitly trusted.
    ///
    /// ## Discussion
    ///
    /// If the certificate is not a root (self-signed) certificate, the usage constraints dictionary is invalid.
    ///
    ///
    #[doc(alias = "kSecTrustSettingsResultTrustRoot")]
    pub const TrustRoot: Self = Self(1);
    /// This non-root certificate is explicitly trusted as if it were a trusted root.
    #[doc(alias = "kSecTrustSettingsResultTrustAsRoot")]
    pub const TrustAsRoot: Self = Self(2);
    /// This certificate is explicitly distrusted.
    #[doc(alias = "kSecTrustSettingsResultDeny")]
    pub const Deny: Self = Self(3);
    /// This certificate is neither trusted nor distrusted. This value can be used to specify an “allowed error” without assigning trust to a specific certificate.
    ///
    /// ## Discussion
    ///
    /// This value can be used to specify an allowed error without assigning trust to the certificate.
    ///
    ///
    #[doc(alias = "kSecTrustSettingsResultUnspecified")]
    pub const Unspecified: Self = Self(4);
}

#[cfg(feature = "objc2")]
unsafe impl Encode for SecTrustSettingsResult {
    const ENCODING: Encoding = u32::ENCODING;
}

#[cfg(feature = "objc2")]
unsafe impl RefEncode for SecTrustSettingsResult {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

/// The trust settings domains.
// NS_ENUM
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord, Default)]
pub struct SecTrustSettingsDomain(pub u32);
impl SecTrustSettingsDomain {
    /// Per-user trust settings.
    #[doc(alias = "kSecTrustSettingsDomainUser")]
    pub const User: Self = Self(0);
    /// Locally administered, system-wide trust settings.
    ///
    /// ## Discussion
    ///
    /// Administrator privileges are required to make changes to this domain.
    ///
    ///
    #[doc(alias = "kSecTrustSettingsDomainAdmin")]
    pub const Admin: Self = Self(1);
    /// System trust settings.
    ///
    /// ## Discussion
    ///
    /// These trust settings are immutable and comprise the set of trusted root certificates supplied in macOS. These settings are read-only, even by root.
    ///
    ///
    #[doc(alias = "kSecTrustSettingsDomainSystem")]
    pub const System: Self = Self(2);
}

#[cfg(feature = "objc2")]
unsafe impl Encode for SecTrustSettingsDomain {
    const ENCODING: Encoding = u32::ENCODING;
}

#[cfg(feature = "objc2")]
unsafe impl RefEncode for SecTrustSettingsDomain {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[cfg(feature = "SecTrust")]
impl SecTrust {
    /// Obtains the trust settings for a certificate.
    ///
    /// Parameters:
    /// - certRef: The certificate for which you want the trust settings. Pass the value [`kSecTrustSettingsDefaultRootCertSetting`](https://developer.apple.com/documentation/security/ksectrustsettingsdefaultrootcertsetting) to obtain the default root certificate trust settings for the domain.
    ///
    /// - domain: The domain from which you want to get trust settings. For possible values, see [`SecTrustSettingsDomain`](https://developer.apple.com/documentation/security/sectrustsettingsdomain).
    ///
    /// - trustSettings: On return, an array of [`CFDictionaryRef`](https://developer.apple.com/documentation/corefoundation/cfdictionary) objects that specify the trust settings for the certificate. For the contents of the dictionaries, see the discussion below. In Objective-C, call the [`CFRelease`](https://developer.apple.comhttps://developer.apple.com/documentation/corefoundation/1521153-cfrelease) function to release this object when you’re finished with it.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). Returns [`errSecItemNotFound`](https://developer.apple.com/documentation/security/errsecitemnotfound) if no trust settings exist for the specified certificate and domain.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// The system expresses each certificate’s trust settings as a [`CFArrayRef`](https://developer.apple.com/documentation/corefoundation/cfarray) that includes any number (including zero) of dictionaries of type [`CFDictionaryRef`](https://developer.apple.com/documentation/corefoundation/cfdictionary), each of which describes one set of usage constraints. Each usage-constraints dictionary may contain any of the following key-value pairs:
    ///
    /// - [`kSecTrustSettingsPolicy`](https://developer.apple.com/documentation/security/ksectrustsettingspolicy): A policy object ([`SecPolicyRef`](https://developer.apple.com/documentation/security/secpolicy)) that specifies the certificate verification policy; for example: TLS or SMIME. Create a policy object using the `SecPolicyCreate` functions; for example, to create a standard TLS verification policy, use [`SecPolicyCreateSSL`](https://developer.apple.com/documentation/security/secpolicycreatessl(_:_:)).
    ///
    /// - [`kSecTrustSettingsApplication`](https://developer.apple.com/documentation/security/ksectrustsettingsapplication): A trusted application reference ([`SecTrustedApplicationRef`](https://developer.apple.com/documentation/security/sectrustedapplication)) for the app that checks the certificate’s trust settings. Use the [`SecTrustedApplicationCreateFromPath`](https://developer.apple.com/documentation/security/sectrustedapplicationcreatefrompath(_:_:)) function to get this reference.
    ///
    /// - [`kSecTrustSettingsPolicyString`](https://developer.apple.com/documentation/security/ksectrustsettingspolicystring): A [`CFStringRef`](https://developer.apple.com/documentation/corefoundation/cfstring) that contains policy-specific data. For an SMIME policy, this string contains an email address. For a TLS policy, it contains a host name.
    ///
    /// - [`kSecTrustSettingsKeyUsage`](https://developer.apple.com/documentation/security/ksectrustsettingskeyusage): A [`CFNumberRef`](https://developer.apple.com/documentation/corefoundation/cfnumber) that contains an `SInt32` value specifying the operations that can use the encryption key in this certificate. For possible values, see [`SecTrustSettingsKeyUsage`](https://developer.apple.com/documentation/security/sectrustsettingskeyusage).
    ///
    /// - [`kSecTrustSettingsResult`](https://developer.apple.com/documentation/security/ksectrustsettingsresult): A `CFNumber` that contains an `SInt32` value indicating the effective trust setting for this usage-constraints dictionary.
    ///
    /// The system includes a usage-constraints dictionary in its evaluation of trust for a certificate only if the policy, application, and key use given in the dictionary match the use for which the system is evaluating the certificate. If this is the case, then the system combines the value of the `kSecTrustSettingsResult` key with the values from other matching dictionaries to determine the overall trust setting for the certificate, using a logical `OR` operation.
    ///
    /// If this key isn’t present, the system assumes a default value of `kSecTrustSettingsResultTrustRoot`. Only a root certificate can have this value; therefore it’s invalid to create a usage-constraints dictionary for a non-root certificate without this key.
    ///
    /// For the possible values for this key, see [`SecTrustSettingsResult`](https://developer.apple.com/documentation/security/sectrustsettingsresult).
    ///
    /// - [`kSecTrustSettingsAllowedError`](https://developer.apple.com/documentation/security/ksectrustsettingsallowederror): A [`CFNumberRef`](https://developer.apple.com/documentation/corefoundation/cfnumber) that contains an `SInt32` value indicating a `CSSM_RETURN` result code. If the system encounters this result code due to an error when it evaluates the trust for a certificate, it ignores the error.
    ///
    /// The system applies this “allowed error” value to the certificate evaluation only if the usage-constraints dictionary meets the criteria described with the `kSecTrustSettingsResult` key. A usage-constraints dictionary with no constraints but with an allowed error value causes the system to always ignore that value when evaluating a certificate.
    ///
    /// The system determines the overall trust settings for a certificate by combining the trust-settings results from all the usage-constraints dictionaries that match the use for which it’s evaluating the certificate. Trust settings for a given use apply if _any_ of the dictionaries in the certificate’s trust-settings array matches the specified use.
    ///
    /// If the value of the [`kSecTrustSettingsResult`](https://developer.apple.com/documentation/security/ksectrustsettingsresult) key is a value other than [`kSecTrustSettingsResultUnspecified`](https://developer.apple.com/documentation/security/sectrustsettingsresult/unspecified) for a usage constraints-dictionary that has no constraints, the system uses the default value [`kSecTrustSettingsResultTrustRoot`](https://developer.apple.com/documentation/security/sectrustsettingsresult/trustroot). To specify a value for the [`kSecTrustSettingsAllowedError`](https://developer.apple.com/documentation/security/ksectrustsettingsallowederror) component without explicitly trusting or distrusting the associated certificate, set the value of the [`kSecTrustSettingsResult`](https://developer.apple.com/documentation/security/ksectrustsettingsresult) key to [`kSecTrustSettingsResultUnspecified`](https://developer.apple.com/documentation/security/sectrustsettingsresult/unspecified).
    ///
    /// The `trustSettings` parameter can return a valid but empty [`CFArrayRef`](https://developer.apple.com/documentation/corefoundation/cfarray). This empty trust-settings array means “always trust this certificate” with an overall trust setting for the certificate of [`kSecTrustSettingsResultTrustRoot`](https://developer.apple.com/documentation/security/sectrustsettingsresult/trustroot). However, an empty trust settings array isn’t the same as no trust settings, where the `trustSettings` parameter returns `NULL`. No trust-settings array means “this certificate must be verifiable using a known trusted certificate”.
    ///
    /// <div class="warning">
    ///
    /// ### Note
    ///  The trust settings result value [`kSecTrustSettingsResultTrustRoot`](https://developer.apple.com/documentation/security/sectrustsettingsresult/trustroot) can only apply to root (self-signed) certificates. It’s an error to apply it to non-root certificates, including implicitly by using an empty trust settings array. Instead, use [`kSecTrustSettingsResultTrustAsRoot`](https://developer.apple.com/documentation/security/sectrustsettingsresult/trustasroot).
    ///
    ///
    ///
    /// </div>
    /// ### Special considerations
    ///
    /// The system authenticates the person before making changes to per-user trust settings. On macOS 11 and later, the system authenticates the person as an administrator before making changes to system-wide trust settings. Therefore, you can only modify trust settings when running in a GUI environment; for example, a launch daemon can’t modify the settings.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `trust_settings` must be a valid pointer.
    #[doc(alias = "SecTrustSettingsCopyTrustSettings")]
    #[cfg(feature = "SecBase")]
    #[inline]
    pub unsafe fn settings_copy_trust_settings(
        cert_ref: &SecCertificate,
        domain: SecTrustSettingsDomain,
        trust_settings: NonNull<*const CFArray>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecTrustSettingsCopyTrustSettings(
                cert_ref: &SecCertificate,
                domain: SecTrustSettingsDomain,
                trust_settings: NonNull<*const CFArray>,
            ) -> OSStatus;
        }
        unsafe { SecTrustSettingsCopyTrustSettings(cert_ref, domain, trust_settings) }
    }

    /// Specifies trust settings for a certificate.
    ///
    /// Parameters:
    /// - certRef: The certificate for which you want to specify the trust settings. Pass the value [`kSecTrustSettingsDefaultRootCertSetting`](https://developer.apple.com/documentation/security/ksectrustsettingsdefaultrootcertsetting) to set the default root certificate trust settings for the domain.
    ///
    /// - domain: The trust settings domain of the trust settings that you wish to specify.  For possible values, see [`SecTrustSettingsDomain`](https://developer.apple.com/documentation/security/sectrustsettingsdomain).
    ///
    /// - trustSettingsDictOrArray: The trust settings you wish to specify for this certificate, in the form of a `CFDictionary` object, a `CFArray` of `CFDictionary` objects, or `NULL`. The contents of `CFDictionary` objects used to specify trust settings are detailed in the [`SecTrustSettingsCopyTrustSettings`](https://developer.apple.com/documentation/security/sectrustsettingscopytrustsettings(_:_:_:)) function description. Pass `NULL` if you want to specify an empty trust settings array.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// If you pass `NULL` for the `trustSettingsDictOrArray` parameter, then the trust settings for this certificate are stored as an empty trust settings array, indicating “always trust this root certificate regardless of use.” This setting is valid only for a self-signed (root) certificate. To instead remove all trust settings for the certificate (interpreted as “this certificate must be verified to a known trusted certificate”), use the [`SecTrustSettingsRemoveTrustSettings`](https://developer.apple.com/documentation/security/sectrustsettingsremovetrustsettings(_:_:)) function.
    ///
    /// If the specified certificate already has trust settings in the specified domain, this function replaces them.
    ///
    /// ### Special Considerations
    ///
    /// When making changes to per-user trust settings, the user is prompted with an alert panel asking for authentication (user name and password or other credentials normally used for login). Therefore, it is not possible to modify per-user trust settings when not running in a GUI environment (that is, when the user is not logged in via the login window). When making changes to system-wide trust settings, the user is prompted with an alert panel asking for an administrator’s name and password unless the calling process is running as root, in which case no further authentication is needed. Note that this function might block while waiting for user input.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `trust_settings_dict_or_array` should be of the correct type.
    #[doc(alias = "SecTrustSettingsSetTrustSettings")]
    #[cfg(feature = "SecBase")]
    #[inline]
    pub unsafe fn settings_set_trust_settings(
        cert_ref: &SecCertificate,
        domain: SecTrustSettingsDomain,
        trust_settings_dict_or_array: Option<&CFType>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecTrustSettingsSetTrustSettings(
                cert_ref: &SecCertificate,
                domain: SecTrustSettingsDomain,
                trust_settings_dict_or_array: Option<&CFType>,
            ) -> OSStatus;
        }
        unsafe { SecTrustSettingsSetTrustSettings(cert_ref, domain, trust_settings_dict_or_array) }
    }

    /// Deletes the trust settings for a certificate.
    ///
    /// Parameters:
    /// - certRef: The certificate whose trust settings you wish to remove. Pass the value [`kSecTrustSettingsDefaultRootCertSetting`](https://developer.apple.com/documentation/security/ksectrustsettingsdefaultrootcertsetting) to remove the default root certificate trust settings for the domain.
    ///
    /// - domain: The trust settings domain for which you wish to remove the trust settings. For possible values, see [`SecTrustSettingsDomain`](https://developer.apple.com/documentation/security/sectrustsettingsdomain).
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). Returns [`errSecItemNotFound`](https://developer.apple.com/documentation/security/errsecitemnotfound) if no trust settings exist for the certificate.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// If a certificate has no trust settings, the certificate must be verified to a known, trusted certificate.
    ///
    ///
    #[doc(alias = "SecTrustSettingsRemoveTrustSettings")]
    #[cfg(feature = "SecBase")]
    #[inline]
    pub unsafe fn settings_remove_trust_settings(
        cert_ref: &SecCertificate,
        domain: SecTrustSettingsDomain,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecTrustSettingsRemoveTrustSettings(
                cert_ref: &SecCertificate,
                domain: SecTrustSettingsDomain,
            ) -> OSStatus;
        }
        unsafe { SecTrustSettingsRemoveTrustSettings(cert_ref, domain) }
    }

    /// Obtains an array of all certificates that have trust settings in a specific trust settings domain.
    ///
    /// Parameters:
    /// - domain: The trust settings domain for which you want a list of certificates. For possible values, see [`SecTrustSettingsDomain`](https://developer.apple.com/documentation/security/sectrustsettingsdomain).
    ///
    /// - certArray: On return, an array of `SecCertificateRef` objects representing the certificates that have trust settings in the specified domain. In Objective-C, call the [`CFRelease`](https://developer.apple.comhttps://developer.apple.com/documentation/corefoundation/1521153-cfrelease) function to release this object when you are finished with it.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). Returns [`errSecNoTrustSettings`](https://developer.apple.com/documentation/security/errsecnotrustsettings) if no trust settings exist for the specified domain.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `cert_array` must be a valid pointer or null.
    #[doc(alias = "SecTrustSettingsCopyCertificates")]
    #[inline]
    pub unsafe fn settings_copy_certificates(
        domain: SecTrustSettingsDomain,
        cert_array: *mut *const CFArray,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecTrustSettingsCopyCertificates(
                domain: SecTrustSettingsDomain,
                cert_array: *mut *const CFArray,
            ) -> OSStatus;
        }
        unsafe { SecTrustSettingsCopyCertificates(domain, cert_array) }
    }

    /// Obtains the date and time at which a certificate’s trust settings were last modified.
    ///
    /// Parameters:
    /// - certRef: The certificate for which you wish to obtain the modification time. Pass the value `kSecTrustSettingsDefaultRootCertSetting` to obtain the modification time for the default root certificate trust settings for the domain.
    ///
    /// - domain: The trust settings domain of the trust settings for which you wish to obtain the modification time (it’s possible for a single certificate to have trust settings in more than one domain). For possible values, see [`SecTrustSettingsDomain`](https://developer.apple.com/documentation/security/sectrustsettingsdomain).
    ///
    /// - modificationDate: On return, the date and time at which the certificate’s trust settings were last modified. In Objective-C, call the [`CFRelease`](https://developer.apple.comhttps://developer.apple.com/documentation/corefoundation/1521153-cfrelease) function to release this object when you are finished with it.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). Returns [`errSecItemNotFound`](https://developer.apple.com/documentation/security/errsecitemnotfound) if no trust settings exist for the specified certificate and domain.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `modification_date` must be a valid pointer.
    #[doc(alias = "SecTrustSettingsCopyModificationDate")]
    #[cfg(feature = "SecBase")]
    #[inline]
    pub unsafe fn settings_copy_modification_date(
        cert_ref: &SecCertificate,
        domain: SecTrustSettingsDomain,
        modification_date: NonNull<*const CFDate>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecTrustSettingsCopyModificationDate(
                cert_ref: &SecCertificate,
                domain: SecTrustSettingsDomain,
                modification_date: NonNull<*const CFDate>,
            ) -> OSStatus;
        }
        unsafe { SecTrustSettingsCopyModificationDate(cert_ref, domain, modification_date) }
    }

    /// Obtains an external, portable representation of the specified domain’s trust settings.
    ///
    /// Parameters:
    /// - domain: The trust settings domain for which you want an external representation of trust settings. For possible values, see [`SecTrustSettingsDomain`](https://developer.apple.com/documentation/security/sectrustsettingsdomain).
    ///
    /// - trustSettings: An external representation of the domain’s trust settings. In Objective-C, call the [`CFRelease`](https://developer.apple.comhttps://developer.apple.com/documentation/corefoundation/1521153-cfrelease) function to release this object when you are finished with it.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes). Returns [`errSecNoTrustSettings`](https://developer.apple.com/documentation/security/errsecnotrustsettings) if no trust settings exist for the specified domain.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Trust settings for a certificate are associated with the hash of the certificate. Whenever the system encounters a certificate with the hash value associated with the trust settings, it applies those trust settings to the certificate. This function allows you to export trust settings to a portable data format that can subsequently be imported on another machine. You can use this ability, for example, to clone trust settings to all the machines within an enterprise or university.
    ///
    ///
    ///
    /// # Safety
    ///
    /// `trust_settings` must be a valid pointer.
    #[doc(alias = "SecTrustSettingsCreateExternalRepresentation")]
    #[inline]
    pub unsafe fn settings_create_external_representation(
        domain: SecTrustSettingsDomain,
        trust_settings: NonNull<*const CFData>,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecTrustSettingsCreateExternalRepresentation(
                domain: SecTrustSettingsDomain,
                trust_settings: NonNull<*const CFData>,
            ) -> OSStatus;
        }
        unsafe { SecTrustSettingsCreateExternalRepresentation(domain, trust_settings) }
    }

    /// Imports trust settings into a trust domain.
    ///
    /// Parameters:
    /// - domain: The trust settings domain into which you want to import trust settings. For possible values, see [`SecTrustSettingsDomain`](https://developer.apple.com/documentation/security/sectrustsettingsdomain).
    ///
    /// - trustSettings: An external representation of the trust settings (created by the [`SecTrustSettingsCreateExternalRepresentation`](https://developer.apple.com/documentation/security/sectrustsettingscreateexternalrepresentation(_:_:)) function) that you want to import.
    ///
    ///
    /// ## Return Value
    ///
    /// A result code. See [Security Framework Result Codes](https://developer.apple.com/documentation/security/security-framework-result-codes).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Trust settings for a certificate are associated with the hash of the certificate. Whenever the system encounters a certificate with the hash value associated with the trust settings, it applies those trust settings to the certificate. This function allows you to import trust settings in a portable data format that was exported from another machine. You can use this ability, for example, to clone trust settings to all the machines within an enterprise or university.
    ///
    ///
    #[doc(alias = "SecTrustSettingsImportExternalRepresentation")]
    #[inline]
    pub unsafe fn settings_import_external_representation(
        domain: SecTrustSettingsDomain,
        trust_settings: &CFData,
    ) -> OSStatus {
        extern "C-unwind" {
            fn SecTrustSettingsImportExternalRepresentation(
                domain: SecTrustSettingsDomain,
                trust_settings: &CFData,
            ) -> OSStatus;
        }
        unsafe { SecTrustSettingsImportExternalRepresentation(domain, trust_settings) }
    }
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecTrust::settings_copy_trust_settings`"]
    pub fn SecTrustSettingsCopyTrustSettings(
        cert_ref: &SecCertificate,
        domain: SecTrustSettingsDomain,
        trust_settings: NonNull<*const CFArray>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecTrust::settings_set_trust_settings`"]
    pub fn SecTrustSettingsSetTrustSettings(
        cert_ref: &SecCertificate,
        domain: SecTrustSettingsDomain,
        trust_settings_dict_or_array: Option<&CFType>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecTrust::settings_remove_trust_settings`"]
    pub fn SecTrustSettingsRemoveTrustSettings(
        cert_ref: &SecCertificate,
        domain: SecTrustSettingsDomain,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `SecTrust::settings_copy_certificates`"]
    pub fn SecTrustSettingsCopyCertificates(
        domain: SecTrustSettingsDomain,
        cert_array: *mut *const CFArray,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[cfg(feature = "SecBase")]
    #[deprecated = "renamed to `SecTrust::settings_copy_modification_date`"]
    pub fn SecTrustSettingsCopyModificationDate(
        cert_ref: &SecCertificate,
        domain: SecTrustSettingsDomain,
        modification_date: NonNull<*const CFDate>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `SecTrust::settings_create_external_representation`"]
    pub fn SecTrustSettingsCreateExternalRepresentation(
        domain: SecTrustSettingsDomain,
        trust_settings: NonNull<*const CFData>,
    ) -> OSStatus;
}

extern "C-unwind" {
    #[deprecated = "renamed to `SecTrust::settings_import_external_representation`"]
    pub fn SecTrustSettingsImportExternalRepresentation(
        domain: SecTrustSettingsDomain,
        trust_settings: &CFData,
    ) -> OSStatus;
}
