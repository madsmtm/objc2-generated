//! This file has been automatically generated by `objc2`'s `header-translator`.
//! DO NOT EDIT
use core::ffi::*;
use core::ptr::NonNull;
use objc2::__framework_prelude::*;
use objc2_foundation::*;

use crate::*;

/// The possible home-access states.
///
/// ## Overview
///
/// Inspect the home manager’s [`authorizationStatus`](https://developer.apple.com/documentation/homekit/hmhomemanager/authorizationstatus) property for one or more of the bits defined by [`HMHomeManagerAuthorizationStatus`](https://developer.apple.com/documentation/homekit/hmhomemanagerauthorizationstatus).
///
///
/// The home data authorization status of the client process.
// NS_OPTIONS
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord, Default)]
pub struct HMHomeManagerAuthorizationStatus(pub NSUInteger);
bitflags::bitflags! {
    impl HMHomeManagerAuthorizationStatus: NSUInteger {
/// The user has set the app’s level of access to home data.
        #[doc(alias = "HMHomeManagerAuthorizationStatusDetermined")]
        const Determined = 1<<0;
/// The app doesn’t have access to home data.
        #[doc(alias = "HMHomeManagerAuthorizationStatusRestricted")]
        const Restricted = 1<<1;
/// The app has access to home data.
        #[doc(alias = "HMHomeManagerAuthorizationStatusAuthorized")]
        const Authorized = 1<<2;
    }
}

unsafe impl Encode for HMHomeManagerAuthorizationStatus {
    const ENCODING: Encoding = NSUInteger::ENCODING;
}

unsafe impl RefEncode for HMHomeManagerAuthorizationStatus {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

extern_class!(
    /// The manager for a collection of one or more of a user’s homes.
    ///
    /// ## Overview
    ///
    /// HomeKit stores the user’s home automation information in a database that’s shared among Apple’s built-in iOS Home app, your HomeKit-enabled app, and apps from other developers. All these apps access the database as peers using the HomeKit framework.
    ///
    ///
    /// <picture>
    ///     <source media="(prefers-color-scheme: dark)" srcset="https://docs-assets.developer.apple.com/published/4dcf3b55a0525bee421c436bce74817c/media-3111423~dark%402x.png 2x" />
    ///     <source media="(prefers-color-scheme: light)" srcset="https://docs-assets.developer.apple.com/published/1d1af3529d72cebfde9b21706f91cb43/media-3111423%402x.png 2x" />
    ///     <img alt="Diagram showing how different apps use HomeKit to access the shared HomeKit database." src="https://docs-assets.developer.apple.com/published/4dcf3b55a0525bee421c436bce74817c/media-3111423~dark%402x.png" />
    /// </picture>
    ///
    ///
    /// Each app creates a single [`HMHomeManager`](https://developer.apple.com/documentation/homekit/hmhomemanager) instance to coordinate its HomeKit-related activities. The manager’s [`homes`](https://developer.apple.com/documentation/homekit/hmhomemanager/homes) array gives your app access to a collection of [`HMHome`](https://developer.apple.com/documentation/homekit/hmhome) instances that represent the user’s homes. These in turn contain references to the home automation accessories that your app can inspect and control.
    ///
    ///
    /// <picture>
    ///     <source media="(prefers-color-scheme: dark)" srcset="https://docs-assets.developer.apple.com/published/0a853498ff99cc139c55fe113f1169a1/media-3111594~dark%402x.png 2x" />
    ///     <source media="(prefers-color-scheme: light)" srcset="https://docs-assets.developer.apple.com/published/0a853498ff99cc139c55fe113f1169a1/media-3111594%402x.png 2x" />
    ///     <img alt="Diagram showing a collection of homes within the home manager, each of which has a collection of accessories." src="https://docs-assets.developer.apple.com/published/0a853498ff99cc139c55fe113f1169a1/media-3111594~dark%402x.png" />
    /// </picture>
    ///
    ///
    /// Adopt the [`HMHomeManagerDelegate`](https://developer.apple.com/documentation/homekit/hmhomemanagerdelegate) protocol in your app to stay informed of any changes to the set of homes made outside your app.
    ///
    ///
    /// Manages collection of one or more homes.
    ///
    ///
    /// This class is responsible for managing a collection of homes.
    #[unsafe(super(NSObject))]
    #[derive(Debug, PartialEq, Eq, Hash)]
    pub struct HMHomeManager;
);

unsafe impl Send for HMHomeManager {}

unsafe impl Sync for HMHomeManager {}

extern_conformance!(
    unsafe impl NSObjectProtocol for HMHomeManager {}
);

impl HMHomeManager {
    extern_methods!(
        #[unsafe(method(init))]
        #[unsafe(method_family = init)]
        pub unsafe fn init(this: Allocated<Self>) -> Retained<Self>;

        /// Delegate that receives updates on the collection of homes.
        ///
        /// This property is not atomic.
        ///
        /// # Safety
        ///
        /// This might not be thread-safe.
        #[unsafe(method(delegate))]
        #[unsafe(method_family = none)]
        pub unsafe fn delegate(
            &self,
        ) -> Option<Retained<ProtocolObject<dyn HMHomeManagerDelegate>>>;

        /// Setter for [`delegate`][Self::delegate].
        ///
        /// This is a [weak property][objc2::topics::weak_property].
        ///
        /// # Safety
        ///
        /// This might not be thread-safe.
        #[unsafe(method(setDelegate:))]
        #[unsafe(method_family = none)]
        pub unsafe fn setDelegate(
            &self,
            delegate: Option<&ProtocolObject<dyn HMHomeManagerDelegate>>,
        );

        /// The current authorization status of the application.
        ///
        /// The authorization is managed by the system, there is no need to explicitly request authorization.
        #[unsafe(method(authorizationStatus))]
        #[unsafe(method_family = none)]
        pub unsafe fn authorizationStatus(&self) -> HMHomeManagerAuthorizationStatus;

        #[cfg(feature = "HMHome")]
        /// The primary home for this collection.
        ///
        /// This property is not atomic.
        ///
        /// # Safety
        ///
        /// This might not be thread-safe.
        #[deprecated = "No longer supported."]
        #[unsafe(method(primaryHome))]
        #[unsafe(method_family = none)]
        pub unsafe fn primaryHome(&self) -> Option<Retained<HMHome>>;

        #[cfg(feature = "HMHome")]
        /// Array of HMHome objects that represents the homes associated with the home manager.
        ///
        ///
        /// When a new home manager is created, this array is initialized as an empty array. It is
        /// not guaranteed to be filled with the list of homes, represented as HMHome objects,
        /// until the homeManagerDidUpdateHomes: delegate method has been invoked.
        ///
        /// This property is not atomic.
        ///
        /// # Safety
        ///
        /// This might not be thread-safe.
        #[unsafe(method(homes))]
        #[unsafe(method_family = none)]
        pub unsafe fn homes(&self) -> Retained<NSArray<HMHome>>;

        #[cfg(all(feature = "HMHome", feature = "block2"))]
        /// This method is used to change the primary home.
        ///
        ///
        /// Parameter `home`: New primary home.
        ///
        ///
        /// Parameter `completion`: Block that is invoked once the request is processed.
        /// The NSError provides more information on the status of the request, error
        /// will be nil on success.
        #[deprecated = "No longer supported."]
        #[unsafe(method(updatePrimaryHome:completionHandler:))]
        #[unsafe(method_family = none)]
        pub unsafe fn updatePrimaryHome_completionHandler(
            &self,
            home: &HMHome,
            completion: &block2::DynBlock<dyn Fn(*mut NSError)>,
        );

        #[cfg(all(feature = "HMHome", feature = "block2"))]
        /// Adds a new home to the collection.
        ///
        ///
        /// Parameter `homeName`: Name of the  home to create and add to the collection.
        ///
        ///
        /// Parameter `completion`: Block that is invoked once the request is processed.
        /// The NSError provides more information on the status of the request, error
        /// will be nil on success.
        #[unsafe(method(addHomeWithName:completionHandler:))]
        #[unsafe(method_family = none)]
        pub unsafe fn addHomeWithName_completionHandler(
            &self,
            home_name: &NSString,
            completion: &block2::DynBlock<dyn Fn(*mut HMHome, *mut NSError)>,
        );

        #[cfg(all(feature = "HMHome", feature = "block2"))]
        /// Removes an existing home from the collection.
        ///
        ///
        /// Parameter `home`: Home object that needs to be removed from the collection.
        ///
        ///
        /// Parameter `completion`: Block that is invoked once the request is processed.
        /// The NSError provides more information on the status of the request, error
        /// will be nil on success.
        #[unsafe(method(removeHome:completionHandler:))]
        #[unsafe(method_family = none)]
        pub unsafe fn removeHome_completionHandler(
            &self,
            home: &HMHome,
            completion: &block2::DynBlock<dyn Fn(*mut NSError)>,
        );
    );
}

/// Methods declared on superclass `NSObject`.
impl HMHomeManager {
    extern_methods!(
        #[unsafe(method(new))]
        #[unsafe(method_family = new)]
        pub unsafe fn new() -> Retained<Self>;
    );
}

extern_protocol!(
    /// An interface the home manager uses to communicate changes to the state of the home network.
    ///
    /// ## Overview
    ///
    /// Adopt this protocol to find out about changes made outside your app to the set of homes in the HomeKit database, like when homes are added or removed by another app. You also rely on this protocol when you first create an [`HMHomeManager`](https://developer.apple.com/documentation/homekit/hmhomemanager) instance. The home manager calls the [`homeManagerDidUpdateHomes:`](https://developer.apple.com/documentation/homekit/hmhomemanagerdelegate/homemanagerdidupdatehomes(_:)) method to indicate that it has finished its initial load of data from the HomeKit database.
    ///
    /// Changes that your app initiates—even those made asynchronously followed by a call to a completion handler—generate delegate callbacks in other apps, but not in your own. As a result, your app must update its internal data store or user interface from both the completion handler of an asynchronous call, and the delegate callback that corresponds to the same kind of change made by another app.
    ///
    /// To be alerted about changes made within a particular home, adopt the [`HMHomeDelegate`](https://developer.apple.com/documentation/homekit/hmhomedelegate) protocol. To find out about changes made to specific accessories, adopt the [`HMAccessoryDelegate`](https://developer.apple.com/documentation/homekit/hmaccessorydelegate) protocol.
    ///
    ///
    /// This delegate receives updates on homes being managed via the home manager.
    pub unsafe trait HMHomeManagerDelegate: NSObjectProtocol {
        /// Informs the delegate a change in authorization status has occurred.
        ///
        ///
        /// Parameter `manager`: Sender of this message.
        ///
        /// Parameter `status`: The updated authorization status.
        #[optional]
        #[unsafe(method(homeManager:didUpdateAuthorizationStatus:))]
        #[unsafe(method_family = none)]
        unsafe fn homeManager_didUpdateAuthorizationStatus(
            &self,
            manager: &HMHomeManager,
            status: HMHomeManagerAuthorizationStatus,
        );

        /// Informs the delegate when homes configured by the user have been detected by the system.
        ///
        ///
        /// This delegate method is also invoked to inform an application of significant changes
        /// to the home configuration. Applications should use this as a cue to invalidate their
        /// current references to HomeKit objects and refresh their views with the new list of homes.
        ///
        ///
        /// Parameter `manager`: Sender of this message.
        #[optional]
        #[unsafe(method(homeManagerDidUpdateHomes:))]
        #[unsafe(method_family = none)]
        unsafe fn homeManagerDidUpdateHomes(&self, manager: &HMHomeManager);

        /// Informs the delegate when the primary home is modified.
        ///
        ///
        /// Parameter `manager`: Sender of this message.
        #[optional]
        #[unsafe(method(homeManagerDidUpdatePrimaryHome:))]
        #[unsafe(method_family = none)]
        unsafe fn homeManagerDidUpdatePrimaryHome(&self, manager: &HMHomeManager);

        #[cfg(feature = "HMHome")]
        /// Informs the delegate when a new home is added.
        ///
        ///
        /// Parameter `manager`: Sender of this message.
        ///
        ///
        /// Parameter `home`: New home that was added.
        #[optional]
        #[unsafe(method(homeManager:didAddHome:))]
        #[unsafe(method_family = none)]
        unsafe fn homeManager_didAddHome(&self, manager: &HMHomeManager, home: &HMHome);

        #[cfg(feature = "HMHome")]
        /// Informs the delegate when an existing home is removed.
        ///
        ///
        /// Parameter `manager`: Sender of this message.
        ///
        ///
        /// Parameter `home`: Home that was removed.
        #[optional]
        #[unsafe(method(homeManager:didRemoveHome:))]
        #[unsafe(method_family = none)]
        unsafe fn homeManager_didRemoveHome(&self, manager: &HMHomeManager, home: &HMHome);

        #[cfg(feature = "HMAddAccessoryRequest")]
        /// Informs the delegate an accessory needs to be added to the home by using one of the
        /// HMAccessorySetupPayload factory methods on the request parameter.
        ///
        ///
        /// Parameter `manager`: Sender of this message.
        ///
        ///
        /// Parameter `request`: Information for the add accessory request.
        #[optional]
        #[unsafe(method(homeManager:didReceiveAddAccessoryRequest:))]
        #[unsafe(method_family = none)]
        unsafe fn homeManager_didReceiveAddAccessoryRequest(
            &self,
            manager: &HMHomeManager,
            request: &HMAddAccessoryRequest,
        );
    }
);
