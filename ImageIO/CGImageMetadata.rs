//! This file has been automatically generated by `objc2`'s `header-translator`.
//! DO NOT EDIT
use core::cell::UnsafeCell;
use core::ffi::*;
use core::marker::{PhantomData, PhantomPinned};
use core::ptr::NonNull;
#[cfg(feature = "objc2")]
use objc2::__framework_prelude::*;
use objc2_core_foundation::*;

use crate::*;

/// An immutable object that contains the XMP metadata associated with an image.
///
/// ## Overview
///
/// A [`CGImageMetadataRef`](https://developer.apple.com/documentation/imageio/cgimagemetadata) object stores the metadata associated with an image. Create this object from your image’s associated XMP data, and use it to fetch individual metadata tags. You can search for specific tags, or enumerate all of the tags present for the image.
///
///
/// an immutable container for CGImageMetadataTags
#[doc(alias = "CGImageMetadataRef")]
#[repr(C)]
pub struct CGImageMetadata {
    inner: [u8; 0],
    _p: UnsafeCell<PhantomData<(*const UnsafeCell<()>, PhantomPinned)>>,
}

cf_type!(
    unsafe impl CGImageMetadata {}
);
#[cfg(feature = "objc2")]
cf_objc2_type!(
    unsafe impl RefEncode<"CGImageMetadata"> for CGImageMetadata {}
);

unsafe impl ConcreteType for CGImageMetadata {
    /// Returns the type identifier for metadata objects.
    ///
    /// ## Return Value
    ///
    /// The type identifier for [`CGImageMetadataRef`](https://developer.apple.com/documentation/imageio/cgimagemetadata) and [`CGMutableImageMetadataRef`](https://developer.apple.com/documentation/imageio/cgmutableimagemetadata) objects.
    ///
    ///
    /// *!
    ///
    ///
    ///
    /// Gets the type identifier for the CGImageMetadata opaque type
    ///
    /// Returns: the type identifier for the CGImageMetadata opaque type
    #[doc(alias = "CGImageMetadataGetTypeID")]
    #[inline]
    fn type_id() -> CFTypeID {
        extern "C-unwind" {
            fn CGImageMetadataGetTypeID() -> CFTypeID;
        }
        unsafe { CGImageMetadataGetTypeID() }
    }
}

/// An opaque type for adding or modifying image metadata.
///
/// ## Discussion
///
/// Create a [`CGMutableImageMetadataRef`](https://developer.apple.com/documentation/imageio/cgmutableimagemetadata) opaque type when you want to modify the metadata in an image. You may pass this type to any functions that take a [`CGImageMetadataRef`](https://developer.apple.com/documentation/imageio/cgimagemetadata) type as a parameter. This object stores the tag information as XMP data, which you can write back to the image.
///
/// When you access or modify EXIF or IPTC properties, the metadata functions automatically bridge those properties to appropriate XMP properties. This bridging behavior fills in any fields that are present only in the XMP data. For example, it fills in the namespace, prefix, and XMP type information in the corresponding [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag) object.
///
///
/// a mutable container for CGImageMetadataTags
///
/// A CGMutableImageMetadataRef can be used in any function that
/// accepts a CGImageMetadataRef.
#[doc(alias = "CGMutableImageMetadataRef")]
#[repr(C)]
pub struct CGMutableImageMetadata {
    inner: [u8; 0],
    _p: UnsafeCell<PhantomData<(*const UnsafeCell<()>, PhantomPinned)>>,
}

cf_type!(
    unsafe impl CGMutableImageMetadata: CGImageMetadata {}
);
#[cfg(feature = "objc2")]
cf_objc2_type!(
    unsafe impl RefEncode<"CGImageMetadata"> for CGMutableImageMetadata {}
);

impl CGMutableImageMetadata {
    /// Creates an empty, mutable image metdata opaque type.
    ///
    /// ## Return Value
    ///
    /// A [`CGMutableImageMetadataRef`](https://developer.apple.com/documentation/imageio/cgmutableimagemetadata) object that contains no metadata information, or `NULL` if an error occurs. You are responsible for releasing the returned object.
    ///
    ///
    /// Creates an empty CGMutableImageMetadataRef
    #[doc(alias = "CGImageMetadataCreateMutable")]
    #[inline]
    pub unsafe fn new() -> CFRetained<CGMutableImageMetadata> {
        extern "C-unwind" {
            fn CGImageMetadataCreateMutable() -> Option<NonNull<CGMutableImageMetadata>>;
        }
        let ret = unsafe { CGImageMetadataCreateMutable() };
        let ret =
            ret.expect("function was marked as returning non-null, but actually returned NULL");
        unsafe { CFRetained::from_raw(ret) }
    }

    /// Creates a deep, mutable copy of the specified metadata information.
    ///
    /// Parameters:
    /// - metadata: The metadata information to copy. This function makes a deep copy of all [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag) structures in this parameter, including the values for the tags.
    ///
    ///
    /// ## Return Value
    ///
    /// A new [`CGMutableImageMetadataRef`](https://developer.apple.com/documentation/imageio/cgmutableimagemetadata) type that contains a deep copy of the tags in the metadata parameter.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Typically, you call this function before modifying the metadata information for an image. Use it to create a copy of the image’s existing metadata information, and then add or modify that metadata before saving it with the image.
    ///
    ///
    /// Creates a deep mutable copy of another CGImageMetadataRef
    ///
    /// Before modifying an immutable CGImageMetadataRef (such as metadata
    /// from CGImageSourceCopyMetadataAtIndex) you must first make a copy.
    /// This function makes a deep copy of all CGImageMetadataTags and their values.
    #[doc(alias = "CGImageMetadataCreateMutableCopy")]
    #[inline]
    pub unsafe fn new_copy(
        metadata: &CGImageMetadata,
    ) -> Option<CFRetained<CGMutableImageMetadata>> {
        extern "C-unwind" {
            fn CGImageMetadataCreateMutableCopy(
                metadata: &CGImageMetadata,
            ) -> Option<NonNull<CGMutableImageMetadata>>;
        }
        let ret = unsafe { CGImageMetadataCreateMutableCopy(metadata) };
        ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
    }
}

/// An immutable type that contains information about a single piece of image metadata.
///
/// ## Overview
///
/// Each [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag) opaque type contains a single EXIF, IPTC, or XMP property. The namespace, prefix, name, type, and value of the tag identify different portions of the tag’s content. For example, the namespace specifies whether the tag is part of the EXIF metadata or a different set of metadata.
///
/// You retrieve existing metadata tags from an [`CGImageMetadataRef`](https://developer.apple.com/documentation/imageio/cgimagemetadata) opaque type. You may also create new tags and add them to a [`CGMutableImageMetadataRef`](https://developer.apple.com/documentation/imageio/cgmutableimagemetadata) type, before you assign the updated metadata to an image.
///
///
/// an individual metadata tag
///
/// A CGImageMetadataTag encapsulates an EXIF, IPTC, or XMP property.
/// All tags contain a namespace, prefix, name, type, and value. Please see
///
/// ```text
///  CGImageMetadataTagCreate
/// ```
///
/// for more details.
#[doc(alias = "CGImageMetadataTagRef")]
#[repr(C)]
pub struct CGImageMetadataTag {
    inner: [u8; 0],
    _p: UnsafeCell<PhantomData<(*const UnsafeCell<()>, PhantomPinned)>>,
}

cf_type!(
    unsafe impl CGImageMetadataTag {}
);
#[cfg(feature = "objc2")]
cf_objc2_type!(
    unsafe impl RefEncode<"CGImageMetadataTag"> for CGImageMetadataTag {}
);

unsafe impl ConcreteType for CGImageMetadataTag {
    /// Returns the type identifier for the image metadata tag opaque type
    ///
    /// ## Return Value
    ///
    /// The type identifier for the [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag) opaque type.
    ///
    ///
    /// *!
    ///
    ///
    ///
    /// Gets the type identifier for the CGImageMetadataTag opaque type
    ///
    /// Returns: the type identifier for the CGImageMetadataTagGetTypeID opaque type
    #[doc(alias = "CGImageMetadataTagGetTypeID")]
    #[inline]
    fn type_id() -> CFTypeID {
        extern "C-unwind" {
            fn CGImageMetadataTagGetTypeID() -> CFTypeID;
        }
        unsafe { CGImageMetadataTagGetTypeID() }
    }
}

extern "C" {
    /// The namespace for the Exchangeable Image File (EXIF) format.
    pub static kCGImageMetadataNamespaceExif: &'static CFString;
}

extern "C" {
    /// The namespace for EXIF auxiliary keys.
    pub static kCGImageMetadataNamespaceExifAux: &'static CFString;
}

extern "C" {
    /// The namespace for the exifEX format.
    pub static kCGImageMetadataNamespaceExifEX: &'static CFString;
}

extern "C" {
    /// The namespace for the Dublin Core Metadata Element Set.
    pub static kCGImageMetadataNamespaceDublinCore: &'static CFString;
}

extern "C" {
    /// The namespace for the IPTC format.
    pub static kCGImageMetadataNamespaceIPTCCore: &'static CFString;
}

extern "C" {
    pub static kCGImageMetadataNamespaceIPTCExtension: &'static CFString;
}

extern "C" {
    /// The namespace for Photoshop image metadata.
    pub static kCGImageMetadataNamespacePhotoshop: &'static CFString;
}

extern "C" {
    /// The namespace for TIFF image metadata.
    pub static kCGImageMetadataNamespaceTIFF: &'static CFString;
}

extern "C" {
    /// The namespace for the Extensible Metadata Platform (XMP) format.
    pub static kCGImageMetadataNamespaceXMPBasic: &'static CFString;
}

extern "C" {
    /// The namespace for XMP metadata that conveys legal restrictions associated with a resource.
    pub static kCGImageMetadataNamespaceXMPRights: &'static CFString;
}

extern "C" {
    /// The prefix string for tags in the Exchangeable Image File (EXIF) metadata.
    pub static kCGImageMetadataPrefixExif: &'static CFString;
}

extern "C" {
    /// The prefix string for tags in the EXIF auxiliary metadata collection.
    pub static kCGImageMetadataPrefixExifAux: &'static CFString;
}

extern "C" {
    /// The prefix string for tags in the exifEX metadata.
    pub static kCGImageMetadataPrefixExifEX: &'static CFString;
}

extern "C" {
    /// The prefix string for tags in the Dublin Core Metadata Element Set.
    pub static kCGImageMetadataPrefixDublinCore: &'static CFString;
}

extern "C" {
    /// The prefix string for tags in the IPTC metadata.
    pub static kCGImageMetadataPrefixIPTCCore: &'static CFString;
}

extern "C" {
    pub static kCGImageMetadataPrefixIPTCExtension: &'static CFString;
}

extern "C" {
    /// The prefix string for tags in the Photoshop image metadata.
    pub static kCGImageMetadataPrefixPhotoshop: &'static CFString;
}

extern "C" {
    /// The prefix string for tags in the TIFF image metadata.
    pub static kCGImageMetadataPrefixTIFF: &'static CFString;
}

extern "C" {
    /// The prefix string for tags in the XMP metadata.
    pub static kCGImageMetadataPrefixXMPBasic: &'static CFString;
}

extern "C" {
    /// The prefix string for tags in the XMP metadata that convey legal restrictions for the resource.
    pub static kCGImageMetadataPrefixXMPRights: &'static CFString;
}

/// Constants that indicate the XMP type for a metadata tag.
///
/// ## Overview
///
/// Use these constants to identify the type of metadata in a [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag) opaque type. The type tells you how to interpret the value of the metadata tag. When creating a new [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag), specify a type so the system knows how to serialize the data to the XMP format.
///
///
/// The XMP type for a CGImageMetadataTag
///
/// CGImageMetadataType defines a list of constants used to indicate
/// the type for a CGImageMetadataTag. If you are reading metadata, use the type
/// to determine how to interpret the CGImageMetadataTag's value. If you are
/// creating a CGImageMetadataTag, use the type to specify how the tag
/// should be serialized in XMP. String types have CFStringRef values, array
/// types have CFArray values, and structure types have CFDictionary values.
///
/// CFType of the tag's value. This is only used when creating a new
/// CGImageMetadataTag - no existing tags should have this value. CFString
/// defaults to kCGImageMetadataTypeString, CFArray defaults to
/// kCGImageMetadataTypeArrayOrdered, and CFDictionary defaults to
/// kCGImageMetadataTypeStructure.
///
/// values will be converted to a string.
///
/// Serialized in XMP as
/// <rdf
/// :Bag>.
///
/// Serialized in XMP as
/// <rdf
/// :Seq>.
///
/// are alternates for the same value. Serialized in XMP as
/// <rdf
/// :Alt>.
///
/// where all elements are different localized strings for the same value.
/// Serialized in XMP as an alternate array of strings with xml:lang qualifiers.
///
/// array elements, fields of a structure may belong to different namespaces.
// NS_ENUM
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord, Default)]
pub struct CGImageMetadataType(pub i32);
impl CGImageMetadataType {
    /// An invalid metadata type.
    #[doc(alias = "kCGImageMetadataTypeInvalid")]
    pub const Invalid: Self = Self(-1);
    /// The default type for new tags.
    ///
    /// ## Discussion
    ///
    /// When you create new tags, the system assigns this value initially. The system uses the Core Foundation type of the metadata tag’s value to determine an appropriate type. During the serialization process, the system converts the type automatically to a nondefault value.
    ///
    ///
    #[doc(alias = "kCGImageMetadataTypeDefault")]
    pub const Default: Self = Self(0);
    /// A string value.
    ///
    /// ## Discussion
    ///
    /// The string type also represents number and Boolean values.
    ///
    ///
    #[doc(alias = "kCGImageMetadataTypeString")]
    pub const String: Self = Self(1);
    /// An array that doesn’t preserve the order of items.
    ///
    /// ## Discussion
    ///
    /// During serialization, this type becomes `<rdf:Bag>` in the XMP format.
    ///
    ///
    #[doc(alias = "kCGImageMetadataTypeArrayUnordered")]
    pub const ArrayUnordered: Self = Self(2);
    /// An array that preserves the order of items.
    ///
    /// ## Discussion
    ///
    /// During serialization, this type becomes `<rdf:Seq>` in the XMP format.
    ///
    ///
    #[doc(alias = "kCGImageMetadataTypeArrayOrdered")]
    pub const ArrayOrdered: Self = Self(3);
    /// An ordered array, in which all elements are alternates for the same value.
    ///
    /// ## Discussion
    ///
    /// During serialization, this type becomes `<rdf:Alt>` in the XMP format.
    ///
    ///
    #[doc(alias = "kCGImageMetadataTypeAlternateArray")]
    pub const AlternateArray: Self = Self(4);
    /// An alternate array, in which all elements are localized strings for the same value.
    ///
    /// ## Discussion
    ///
    /// During serialization, this type becomes an alternate array of strings with `xml:lang` qualifiers in the XMP format.
    ///
    ///
    #[doc(alias = "kCGImageMetadataTypeAlternateText")]
    pub const AlternateText: Self = Self(5);
    /// A collection of keys and values.
    ///
    /// ## Discussion
    ///
    /// Unlike array elements, fields of a structure may belong to different namespaces.
    ///
    ///
    #[doc(alias = "kCGImageMetadataTypeStructure")]
    pub const Structure: Self = Self(6);
}

#[cfg(feature = "objc2")]
unsafe impl Encode for CGImageMetadataType {
    const ENCODING: Encoding = i32::ENCODING;
}

#[cfg(feature = "objc2")]
unsafe impl RefEncode for CGImageMetadataType {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

impl CGImageMetadataTag {
    /// Creates a new image metadata tag, and fills it with the specified information.
    ///
    /// Parameters:
    /// - xmlns: The namespace for the tag. Specify a common XMP namespace, such as [`kCGImageMetadataNamespaceExif`](https://developer.apple.com/documentation/imageio/kcgimagemetadatanamespaceexif), or a string with a custom namespace URI. A custom namespace must be a valid XML namespace. By convention, namespaces end with either the `/` or `#` character.
    ///
    /// - prefix: An abbreviation for the XML namespace. You must specify a valid string for custom namespace. For standard namespaces such as [`kCGImageMetadataNamespaceExif`](https://developer.apple.com/documentation/imageio/kcgimagemetadatanamespaceexif), you may specify `NULL`.
    ///
    /// - name: The name of the metadata tag. This string must correspond to a valid XMP name.
    ///
    /// - type: The type of data in the `value` parameter. For a list of possible values, see [`CGImageMetadataType`](https://developer.apple.com/documentation/imageio/cgimagemetadatatype).
    ///
    /// - value: The value of the tag. The value’s type must match the information in the `type` parameter. Supported types for this parameter are [`CFStringRef`](https://developer.apple.com/documentation/corefoundation/cfstring), [`CFNumberRef`](https://developer.apple.com/documentation/corefoundation/cfnumber), [`CFBooleanRef`](https://developer.apple.com/documentation/corefoundation/cfboolean), [`CFArrayRef`](https://developer.apple.com/documentation/corefoundation/cfarray), and [`CFDictionaryRef`](https://developer.apple.com/documentation/corefoundation/cfdictionary). The keys of a dictionary must be [`CFStringRef`](https://developer.apple.com/documentation/corefoundation/cfstring) types with XMP names. The values of a dictionary must be either [`CFStringRef`](https://developer.apple.com/documentation/corefoundation/cfstring) or [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag) types.
    ///
    /// The newly created tag stores only a shallow copy of the original value. As a result, modifying the original value doesn’t affect the value in the new [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag).
    ///
    ///
    /// ## Return Value
    ///
    /// A new [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag) type, or `NULL` if an error occurred.
    ///
    ///
    /// Creates a new CGImageMetadataTag
    ///
    /// Parameter `xmlns`: The namespace for the tag. The value can be a common XMP namespace
    /// defined above, such as kCGImageMetadataNamespaceExif, or a CFString with a
    /// custom namespace URI. Custom namespaces must be a valid XML namespace. By
    /// convention, namespaces should end with either '/' or '#'. For example, exif
    /// uses the namespace "http://ns.adobe.com/exif/1.0/".
    ///
    /// Parameter `prefix`: An abbreviation for the XML namespace. The value can be NULL if
    /// the namespace is defined as a constant. Custom prefixes must be a valid XML
    /// name. For example, the prefix used for "http://ns.adobe.com/exif/1.0/" is "exif".
    /// The XMP serialization of the tag will use the prefix. Prefixes are also
    /// important for path-based CGImageMetadata functions, such as
    ///
    /// ```text
    ///  CGImageMetadataCopyStringValueWithPath
    /// ```
    ///
    /// or
    ///
    /// ```text
    ///  CGImageMetadataSetValueWithPath
    /// ```
    ///
    /// .
    ///
    /// Parameter `name`: The name of the tag. It must be a valid XMP name.
    ///
    /// Parameter `type`: The type of the tag's value. Must be a constant from
    ///
    /// ```text
    ///  
    ///  CGImageMetadataType
    /// ```
    ///
    /// .
    ///
    /// Parameter `value`: The value of the tag. Allowable CFTypes include CFStringRef,
    /// CFNumberRef, CFBooleanRef, CFArrayRef, and CFDictionaryRef. The CFType of 'value'
    /// must correspond to the 'type'. The elements of a CFArray must be either a
    /// CFStringRef or CGImageMetadataTagRef. The keys of a CFDictionary must be
    /// CFStringRefs with valid XMP names. The values of a CFDictionary must be either
    /// CFStringRefs or CGImageMetadataTagRefs. A shallow copy of the value is stored
    /// in the tag. Therefore, modifying a mutable value after the tag is created
    /// will not affect the tag's value.
    ///
    /// Returns: Returns a pointer to a new CGImageMetadataTag. Returns NULL if a tag
    /// could not be created with the specified parameters.
    ///
    /// # Safety
    ///
    /// `value` should be of the correct type.
    #[doc(alias = "CGImageMetadataTagCreate")]
    #[inline]
    pub unsafe fn new(
        xmlns: &CFString,
        prefix: Option<&CFString>,
        name: &CFString,
        r#type: CGImageMetadataType,
        value: &CFType,
    ) -> Option<CFRetained<CGImageMetadataTag>> {
        extern "C-unwind" {
            fn CGImageMetadataTagCreate(
                xmlns: &CFString,
                prefix: Option<&CFString>,
                name: &CFString,
                r#type: CGImageMetadataType,
                value: &CFType,
            ) -> Option<NonNull<CGImageMetadataTag>>;
        }
        let ret = unsafe { CGImageMetadataTagCreate(xmlns, prefix, name, r#type, value) };
        ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
    }

    /// Returns an immutable copy of the tag’s XMP namespace.
    ///
    /// Parameters:
    /// - tag: The metadata tag from which to fetch the namespace information.
    ///
    ///
    /// ## Return Value
    ///
    /// An immutable string that contains the tag’s namespace. For a list of public namespaces, see [XMP Namespaces and Prefixes](https://developer.apple.com/documentation/imageio/xmp-namespaces-and-prefixes). You are responsible for releasing this string.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// By convention, namespaces end with either a `/` or `#` character. For example, EXIF metadata uses the namespace `http://ns.adobe.com/exif/1.0/`. Custom namespaces must be a valid XML namespace.
    ///
    ///
    /// *!
    ///
    ///
    ///
    /// Returns a copy of the tag's namespace
    #[doc(alias = "CGImageMetadataTagCopyNamespace")]
    #[inline]
    pub unsafe fn namespace(&self) -> Option<CFRetained<CFString>> {
        extern "C-unwind" {
            fn CGImageMetadataTagCopyNamespace(
                tag: &CGImageMetadataTag,
            ) -> Option<NonNull<CFString>>;
        }
        let ret = unsafe { CGImageMetadataTagCopyNamespace(self) };
        ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
    }

    /// Returns an immutable copy of the tag’s prefix.
    ///
    /// Parameters:
    /// - tag: The metadata tag from which to fetch the namespace information.
    ///
    ///
    /// ## Return Value
    ///
    /// An immutable string that contains the tag’s prefix. For example, EXIF metadata uses the prefix `exif`. You are responsible for releasing this string.
    ///
    ///
    /// Returns a copy of the tag's prefix
    #[doc(alias = "CGImageMetadataTagCopyPrefix")]
    #[inline]
    pub unsafe fn prefix(&self) -> Option<CFRetained<CFString>> {
        extern "C-unwind" {
            fn CGImageMetadataTagCopyPrefix(tag: &CGImageMetadataTag) -> Option<NonNull<CFString>>;
        }
        let ret = unsafe { CGImageMetadataTagCopyPrefix(self) };
        ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
    }

    /// Returns an immutable copy of the tag’s name.
    ///
    /// Parameters:
    /// - tag: The metadata tag from which to fetch the namespace information.
    ///
    ///
    /// ## Return Value
    ///
    /// A string that contains the tag’s name. You are responsible for releasing this string.
    ///
    ///
    /// Returns a copy of the tag's name
    #[doc(alias = "CGImageMetadataTagCopyName")]
    #[inline]
    pub unsafe fn name(&self) -> Option<CFRetained<CFString>> {
        extern "C-unwind" {
            fn CGImageMetadataTagCopyName(tag: &CGImageMetadataTag) -> Option<NonNull<CFString>>;
        }
        let ret = unsafe { CGImageMetadataTagCopyName(self) };
        ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
    }

    /// Returns a shallow copy of the tag’s value, which is suitable only for reading.
    ///
    /// Parameters:
    /// - tag: The metadata tag from which to fetch the namespace information.
    ///
    ///
    /// ## Return Value
    ///
    /// A copy of the tag’s value. Possible return types are [`CFStringRef`](https://developer.apple.com/documentation/corefoundation/cfstring), [`CFNumberRef`](https://developer.apple.com/documentation/corefoundation/cfnumber), [`CFBooleanRef`](https://developer.apple.com/documentation/corefoundation/cfboolean), [`CFArrayRef`](https://developer.apple.com/documentation/corefoundation/cfarray), and [`CFDictionaryRef`](https://developer.apple.com/documentation/corefoundation/cfdictionary).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Use this method to obtain the value when you want to use or display that value elsewhere. Any changes you make to the returned value don’t change the contents of the metadata tag. To change the value, call [`CGImageMetadataSetValueWithPath`](https://developer.apple.com/documentation/imageio/cgimagemetadatasetvaluewithpath(_:_:_:_:)) or [`CGImageMetadataSetTagWithPath`](https://developer.apple.com/documentation/imageio/cgimagemetadatasettagwithpath(_:_:_:_:)) instead.
    ///
    ///
    /// Returns a shallow copy of the tag's value
    ///
    /// This function should only be used to read the tag's value.
    /// CGImageMetadataCopyTagWithPath returns a copy of the tag (including a copy of
    /// the tag's value). Therefore mutating a tag's value returned from this function
    /// may not actually mutate the value in the CGImageMetadata. It is recommended
    /// to create a new tag followed by CGImageMetadataSetTagWithPath, or use
    /// CGImageMetadataSetValueWithPath to mutate a metadata value.
    #[doc(alias = "CGImageMetadataTagCopyValue")]
    #[inline]
    pub unsafe fn value(&self) -> Option<CFRetained<CFType>> {
        extern "C-unwind" {
            fn CGImageMetadataTagCopyValue(tag: &CGImageMetadataTag) -> Option<NonNull<CFType>>;
        }
        let ret = unsafe { CGImageMetadataTagCopyValue(self) };
        ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
    }

    /// Returns the type of the metadata tag’s value.
    ///
    /// Parameters:
    /// - tag: The metadata tag from which to fetch the namespace information.
    ///
    ///
    /// ## Return Value
    ///
    /// A constant that indicates the type of the value. For a list of possible return values, see [`CGImageMetadataType`](https://developer.apple.com/documentation/imageio/cgimagemetadatatype).
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// To get the value itself, call [`CGImageMetadataTagCopyValue`](https://developer.apple.com/documentation/imageio/cgimagemetadatatagcopyvalue(_:)). Metadata tags store string, number, and Boolean values using the [`kCGImageMetadataTypeString`](https://developer.apple.com/documentation/imageio/cgimagemetadatatype/string) type.
    ///
    ///
    /// Get the type of the CGImageMetadataTag
    ///
    /// Returns: Returns a CGImageMetadataType constant for the CGImageMetadataTag.
    /// This is primarily used to determine how to interpret the tag's value.
    #[doc(alias = "CGImageMetadataTagGetType")]
    #[inline]
    pub unsafe fn r#type(&self) -> CGImageMetadataType {
        extern "C-unwind" {
            fn CGImageMetadataTagGetType(tag: &CGImageMetadataTag) -> CGImageMetadataType;
        }
        unsafe { CGImageMetadataTagGetType(self) }
    }

    /// Returns a shallow copy of the metadata tags that act as qualifiers for the current tag.
    ///
    /// Parameters:
    /// - tag: The metadata tag from which to fetch the namespace information.
    ///
    ///
    /// ## Return Value
    ///
    /// An array of [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag) types that represent the current tag’s qualifiers, or `NULL` if the tag has no qualifiers.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// XMP allows a metadata tag to contain supplemental tags that act as qualifiers on the content. For example, the `xml:lang` qualifier provides alternate text entries for the current tag. Each qualifier is a [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag) with its own namespace, prefix, name, and value.
    ///
    ///
    /// Return a copy of the tag's qualifiers
    ///
    /// XMP allows properties to contain supplemental properties called
    /// qualifiers. Qualifiers are themselves CGImageMetadataTags with their own
    /// namespace, prefix, name, and value. A common use is the xml:lang qualifier
    /// for elements of an alternate-text array.
    ///
    /// Returns: Returns a copy of the array of qualifiers. Elements of the array are
    /// CGImageMetadataTags. Returns NULL if the tag does not have any qualifiers.
    /// The copy is shallow, the qualifiers are not deep copied.
    #[doc(alias = "CGImageMetadataTagCopyQualifiers")]
    #[inline]
    pub unsafe fn qualifiers(&self) -> Option<CFRetained<CFArray>> {
        extern "C-unwind" {
            fn CGImageMetadataTagCopyQualifiers(
                tag: &CGImageMetadataTag,
            ) -> Option<NonNull<CFArray>>;
        }
        let ret = unsafe { CGImageMetadataTagCopyQualifiers(self) };
        ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
    }
}

impl CGImageMetadata {
    /// Returns an array of root-level metadata tags from the specified metadata object.
    ///
    /// Parameters:
    /// - metadata: The metadata object that contains the tags.
    ///
    ///
    /// ## Return Value
    ///
    /// An array that contains a shallow copy of all root-level [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag) objects. This array contains only the root-level tags. It doesn’t contain any nested tags.
    ///
    ///
    /// *!
    ///
    ///
    ///
    /// Obtain an array of tags from a CGImageMetadataRef
    ///
    /// Returns: Returns an array with a shallow copy of all top-level
    /// CGImageMetadataTagRefs in a CGImageMetadataRef.
    #[doc(alias = "CGImageMetadataCopyTags")]
    #[inline]
    pub unsafe fn tags(&self) -> Option<CFRetained<CFArray>> {
        extern "C-unwind" {
            fn CGImageMetadataCopyTags(metadata: &CGImageMetadata) -> Option<NonNull<CFArray>>;
        }
        let ret = unsafe { CGImageMetadataCopyTags(self) };
        ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
    }

    /// Searches for a specific metadata tag within a metadata collection.
    ///
    /// Parameters:
    /// - metadata: The metadata object that contains the tags.
    ///
    /// - parent: The parent tag, if any. Specify `NULL` to start the search in the top-level tags of the metadata object. If this parameter is `NULL`, you must include a valid prefix string in the `path` parameter.
    ///
    /// - path: A string that represents the path to the tag. A path consists of the tag’s name, plus optional prefix and parent information. Separate prefix information from other path information using a colon (`:`) character. Separate parent and child tags using the period (`.`) character. For example, the string `“exif:Flash.RedEyeMode”` represents the path to the `RedEyeMode` field of the `Flash` parent structure in the EXIF metadata.
    ///
    /// When a tag contains an ordered or unordered array, specify elements using a `0`-based index inside square brackets. For example, use the string `“dc.subject[2]”` to access the third element in the `subject` array.
    ///
    /// When the tag contains an alternate-text array, access elements using an RFC 3066 language code inside square brackets. For example, use the string `“dc.description[de]”` to access the German description information.
    ///
    /// Use the ? character to delimit qualifiers for tags with string values. You may not use this character for arrays and structures.
    ///
    ///
    /// ## Return Value
    ///
    /// A copy of the [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag) object at the specified path, or `NULL` if the tag wasn’t found.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// If you specify a valid tag in the `parent` parameter, you may omit the parent’s path information from the `path` parameter. For example, to access the `RedEyeMode` field, specify the [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag) object for the `Flash` parent property, and specify `“RedEyeMode”` for the path string.
    ///
    /// If a tag contains a custom prefix that is not already present in the metadata object, call [`CGImageMetadataRegisterNamespaceForPrefix`](https://developer.apple.com/documentation/imageio/cgimagemetadataregisternamespaceforprefix(_:_:_:_:)) to register that prefix before you search for it with this function.
    ///
    ///
    /// Searches for a specific CGImageMetadataTag in a CGImageMetadataRef
    ///
    /// This is the primary function for clients to obtain specific
    /// metadata properties from an image. The 'path' mechanism provides a way to
    /// access both simple top-level properties, such as Date
    /// &
    /// Time, or complex
    /// deeply-nested properties with ease.
    ///
    /// Parameter `metadata`: A collection of metadata tags.
    ///
    /// Parameter `parent`: A parent tag. If NULL, the path is relative to the root of the
    /// CGImageMetadataRef (i.e. it is not a child of another property). If the parent
    /// is provided, the effective path will be the concatenation of the parent's path
    /// and the 'path' parameter. This is useful for accessing array elements or
    /// structure fields inside nested tags.
    ///
    /// Parameter `path`: A string representing a path to the desired tag. Paths consist of
    /// a tag prefix (i.e. "exif") joined with a tag name (i.e. "Flash") by a colon
    /// (":"), such as CFSTR("exif:Flash").
    /// Elements of ordered and unordered arrays are accessed via 0-based indices inside square [] brackets.
    /// Elements of alternate-text arrays are accessed by an RFC 3066 language code inside square [] brackets.
    /// Fields of a structure are delimited by a period, '.'.
    /// Qualifiers are delimited by the '?' character. Only tags with string values (kCGImageMetadataTypeString)
    /// are allowed to have qualifiers - arrays and structures may not contain qualifiers.
    ///
    /// If parent is NULL, a prefix must be specified for the first tag. Prefixes for
    /// all subsequent tags are optional. If unspecified, the prefix is
    /// inherented from the nearest parent tag with a prefix. Custom prefixes must be
    /// registered using
    ///
    /// ```text
    ///  CGImageMetadataRegisterNamespaceForPrefix
    /// ```
    ///
    /// prior to use
    /// in any path-based functions.
    ///
    /// Examples:
    /// <ul>
    /// <li>
    /// 'path' = CFSTR("xmp:CreateDate")
    /// </li>
    /// <li>
    /// 'path' = CFSTR("exif:Flash.Fired")
    /// </li>
    /// <li>
    /// 'parent' = tag at path CFSTR("exif:Flash"), path = CFSTR("exif:Fired") (equivilent to previous)
    /// </li>
    /// <li>
    /// 'path' = CFSTR("exif:Flash.RedEyeMode")
    /// </li>
    /// <li>
    /// 'path' = CFSTR("dc:title")
    /// </li>
    /// <li>
    /// 'path' = CFSTR("dc:subject")
    /// </li>
    /// <li>
    /// 'path' = CFSTR("dc:subject[2]")
    /// </li>
    /// <li>
    /// 'parent' = tag at path CFSTR("dc:subject"), path = CFSTR("[2]") (equivilent to previous)
    /// </li>
    /// <li>
    /// 'path' = CFSTR("dc:description[x-default])"
    /// </li>
    /// <li>
    /// 'path' = CFSTR("dc.description[de])"
    /// </li>
    /// <li>
    /// 'path' = CFSTR("dc.description[fr])"
    /// </li>
    /// <li>
    /// 'path' = CFSTR("foo:product)"
    /// </li>
    /// <li>
    /// 'path' = CFSTR("foo:product?bar:manufacturer)"
    /// </li>
    /// </ul>
    ///
    /// Returns: Returns a copy of CGImageMetadataTag matching 'path', or NULL if no
    /// match is found. The copy of the tag's value is shallow. Tags
    /// copied from an immutable CGImageMetadataRef are also immutable. Because this
    /// function returns a copy of the tag's value, any modification of the tag's
    /// value must be followed by a CGImageMetadataSetTagWithPath to commit the
    /// change to the metadata container.
    #[doc(alias = "CGImageMetadataCopyTagWithPath")]
    #[inline]
    pub unsafe fn tag_with_path(
        &self,
        parent: Option<&CGImageMetadataTag>,
        path: &CFString,
    ) -> Option<CFRetained<CGImageMetadataTag>> {
        extern "C-unwind" {
            fn CGImageMetadataCopyTagWithPath(
                metadata: &CGImageMetadata,
                parent: Option<&CGImageMetadataTag>,
                path: &CFString,
            ) -> Option<NonNull<CGImageMetadataTag>>;
        }
        let ret = unsafe { CGImageMetadataCopyTagWithPath(self, parent, path) };
        ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
    }

    /// Searches the metadata for the specified tag, and returns its string value if it exists.
    ///
    /// Parameters:
    /// - metadata: The metadata object to search.
    ///
    /// - parent: The parent tag, if any. Specify `NULL` to start the search in the top-level tags of the metadata object. If this parameter is `NULL`, you must include a valid prefix string in the `path` parameter.
    ///
    /// - path: A string that represents the path to the tag. A path consists of the tag’s name, plus optional prefix and parent information. Separate prefix information from other path information using a colon (`:`) character. Separate parent and child tags using the period (`.`) character. For example, the string `“exif:Flash.RedEyeMode”` represents the path to the `RedEyeMode` field of the `Flash` parent structure in the EXIF metadata.
    ///
    /// When a tag contains an ordered or unordered array, specify elements using a `0`-based index inside square brackets. For example, use the string `“dc.subject[2]”` to access the third element in the `subject` array.
    ///
    /// When the tag contains an alternate-text array, access elements using an RFC 3066 language code inside square brackets. For example, use the string `“dc.description[de]”` to access the German description information.
    ///
    /// Use the ? character to delimit qualifiers for tags with string values. You may not use this character for arrays and structures.
    ///
    ///
    /// ## Return Value
    ///
    /// The string value for the specified tag, or `NULL` if the tag wasn’t found or doesn’t contain a string value.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// The XMP type of the property at the specified path must be [`kCGImageMetadataTypeString`](https://developer.apple.com/documentation/imageio/cgimagemetadatatype/string) or [`kCGImageMetadataTypeAlternateText`](https://developer.apple.com/documentation/imageio/cgimagemetadatatype/alternatetext). If the property contains alternate text, this function returns the element with the `x-default` language qualifier.
    ///
    ///
    /// Searches for a specific tag in a CGImageMetadataRef and returns its
    /// string value.
    ///
    /// This is a convenience method for searching for a tag at path and
    /// extracting the string value.
    ///
    /// Parameter `metadata`: A collection of metadata tags.
    ///
    /// Parameter `parent`: A parent tag. If NULL, the path is relative to the root of the
    /// CGImageMetadataRef (i.e. it is not a child of another property).
    ///
    /// Parameter `path`: A string with the path to the desired tag. Please consult
    /// the documentation of
    ///
    /// ```text
    ///  CGImageMetadataCopyTagWithPath
    /// ```
    ///
    /// for
    /// information about path syntax.
    ///
    /// Returns: Returns a string from a CGImageMetadataTag located at 'path'. The
    /// tag must be of type kCGImageMetadataTypeString or kCGImageMetadataTypeAlternateText.
    /// For AlternateText tags, the element with the "x-default" language qualifier
    /// will be returned. For other types, NULL will be returned.
    #[doc(alias = "CGImageMetadataCopyStringValueWithPath")]
    #[inline]
    pub unsafe fn string_value_with_path(
        &self,
        parent: Option<&CGImageMetadataTag>,
        path: &CFString,
    ) -> Option<CFRetained<CFString>> {
        extern "C-unwind" {
            fn CGImageMetadataCopyStringValueWithPath(
                metadata: &CGImageMetadata,
                parent: Option<&CGImageMetadataTag>,
                path: &CFString,
            ) -> Option<NonNull<CFString>>;
        }
        let ret = unsafe { CGImageMetadataCopyStringValueWithPath(self, parent, path) };
        ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
    }
}

impl CGMutableImageMetadata {
    /// Registers the specified namespace and prefix with the metadata object.
    ///
    /// Parameters:
    /// - metadata: The metadata object in which to register the namespace.
    ///
    /// - xmlns: The namespace to register. Specify a string with a custom namespace URI. A custom namespace must be a valid XML namespace. By convention, namespaces end with either the `/` or `#` character.
    ///
    /// - prefix: An abbreviation for the XML namespace. You must specify a valid string for custom namespace.
    ///
    /// - err: A pointer to an error object. If an error occurs, this function assigns an error object to this parameter.
    ///
    ///
    /// ## Return Value
    ///
    /// `true` if registration of the namespace was successful, or `false` if it wasn’t.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// All tags you add to a [`CGMutableImageMetadataRef`](https://developer.apple.com/documentation/imageio/cgmutableimagemetadata) object must belong to known namespaces. When you encounter an unrecognized prefix in a metadata path, call this function to register the prefix before you add the corresponding tag.
    ///
    /// You don’t need to register the standard metadata spaces, or any metadata spaces that are already present in the image’s metadata. Register only the namespaces you need to support additional metadata tags.
    ///
    /// If the namespace already exists and the `prefix` parameter conflicts with the already registered prefix, this function returns `false` and places an error object in the `err` parameter. However, if the prefix matches what’s registered, this method returns `true`.
    ///
    ///
    /// *!
    ///
    ///
    ///
    /// Associates an XMP namespace URI with a prefix string.
    ///
    /// This allows ImageIO to create custom metadata when it encounters
    /// an unrecognized prefix in a path (see CGImageMetadataCopyTagWithPath for more
    /// information about path syntax). A namespace must be registered before it can
    /// be used to add custom metadata. All namespaces found in the image's metadata,
    /// or defined as a constant above, will be pre-registered. Namespaces and
    /// prefixes must be unique.
    ///
    /// Returns: Returns true if successful. Returns false and sets 'err' if an error
    /// or conflict occurs.
    ///
    /// # Safety
    ///
    /// `err` must be a valid pointer or null.
    #[doc(alias = "CGImageMetadataRegisterNamespaceForPrefix")]
    #[inline]
    pub unsafe fn register_namespace_for_prefix(
        &self,
        xmlns: &CFString,
        prefix: &CFString,
        err: *mut *mut CFError,
    ) -> bool {
        extern "C-unwind" {
            fn CGImageMetadataRegisterNamespaceForPrefix(
                metadata: &CGMutableImageMetadata,
                xmlns: &CFString,
                prefix: &CFString,
                err: *mut *mut CFError,
            ) -> bool;
        }
        unsafe { CGImageMetadataRegisterNamespaceForPrefix(self, xmlns, prefix, err) }
    }

    /// Sets the tag at the specified path in the metadata object.
    ///
    /// Parameters:
    /// - metadata: The metadata object that contains the tag. If the tag doesn’t exist in this metadata object, this function creates a new tag.
    ///
    /// - parent: The parent tag, if any. Specify `NULL` to add or update a tag starting at the top-level of the metadata object. If this parameter is `NULL`, you must include a valid prefix string in the `path` parameter.
    ///
    /// If you specify a value for this parameter, this function modifies the children its children, which might create different references for those children. To fix the references, commit this object back to the metadata object using this function. Pass the parent’s full path string; don’t specify the parent using a parent object and relative path.
    ///
    /// - path: A string that represents the path to the tag. A path consists of the tag’s name, plus optional prefix and parent information. Separate prefix information from other path information using a colon (`:`) character. Separate parent and child tags using the period (`.`) character. For example, the string `“exif:Flash.RedEyeMode”` represents the path to the `RedEyeMode` field of the `Flash` parent structure in the EXIF metadata.
    ///
    /// When a tag contains an ordered or unordered array, specify elements using a `0`-based index inside square brackets. For example, use the string `“dc.subject[2]”` to access the third element in the `subject` array.
    ///
    /// When the tag contains an alternate-text array, access elements using an RFC 3066 language code inside square brackets. For example, use the string `“dc.description[de]”` to access the German description information.
    ///
    /// Use the ? character to delimit qualifiers for tags with string values. You may not use this character for arrays and structures.
    ///
    /// - tag: The tag object to add to the metadata. This function retains the tag object.
    ///
    ///
    /// ## Return Value
    ///
    /// `true` if the function saved the tag successfully, or `false` if it encountered a problem.
    ///
    ///
    /// Sets the tag at a specific path in a CGMutableImageMetadata container or a parent tag
    ///
    /// This is the primary function for adding new metadata tags to a
    /// metadata container, or updating existing tags. All tags required to reach
    /// the final tag (at the end of the path) will be created, if needed. Tags will
    /// created with default types (ordered arrays). Creating tags will fail if a
    /// prefix is encountered that has not been registered. Use
    ///
    /// ```text
    ///  CGImageMetadataRegisterNamespaceForPrefix
    /// ```
    ///
    /// to associate a prefix
    /// with a namespace prior to using a path-based CGImageMetadata function.
    /// Note that if a parent tag is provided,
    /// the children of that tag reference will be modified, which may be a different
    /// reference from the tag stored in the metadata container. Since tags are normally
    /// obtained as a copy, it is typically neccesary to use CGImageMetadataSetTagWithPath
    /// to commit the changed parent object back to the metadata container (using
    /// the parent's path and NULL for the parent).
    ///
    /// Parameter `metadata`: A mutable collection of metadata tags.
    /// Use
    ///
    /// ```text
    ///  CGImageMetadataCreateMutableCopy
    /// ```
    ///
    /// or
    ///
    /// ```text
    ///  CGImageMetadataCreateMutable
    /// ```
    ///
    /// to obtain a mutable metadata container.
    ///
    /// Parameter `parent`: A parent tag. If NULL, the path is relative to the root of the
    /// CGImageMetadataRef (i.e. it is not a child of another property).
    /// Note that if a parent tag is provided,
    /// the children of that tag reference will be modified, which may be a different
    /// reference from the tag stored in the metadata container. Since tags are normally
    /// obtained as a copy, it is typically neccesary to use CGImageMetadataSetTagWithPath
    /// to commit the changed parent object back to the metadata container (using
    /// the parent's path and NULL for the parent).
    ///
    /// Parameter `path`: A string with the path to the desired tag. Please consult
    /// the documentation of
    ///
    /// ```text
    ///  CGImageMetadataCopyTagWithPath
    /// ```
    ///
    /// for
    /// information about path syntax.
    ///
    /// Parameter `tag`: The CGImageMetadataTag to be added to the metadata. The tag
    /// will be retained.
    ///
    /// Returns: Returns true if successful, false otherwise.
    #[doc(alias = "CGImageMetadataSetTagWithPath")]
    #[inline]
    pub unsafe fn set_tag_with_path(
        &self,
        parent: Option<&CGImageMetadataTag>,
        path: &CFString,
        tag: &CGImageMetadataTag,
    ) -> bool {
        extern "C-unwind" {
            fn CGImageMetadataSetTagWithPath(
                metadata: &CGMutableImageMetadata,
                parent: Option<&CGImageMetadataTag>,
                path: &CFString,
                tag: &CGImageMetadataTag,
            ) -> bool;
        }
        unsafe { CGImageMetadataSetTagWithPath(self, parent, path, tag) }
    }

    /// Update the value of an existing metadata tag, or create a new tag using the specified information.
    ///
    /// Parameters:
    /// - metadata: The metadata object that contains the tag. If the tag doesn’t exist in this metadata object, this function creates a new tag.
    ///
    /// - parent: The parent tag, if any. Specify `NULL` to add or update a tag starting at the top-level of the metadata object. If this parameter is `NULL`, you must include a valid prefix string in the `path` parameter.
    ///
    /// - path: A string that represents the path to the tag. A path consists of the tag’s name, plus optional prefix and parent information. Separate prefix information from other path information using a colon (`:`) character. Separate parent and child tags using the period (`.`) character. For example, the string `“exif:Flash.RedEyeMode”` represents the path to the `RedEyeMode` field of the `Flash` parent structure in the EXIF metadata.
    ///
    /// When a tag contains an ordered or unordered array, specify elements using a `0`-based index inside square brackets. For example, use the string `“dc.subject[2]”` to access the third element in the `subject` array.
    ///
    /// When the tag contains an alternate-text array, access elements using an RFC 3066 language code inside square brackets. For example, use the string `“dc.description[de]”` to access the German description information.
    ///
    /// Use the ? character to delimit qualifiers for tags with string values. You may not use this character for arrays and structures.
    ///
    /// - value: The new value for the property. The new value’s type must match the expected XMP type of the property at the specified `path`.
    ///
    ///
    /// ## Return Value
    ///
    /// `true` if this function set the tag successfully, or `false` if a problem occurred.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// As needed, this function creates any intermediate tags that are required to create the tag at the specified path. This function creates each tag with default types. Tag creation fails if the path includes an unregistered prefix.
    ///
    /// If you specify a tag object in the `parent` parameter, this function modifies the children of that tag, which might create different references for those children. To fix the references, commit the changed parent back to the metadata object using the [`CGImageMetadataSetTagWithPath`](https://developer.apple.com/documentation/imageio/cgimagemetadatasettagwithpath(_:_:_:_:)) function. Pass the parent’s full path string when calling that function; don’t specify the parent using a parent object and relative path.
    ///
    ///
    /// Sets the value of the tag at a specific path in a CGMutableImageMetadataRef container or a parent tag
    ///
    /// This function is used to add new metadata values to a
    /// metadata container, or update existing tag values. All tags required to reach
    /// the final tag (at the end of the path) are created, if needed. Tags are
    /// created with default types (i.e. arrays will be ordered). Creating tags will
    /// fail if a prefix is encountered that has not been registered. Use
    ///
    /// ```text
    ///  CGImageMetadataRegisterNamespaceForPrefix
    /// ```
    ///
    /// to associate a prefix
    /// with a namespace prior to using a path-based CGImageMetadata function.
    ///
    /// Examples
    /// <ul>
    /// <li>
    /// 'path' = CFSTR("xmp:CreateDate"), 'value' = CFSTR("2011-09-20T14:54:47-08:00")
    /// </li>
    /// <li>
    /// 'path' = CFSTR("dc:subject[0]"), 'value' = CFSTR("San Francisco")
    /// </li>
    /// <li>
    /// 'path' = CFSTR("dc:subject[1]"), 'value' = CFSTR("Golden Gate Bridge")
    /// </li>
    /// <li>
    /// 'path' = CFSTR("dc:description[en]") 'value' = CFSTR("my image description")
    /// </li>
    /// <li>
    /// 'path' = CFSTR("dc:description[de]") 'value' = CFSTR("meine bildbeschreibung")
    /// </li>
    /// </ul>
    /// Note that if a parent tag is provided,
    /// the children of that tag reference will be modified, which may be a different
    /// reference from the tag stored in the metadata container. Since tags are normally
    /// obtained as a copy, it is typically neccesary to use CGImageMetadataSetTagWithPath
    /// to commit the changed parent object back to the metadata container (using
    /// the parent's path and NULL for the parent).
    ///
    /// Parameter `metadata`: A mutable collection of metadata tags.
    /// Use
    ///
    /// ```text
    ///  CGImageMetadataCreateMutableCopy
    /// ```
    ///
    /// or
    ///
    /// ```text
    ///  CGImageMetadataCreateMutable
    /// ```
    ///
    /// to obtain a mutable metadata container.
    ///
    /// Parameter `parent`: A parent tag. If NULL, the path is relative to the root of the
    /// CGImageMetadataRef (i.e. it is not a child of another property).
    ///
    /// Parameter `path`: A string with the path to the desired tag. Please consult
    /// the documentation of
    ///
    /// ```text
    ///  CGImageMetadataCopyTagWithPath
    /// ```
    ///
    /// for
    /// information about path syntax.
    ///
    /// Parameter `value`: The value to be added to the CGImageMetadataTag matching the path.
    /// The tag will be retained. The restrictions for the value are the same as in
    ///
    /// ```text
    ///  CGImageMetadataTagCreate
    /// ```
    ///
    /// .
    ///
    /// Returns: Returns true if successful, false otherwise.
    ///
    /// # Safety
    ///
    /// `value` should be of the correct type.
    #[doc(alias = "CGImageMetadataSetValueWithPath")]
    #[inline]
    pub unsafe fn set_value_with_path(
        &self,
        parent: Option<&CGImageMetadataTag>,
        path: &CFString,
        value: &CFType,
    ) -> bool {
        extern "C-unwind" {
            fn CGImageMetadataSetValueWithPath(
                metadata: &CGMutableImageMetadata,
                parent: Option<&CGImageMetadataTag>,
                path: &CFString,
                value: &CFType,
            ) -> bool;
        }
        unsafe { CGImageMetadataSetValueWithPath(self, parent, path, value) }
    }

    /// Removes the tag at the specified path from the metadata object.
    ///
    /// Parameters:
    /// - metadata: The metadata object that contains the tag. If the tag doesn’t exist in this metadata object, this function creates a new tag.
    ///
    /// - parent: The parent tag, if any. Specify `NULL` to add or update a tag starting at the top-level of the metadata object. If this parameter is `NULL`, you must include a valid prefix string in the `path` parameter.
    ///
    /// If you specify a value for this parameter, this function modifies the children its children, which might create different references for those children. To fix the references, commit this object back to the metadata object using this function. Pass the parent’s full path string; don’t specify the parent using a parent object and relative path.
    ///
    /// - path: A string that represents the path to the tag. A path consists of the tag’s name, plus optional prefix and parent information. Separate prefix information from other path information using a colon (`:`) character. Separate parent and child tags using the period (`.`) character. For example, the string `“exif:Flash.RedEyeMode”` represents the path to the `RedEyeMode` field of the `Flash` parent structure in the EXIF metadata.
    ///
    /// When a tag contains an ordered or unordered array, specify elements using a `0`-based index inside square brackets. For example, use the string `“dc.subject[2]”` to access the third element in the `subject` array.
    ///
    /// When the tag contains an alternate-text array, access elements using an RFC 3066 language code inside square brackets. For example, use the string `“dc.description[de]”` to access the German description information.
    ///
    /// Use the ? character to delimit qualifiers for tags with string values. You may not use this character for arrays and structures.
    ///
    ///
    /// ## Return Value
    ///
    /// True if this function removed the tag, or false if it encountered a problem.
    ///
    ///
    /// Removes the tag at a specific path from a CGMutableImageMetadata container or from the parent tag
    ///
    /// Use this function to delete a metadata tag matching a specific
    /// path from a mutable metadata container. Note that if a parent tag is provided,
    /// the children of that tag reference will be modified, which may be a different
    /// reference from the tag stored in the metadata container. Since tags are normally
    /// obtained as a copy, it is typically neccesary to use CGImageMetadataSetTagWithPath
    /// to commit the changed parent object back to the metadata container (using
    /// the parent's path and NULL for the parent).
    ///
    /// Parameter `parent`: A parent tag. If NULL, the path is relative to the root of the
    /// CGImageMetadataRef (i.e. it is not a child of another property).
    ///
    /// Parameter `path`: A string with the path to the desired tag. Please consult
    /// the documentation of
    ///
    /// ```text
    ///  CGImageMetadataCopyTagWithPath
    /// ```
    ///
    /// for
    /// information about path syntax.
    #[doc(alias = "CGImageMetadataRemoveTagWithPath")]
    #[inline]
    pub unsafe fn remove_tag_with_path(
        &self,
        parent: Option<&CGImageMetadataTag>,
        path: &CFString,
    ) -> bool {
        extern "C-unwind" {
            fn CGImageMetadataRemoveTagWithPath(
                metadata: &CGMutableImageMetadata,
                parent: Option<&CGImageMetadataTag>,
                path: &CFString,
            ) -> bool;
        }
        unsafe { CGImageMetadataRemoveTagWithPath(self, parent, path) }
    }
}

/// The block to execute when enumerating the tags of a metadata object.
///
/// Parameters:
/// - path: The full path to the tag in the metadata container.
///
/// - tag: The [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag) object that contains the tag information. Never modify this object from your block. If you want to change the tag, save a reference to it and make your changes later.
///
///
/// ## Return Value
///
/// `true` to continue enumerating the tags, or `false` to stop.
///
///
/// The block type used by CGImageMetadataEnumerateTagsUsingBlock
///
/// Parameter `path`: The full path to the tag in the metadata container.
///
/// Parameter `tag`: The CGImageMetadataTagRef corresponding to the path in metadata.
///
/// Returns: Return true to continue iterating through the tags, or return false to stop.
#[cfg(feature = "block2")]
pub type CGImageMetadataTagBlock =
    *mut block2::DynBlock<dyn Fn(NonNull<CFString>, NonNull<CGImageMetadataTag>) -> bool>;

impl CGImageMetadata {
    /// Enumerates the tags of a metadata object and executes the specified block on each tag.
    ///
    /// Parameters:
    /// - metadata: The metadata object that contains the tags to enumerate.
    ///
    /// - rootPath: A string that contains the path to the root tag. Specify `NULL` to enumerate the top-level tags in the metadata object.
    ///
    /// A path consists of the tag’s name, plus optional prefix and parent information. Separate prefix information from other path information using a colon (`:`) character. Separate parent and child tags using the period (`.`) character. For example, the string `“exif:Flash.RedEyeMode”` represents the path to the `RedEyeMode` field of the `Flash` parent structure in the EXIF metadata.
    ///
    /// When a tag contains an ordered or unordered array, specify elements using a `0`-based index inside square brackets. For example, use the string `“dc.subject[2]”` to access the third element in the `subject` array.
    ///
    /// When the tag contains an alternate-text array, access elements using an RFC 3066 language code inside square brackets. For example, use the string `“dc.description[de]”` to access the German description information.
    ///
    /// Use the ? character to delimit qualifiers for tags with string values. You may not use this character for arrays and structures.
    ///
    /// - options: A dictionary of additional options. Currently, the only supported option is [`kCGImageMetadataEnumerateRecursively`](https://developer.apple.com/documentation/imageio/kcgimagemetadataenumeraterecursively).
    ///
    /// - block: The block to execute for each tag. For more information, see [`CGImageMetadataTagBlock`](https://developer.apple.com/documentation/imageio/cgimagemetadatatagblock).
    ///
    ///
    /// ## Discussion
    ///
    /// This function iterates over the tags in the specified metadata object. By default, it iterates over only the top-level tags. Include the [`kCGImageMetadataEnumerateRecursively`](https://developer.apple.com/documentation/imageio/kcgimagemetadataenumeraterecursively) constant in the `options` parameter to iterate over all tags recursively.
    ///
    /// You must not modify the tag information from your block. Instead, use your block only to read information from the tags. If you need to modify any tags, add those tags to a collection object and modify them after this function finishes its enumeration.
    ///
    ///
    /// Executes a given block using each tag in the metadata
    ///
    /// This function iterates over all of the tags in a
    /// CGImageMetadataRef, executing the block for each tag. The default behavior
    /// iterates over all top-level tags in the metadata. The path of the tag and
    /// the tag itself is passed to the block. The metadata cannot be modified inside
    /// the block - consider adding the tags of interest into another collection.
    ///
    /// Parameter `metadata`: A collection of metadata tags.
    ///
    /// Parameter `rootPath`: Iteration will occur for all children of the tag matching
    /// the root path. Please refer to CGImageMetadataCopyTagWithPath for information
    /// about path syntax. If NULL or an empty string, the block will be executed
    /// for all top-level tags in the metadata container.
    ///
    /// Parameter `options`: A dictionary of options for iterating through the tags.
    /// Currently the only supported option is kCGImageMetadataEnumerateRecursively,
    /// which should be set to a CFBoolean.
    ///
    /// Parameter `block`: The block that is executed for each tag in metadata.
    ///
    /// # Safety
    ///
    /// - `options` generic must be of the correct type.
    /// - `options` generic must be of the correct type.
    /// - `block` must be a valid pointer.
    #[doc(alias = "CGImageMetadataEnumerateTagsUsingBlock")]
    #[cfg(feature = "block2")]
    #[inline]
    pub unsafe fn enumerate_tags_using_block(
        &self,
        root_path: Option<&CFString>,
        options: Option<&CFDictionary>,
        block: CGImageMetadataTagBlock,
    ) {
        extern "C-unwind" {
            fn CGImageMetadataEnumerateTagsUsingBlock(
                metadata: &CGImageMetadata,
                root_path: Option<&CFString>,
                options: Option<&CFDictionary>,
                block: CGImageMetadataTagBlock,
            );
        }
        unsafe { CGImageMetadataEnumerateTagsUsingBlock(self, root_path, options, block) }
    }
}

extern "C" {
    /// An option to enumerate recursively through a set of metadata tags.
    ///
    /// ## Discussion
    ///
    /// The value of this key is a [`CFBooleanRef`](https://developer.apple.com/documentation/corefoundation/cfboolean). Set the value to [`kOSBooleanTrue`](https://developer.apple.com/documentation/driverkit/kosbooleantrue) to enumerate all tags recursively. Set the value to [`kCFBooleanFalse`](https://developer.apple.com/documentation/corefoundation/kcfbooleanfalse) to enumerate only the direct children of the root path you specify.
    ///
    /// When you call [`CGImageMetadataEnumerateTagsUsingBlock`](https://developer.apple.com/documentation/imageio/cgimagemetadataenumeratetagsusingblock(_:_:_:_:)), include this option if you want the enumeration behavior to search recursively through the available tags. If you don’t specify this key, the function behaves as if the value is false.
    ///
    ///
    pub static kCGImageMetadataEnumerateRecursively: &'static CFString;
}

impl CGImageMetadata {
    /// Searches for the specified image property and, if found, returns the corresponding tag object.
    ///
    /// Parameters:
    /// - metadata: The metadata object to search.
    ///
    /// - dictionaryName: The metadata subdictionary to which the image property belongs. For example, specify [`kCGImagePropertyExifDictionary`](https://developer.apple.com/documentation/imageio/kcgimagepropertyexifdictionary) for image properties that are part of the image’s EXIF metadata.
    ///
    /// - propertyName: The name of the property. For example, specify [`kCGImagePropertyTIFFOrientation`](https://developer.apple.com/documentation/imageio/kcgimagepropertytifforientation), [`kCGImagePropertyExifDateTimeOriginal`](https://developer.apple.com/documentation/imageio/kcgimagepropertyexifdatetimeoriginal), or [`kCGImagePropertyIPTCKeywords`](https://developer.apple.com/documentation/imageio/kcgimagepropertyiptckeywords). If the specified property is unsupported by the metadata object, this function logs a warning.
    ///
    ///
    /// ## Return Value
    ///
    /// The [`CGImageMetadataTagRef`](https://developer.apple.com/documentation/imageio/cgimagemetadatatag) object that corresponds to the specified property, or `NULL` if the property wasn’t found.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Use this function to quickly search the different metadata dictionaries for a specific tag. The returned tag object contains appropriate values for all fields, including the namespace, prefix, and XMP type.
    ///
    /// When you request an EXIF or IPTC property, this function fills in the namespace, prefix, and XMP type information by copying information from an appropriate XMP type. For example, when you request the [`kCGImagePropertyExifDateTimeOriginal`](https://developer.apple.com/documentation/imageio/kcgimagepropertyexifdatetimeoriginal) property, the function fills in the information using the `photoshop:DateTime` XMP tag. When this bridging occurs, property fields retain their XMP format, rather than the EXIF or IPTC format.
    ///
    ///
    /// *!
    ///
    ///
    ///
    /// Searches for a specific CGImageMetadataTag matching a kCGImageProperty constant
    ///
    /// Provides a bridge for values from CGImageCopyPropertiesAtIndex, simplifying
    /// access for properties defined in EXIF and IPTC standards, which have no notion of
    /// namespaces, prefixes, or XMP property types.
    /// Metadata Working Group guidance is factored into the mapping of CGImageProperties to
    /// XMP compatible CGImageMetadataTags.
    /// For example, kCGImagePropertyExifDateTimeOriginal will get the value of the
    /// corresponding XMP tag, which is photoshop:DateCreated. Note that property values will
    /// still be in their XMP forms, such as "YYYY-MM-DDThh:mm:ss" for DateTime, rather than
    /// the EXIF or IPTC DateTime formats.
    ///
    /// Parameter `metadata`: A collection of metadata tags
    ///
    /// Parameter `dictionaryName`: the metadata subdictionary to which the image property belongs,
    /// such as kCGImagePropertyExifDictionary or kCGImagePropertyIPTCDictionary. Not all
    /// dictionaries and properties are supported at this time.
    ///
    /// Parameter `propertyName`: the name of the property. This must be a defined property constant
    /// corresponding to the 'dictionaryName'. For example, kCGImagePropertyTIFFOrientation,
    /// kCGImagePropertyExifDateTimeOriginal, or kCGImagePropertyIPTCKeywords. A warning
    /// will be logged if the CGImageProperty is unsupported by CGImageMetadata.
    ///
    /// Returns: Returns a CGImageMetadataTagRef with the appropriate namespace, prefix,
    /// tag name, and XMP value for the corresponding CGImageProperty. Returns NULL if the
    /// property could not be found.
    #[doc(alias = "CGImageMetadataCopyTagMatchingImageProperty")]
    #[inline]
    pub unsafe fn tag_matching_image_property(
        &self,
        dictionary_name: &CFString,
        property_name: &CFString,
    ) -> Option<CFRetained<CGImageMetadataTag>> {
        extern "C-unwind" {
            fn CGImageMetadataCopyTagMatchingImageProperty(
                metadata: &CGImageMetadata,
                dictionary_name: &CFString,
                property_name: &CFString,
            ) -> Option<NonNull<CGImageMetadataTag>>;
        }
        let ret = unsafe {
            CGImageMetadataCopyTagMatchingImageProperty(self, dictionary_name, property_name)
        };
        ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
    }
}

impl CGMutableImageMetadata {
    /// Updates the value of the metadata tag assigned to the specified image property.
    ///
    /// Parameters:
    /// - metadata: The metadata object that contains the tag.
    ///
    /// - dictionaryName: The metadata subdictionary to which the image property belongs. For example, specify [`kCGImagePropertyExifDictionary`](https://developer.apple.com/documentation/imageio/kcgimagepropertyexifdictionary) for image properties that are part of the image’s EXIF metadata. This function doesn’t support all dictionaries.
    ///
    /// - propertyName: The name of the property. For example, specify [`kCGImagePropertyTIFFOrientation`](https://developer.apple.com/documentation/imageio/kcgimagepropertytifforientation), [`kCGImagePropertyExifDateTimeOriginal`](https://developer.apple.com/documentation/imageio/kcgimagepropertyexifdatetimeoriginal), or [`kCGImagePropertyIPTCKeywords`](https://developer.apple.com/documentation/imageio/kcgimagepropertyiptckeywords). If the specified property is unsupported by the metadata object, this function logs a warning.
    ///
    /// - value: The new value for the property. The new value’s type must match the XMP type of the metadata tag.
    ///
    ///
    /// ## Return Value
    ///
    /// `true` if this function set the tag successfully, or `false` if a problem occurred.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Use this function to update the value of a property in the specified metadata collection. If you try to set the value of an EXIF or IPTC property, this function matches it to an appropriate XMP tag. For example, when you set the value of the [`kCGImagePropertyExifDateTimeOriginal`](https://developer.apple.com/documentation/imageio/kcgimagepropertyexifdatetimeoriginal) property, this function sets the value of the `photoshop:DateTime` XMP tag.
    ///
    /// If the metdata object doesn’t contain the tag, this function creates it and populates it with appropriate XMP information.
    ///
    ///
    /// Sets the value of the CGImageMetadataTag matching a kCGImageProperty constant
    ///
    /// Provides a bridge for values from CGImageCopyPropertiesAtIndex, simplifying
    /// changing property values defined in EXIF and IPTC standards, which have no notion of
    /// namespaces, prefixes, or XMP property types.
    /// Metadata Working Group guidance is factored into the mapping of CGImageProperties to
    /// XMP compatible CGImageMetadataTags.
    /// For example, setting kCGImagePropertyExifDateTimeOriginal will set the value of the
    /// corresponding XMP tag, which is photoshop:DateCreated. Note that property values should
    /// still be in their XMP forms, such as "YYYY-MM-DDThh:mm:ss" for DateTime, rather than
    /// the EXIF or IPTC DateTime formats. Although this function will allow the caller to set
    /// custom values for these properties, you should consult the appropriate specifications
    /// for details about property value formats for EXIF and IPTC tags in XMP.
    ///
    /// Parameter `metadata`: A mutable collection of metadata tags
    ///
    /// Parameter `dictionaryName`: the metadata subdictionary to which the image property belongs,
    /// such as kCGImagePropertyExifDictionary or kCGImagePropertyIPTCDictionary. Not all
    /// dictionaries and properties are supported at this time.
    ///
    /// Parameter `propertyName`: the name of the property. This must be a defined property constant
    /// corresponding to the 'dictionaryName'. For example, kCGImagePropertyTIFFOrientation,
    /// kCGImagePropertyExifDateTimeOriginal, or kCGImagePropertyIPTCKeywords. A warning
    /// will be logged if the CGImageProperty is unsupported by CGImageMetadata.
    ///
    /// Parameter `value`: A CFTypeRef with the value for the tag. The same value restrictions apply
    /// as in
    ///
    /// ```text
    ///  CGImageMetadataTagCreate
    /// ```
    ///
    /// .
    ///
    /// Returns: Returns true if successful, false otherwise.
    ///
    /// # Safety
    ///
    /// `value` should be of the correct type.
    #[doc(alias = "CGImageMetadataSetValueMatchingImageProperty")]
    #[inline]
    pub unsafe fn set_value_matching_image_property(
        &self,
        dictionary_name: &CFString,
        property_name: &CFString,
        value: &CFType,
    ) -> bool {
        extern "C-unwind" {
            fn CGImageMetadataSetValueMatchingImageProperty(
                metadata: &CGMutableImageMetadata,
                dictionary_name: &CFString,
                property_name: &CFString,
                value: &CFType,
            ) -> bool;
        }
        unsafe {
            CGImageMetadataSetValueMatchingImageProperty(
                self,
                dictionary_name,
                property_name,
                value,
            )
        }
    }
}

impl CGImageMetadata {
    /// Returns a data object that contains the metadata object’s contents serialized into the XMP format.
    ///
    /// Parameters:
    /// - metadata: The metadata object to serialize. The function converts all tags in this object to XMP data.
    ///
    /// - options: Additional options for the serialization process. Options aren’t currently supported, so specify `NULL`.
    ///
    ///
    /// ## Return Value
    ///
    /// A [`CFDataRef`](https://developer.apple.com/documentation/corefoundation/cfdata) object with an XMP representation of the metadata, or `NULL` if an error occurs.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Use this function to create sidecar files with metadata for image formats that don’t support embedded XMP, or that you cannot edit due to other format restrictions. For example, use this function to create the data for proprietary RAW camera formats.
    ///
    ///
    /// Serializes the CGImageMetadataRef to XMP data
    ///
    /// This converts all of the metadata tags to a block of XMP data. Common uses
    /// include creating sidecar files that contain metadata for image formats that do not
    /// support embedded XMP, or cannot be edited due to other format restrictions (such as
    /// proprietary RAW camera formats).
    ///
    /// Parameter `metadata`: A collection of metadata tags.
    ///
    /// Parameter `options`: should be NULL. Options are currently not used, but may be used in
    /// future release.
    ///
    /// Returns: Returns a CFData containing an XMP representation of the metadata. Returns
    /// NULL if an error occurred.
    ///
    /// # Safety
    ///
    /// - `options` generic must be of the correct type.
    /// - `options` generic must be of the correct type.
    #[doc(alias = "CGImageMetadataCreateXMPData")]
    #[inline]
    pub unsafe fn xmp_data(&self, options: Option<&CFDictionary>) -> Option<CFRetained<CFData>> {
        extern "C-unwind" {
            fn CGImageMetadataCreateXMPData(
                metadata: &CGImageMetadata,
                options: Option<&CFDictionary>,
            ) -> Option<NonNull<CFData>>;
        }
        let ret = unsafe { CGImageMetadataCreateXMPData(self, options) };
        ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
    }

    /// Creates a collection of metadata tags from the specified XMP data.
    ///
    /// Parameters:
    /// - data: An object containin XMP data. The contents of this object must represent a complete XMP tree. The XMP data may include packet headers.
    ///
    ///
    /// ## Return Value
    ///
    /// A [`CGImageMetadataRef`](https://developer.apple.com/documentation/imageio/cgimagemetadata) object that contains the parsed metadata information, or `NULL` if an error occurs. You are responsible for releasing the returned object.
    ///
    ///
    ///
    /// ## Discussion
    ///
    /// Use this function to parse the raw XMP data from an image and build a parseable set of metadata tags. Use the returned object to enumerate the tags or search for individual tags within the collection.
    ///
    ///
    /// Creates a collection of CGImageMetadataTags from a block of XMP data
    ///
    /// Converts XMP data into a collection of metadata tags.
    /// The data must be a complete XMP tree. XMP packet  headers (
    /// <
    /// ?xpacket .. ?>) are
    /// supported.
    ///
    /// Parameter `data`: The XMP data.
    ///
    /// Returns: Returns a collection of CGImageMetadata tags. Returns NULL if an error occurred.
    #[doc(alias = "CGImageMetadataCreateFromXMPData")]
    #[inline]
    pub unsafe fn from_xmp_data(data: &CFData) -> Option<CFRetained<CGImageMetadata>> {
        extern "C-unwind" {
            fn CGImageMetadataCreateFromXMPData(data: &CFData) -> Option<NonNull<CGImageMetadata>>;
        }
        let ret = unsafe { CGImageMetadataCreateFromXMPData(data) };
        ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
    }
}

extern "C" {
    /// The domain for metadata-related errors that originate in the Image I/O framework.
    /// Error domain for all errors originating in ImageIO for CGImageMetadata APIs.
    /// Error codes may be interpreted using the list below.
    pub static kCFErrorDomainCGImageMetadata: &'static CFString;
}

/// Constants for errors that occur when getting or setting metadata information.
/// the list of all error codes returned under the error domain kCFErrorDomainCGImageMetadata
// NS_ENUM
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord, Default)]
pub struct CGImageMetadataErrors(pub i32);
impl CGImageMetadataErrors {
    /// An error that indicates an unknown condition occurred.
    #[doc(alias = "kCGImageMetadataErrorUnknown")]
    pub const Unknown: Self = Self(0);
    /// An error that indicates the metadata was in an unsupported format.
    #[doc(alias = "kCGImageMetadataErrorUnsupportedFormat")]
    pub const UnsupportedFormat: Self = Self(1);
    /// An error that indicates a parameter was malformed or contained invalid data.
    #[doc(alias = "kCGImageMetadataErrorBadArgument")]
    pub const BadArgument: Self = Self(2);
    /// An error that indicates an attempt to save conflicting metadata values.
    #[doc(alias = "kCGImageMetadataErrorConflictingArguments")]
    pub const ConflictingArguments: Self = Self(3);
    /// An error that indicates an attempt to register a namespace with a prefix that is different than the namespace’s existing prefix.
    #[doc(alias = "kCGImageMetadataErrorPrefixConflict")]
    pub const PrefixConflict: Self = Self(4);
}

#[cfg(feature = "objc2")]
unsafe impl Encode for CGImageMetadataErrors {
    const ENCODING: Encoding = i32::ENCODING;
}

#[cfg(feature = "objc2")]
unsafe impl RefEncode for CGImageMetadataErrors {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

#[deprecated = "renamed to `CGMutableImageMetadata::new`"]
#[inline]
pub unsafe extern "C-unwind" fn CGImageMetadataCreateMutable() -> CFRetained<CGMutableImageMetadata>
{
    extern "C-unwind" {
        fn CGImageMetadataCreateMutable() -> Option<NonNull<CGMutableImageMetadata>>;
    }
    let ret = unsafe { CGImageMetadataCreateMutable() };
    let ret = ret.expect("function was marked as returning non-null, but actually returned NULL");
    unsafe { CFRetained::from_raw(ret) }
}

#[deprecated = "renamed to `CGMutableImageMetadata::new_copy`"]
#[inline]
pub unsafe extern "C-unwind" fn CGImageMetadataCreateMutableCopy(
    metadata: &CGImageMetadata,
) -> Option<CFRetained<CGMutableImageMetadata>> {
    extern "C-unwind" {
        fn CGImageMetadataCreateMutableCopy(
            metadata: &CGImageMetadata,
        ) -> Option<NonNull<CGMutableImageMetadata>>;
    }
    let ret = unsafe { CGImageMetadataCreateMutableCopy(metadata) };
    ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
}

#[deprecated = "renamed to `CGImageMetadataTag::new`"]
#[inline]
pub unsafe extern "C-unwind" fn CGImageMetadataTagCreate(
    xmlns: &CFString,
    prefix: Option<&CFString>,
    name: &CFString,
    r#type: CGImageMetadataType,
    value: &CFType,
) -> Option<CFRetained<CGImageMetadataTag>> {
    extern "C-unwind" {
        fn CGImageMetadataTagCreate(
            xmlns: &CFString,
            prefix: Option<&CFString>,
            name: &CFString,
            r#type: CGImageMetadataType,
            value: &CFType,
        ) -> Option<NonNull<CGImageMetadataTag>>;
    }
    let ret = unsafe { CGImageMetadataTagCreate(xmlns, prefix, name, r#type, value) };
    ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
}

#[deprecated = "renamed to `CGImageMetadataTag::namespace`"]
#[inline]
pub unsafe extern "C-unwind" fn CGImageMetadataTagCopyNamespace(
    tag: &CGImageMetadataTag,
) -> Option<CFRetained<CFString>> {
    extern "C-unwind" {
        fn CGImageMetadataTagCopyNamespace(tag: &CGImageMetadataTag) -> Option<NonNull<CFString>>;
    }
    let ret = unsafe { CGImageMetadataTagCopyNamespace(tag) };
    ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
}

#[deprecated = "renamed to `CGImageMetadataTag::prefix`"]
#[inline]
pub unsafe extern "C-unwind" fn CGImageMetadataTagCopyPrefix(
    tag: &CGImageMetadataTag,
) -> Option<CFRetained<CFString>> {
    extern "C-unwind" {
        fn CGImageMetadataTagCopyPrefix(tag: &CGImageMetadataTag) -> Option<NonNull<CFString>>;
    }
    let ret = unsafe { CGImageMetadataTagCopyPrefix(tag) };
    ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
}

#[deprecated = "renamed to `CGImageMetadataTag::name`"]
#[inline]
pub unsafe extern "C-unwind" fn CGImageMetadataTagCopyName(
    tag: &CGImageMetadataTag,
) -> Option<CFRetained<CFString>> {
    extern "C-unwind" {
        fn CGImageMetadataTagCopyName(tag: &CGImageMetadataTag) -> Option<NonNull<CFString>>;
    }
    let ret = unsafe { CGImageMetadataTagCopyName(tag) };
    ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
}

#[deprecated = "renamed to `CGImageMetadataTag::value`"]
#[inline]
pub unsafe extern "C-unwind" fn CGImageMetadataTagCopyValue(
    tag: &CGImageMetadataTag,
) -> Option<CFRetained<CFType>> {
    extern "C-unwind" {
        fn CGImageMetadataTagCopyValue(tag: &CGImageMetadataTag) -> Option<NonNull<CFType>>;
    }
    let ret = unsafe { CGImageMetadataTagCopyValue(tag) };
    ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
}

extern "C-unwind" {
    #[deprecated = "renamed to `CGImageMetadataTag::type`"]
    pub fn CGImageMetadataTagGetType(tag: &CGImageMetadataTag) -> CGImageMetadataType;
}

#[deprecated = "renamed to `CGImageMetadataTag::qualifiers`"]
#[inline]
pub unsafe extern "C-unwind" fn CGImageMetadataTagCopyQualifiers(
    tag: &CGImageMetadataTag,
) -> Option<CFRetained<CFArray>> {
    extern "C-unwind" {
        fn CGImageMetadataTagCopyQualifiers(tag: &CGImageMetadataTag) -> Option<NonNull<CFArray>>;
    }
    let ret = unsafe { CGImageMetadataTagCopyQualifiers(tag) };
    ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
}

#[deprecated = "renamed to `CGImageMetadata::tags`"]
#[inline]
pub unsafe extern "C-unwind" fn CGImageMetadataCopyTags(
    metadata: &CGImageMetadata,
) -> Option<CFRetained<CFArray>> {
    extern "C-unwind" {
        fn CGImageMetadataCopyTags(metadata: &CGImageMetadata) -> Option<NonNull<CFArray>>;
    }
    let ret = unsafe { CGImageMetadataCopyTags(metadata) };
    ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
}

#[deprecated = "renamed to `CGImageMetadata::tag_with_path`"]
#[inline]
pub unsafe extern "C-unwind" fn CGImageMetadataCopyTagWithPath(
    metadata: &CGImageMetadata,
    parent: Option<&CGImageMetadataTag>,
    path: &CFString,
) -> Option<CFRetained<CGImageMetadataTag>> {
    extern "C-unwind" {
        fn CGImageMetadataCopyTagWithPath(
            metadata: &CGImageMetadata,
            parent: Option<&CGImageMetadataTag>,
            path: &CFString,
        ) -> Option<NonNull<CGImageMetadataTag>>;
    }
    let ret = unsafe { CGImageMetadataCopyTagWithPath(metadata, parent, path) };
    ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
}

#[deprecated = "renamed to `CGImageMetadata::string_value_with_path`"]
#[inline]
pub unsafe extern "C-unwind" fn CGImageMetadataCopyStringValueWithPath(
    metadata: &CGImageMetadata,
    parent: Option<&CGImageMetadataTag>,
    path: &CFString,
) -> Option<CFRetained<CFString>> {
    extern "C-unwind" {
        fn CGImageMetadataCopyStringValueWithPath(
            metadata: &CGImageMetadata,
            parent: Option<&CGImageMetadataTag>,
            path: &CFString,
        ) -> Option<NonNull<CFString>>;
    }
    let ret = unsafe { CGImageMetadataCopyStringValueWithPath(metadata, parent, path) };
    ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
}

extern "C-unwind" {
    #[deprecated = "renamed to `CGMutableImageMetadata::register_namespace_for_prefix`"]
    pub fn CGImageMetadataRegisterNamespaceForPrefix(
        metadata: &CGMutableImageMetadata,
        xmlns: &CFString,
        prefix: &CFString,
        err: *mut *mut CFError,
    ) -> bool;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CGMutableImageMetadata::set_tag_with_path`"]
    pub fn CGImageMetadataSetTagWithPath(
        metadata: &CGMutableImageMetadata,
        parent: Option<&CGImageMetadataTag>,
        path: &CFString,
        tag: &CGImageMetadataTag,
    ) -> bool;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CGMutableImageMetadata::set_value_with_path`"]
    pub fn CGImageMetadataSetValueWithPath(
        metadata: &CGMutableImageMetadata,
        parent: Option<&CGImageMetadataTag>,
        path: &CFString,
        value: &CFType,
    ) -> bool;
}

extern "C-unwind" {
    #[deprecated = "renamed to `CGMutableImageMetadata::remove_tag_with_path`"]
    pub fn CGImageMetadataRemoveTagWithPath(
        metadata: &CGMutableImageMetadata,
        parent: Option<&CGImageMetadataTag>,
        path: &CFString,
    ) -> bool;
}

extern "C-unwind" {
    #[cfg(feature = "block2")]
    #[deprecated = "renamed to `CGImageMetadata::enumerate_tags_using_block`"]
    pub fn CGImageMetadataEnumerateTagsUsingBlock(
        metadata: &CGImageMetadata,
        root_path: Option<&CFString>,
        options: Option<&CFDictionary>,
        block: CGImageMetadataTagBlock,
    );
}

#[deprecated = "renamed to `CGImageMetadata::tag_matching_image_property`"]
#[inline]
pub unsafe extern "C-unwind" fn CGImageMetadataCopyTagMatchingImageProperty(
    metadata: &CGImageMetadata,
    dictionary_name: &CFString,
    property_name: &CFString,
) -> Option<CFRetained<CGImageMetadataTag>> {
    extern "C-unwind" {
        fn CGImageMetadataCopyTagMatchingImageProperty(
            metadata: &CGImageMetadata,
            dictionary_name: &CFString,
            property_name: &CFString,
        ) -> Option<NonNull<CGImageMetadataTag>>;
    }
    let ret = unsafe {
        CGImageMetadataCopyTagMatchingImageProperty(metadata, dictionary_name, property_name)
    };
    ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
}

extern "C-unwind" {
    #[deprecated = "renamed to `CGMutableImageMetadata::set_value_matching_image_property`"]
    pub fn CGImageMetadataSetValueMatchingImageProperty(
        metadata: &CGMutableImageMetadata,
        dictionary_name: &CFString,
        property_name: &CFString,
        value: &CFType,
    ) -> bool;
}

#[deprecated = "renamed to `CGImageMetadata::xmp_data`"]
#[inline]
pub unsafe extern "C-unwind" fn CGImageMetadataCreateXMPData(
    metadata: &CGImageMetadata,
    options: Option<&CFDictionary>,
) -> Option<CFRetained<CFData>> {
    extern "C-unwind" {
        fn CGImageMetadataCreateXMPData(
            metadata: &CGImageMetadata,
            options: Option<&CFDictionary>,
        ) -> Option<NonNull<CFData>>;
    }
    let ret = unsafe { CGImageMetadataCreateXMPData(metadata, options) };
    ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
}

#[deprecated = "renamed to `CGImageMetadata::from_xmp_data`"]
#[inline]
pub unsafe extern "C-unwind" fn CGImageMetadataCreateFromXMPData(
    data: &CFData,
) -> Option<CFRetained<CGImageMetadata>> {
    extern "C-unwind" {
        fn CGImageMetadataCreateFromXMPData(data: &CFData) -> Option<NonNull<CGImageMetadata>>;
    }
    let ret = unsafe { CGImageMetadataCreateFromXMPData(data) };
    ret.map(|ret| unsafe { CFRetained::from_raw(ret) })
}
