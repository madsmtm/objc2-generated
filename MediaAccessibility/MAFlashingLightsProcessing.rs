//! This file has been automatically generated by `objc2`'s `header-translator`.
//! DO NOT EDIT
use core::ffi::*;
use core::ptr::NonNull;
#[cfg(feature = "objc2")]
use objc2::__framework_prelude::*;
use objc2_core_foundation::*;
#[cfg(feature = "objc2-foundation")]
use objc2_foundation::*;
#[cfg(feature = "objc2-io-surface")]
use objc2_io_surface::*;

use crate::*;

#[cfg(feature = "objc2")]
extern_class!(
    /// An object that reports the result of the flashing lights processor.
    ///
    /// ## Overview
    ///
    /// An [`MAFlashingLightsProcessorResult`](https://developer.apple.com/documentation/mediaaccessibility/maflashinglightsprocessorresult) object is the result of calling [`processSurface:outSurface:timestamp:options:`](https://developer.apple.com/documentation/mediaaccessibility/maflashinglightsprocessor/processsurface:outsurface:timestamp:options:). This object indicates whether the method successfully processed the input surface, the intensity of flashing lights in the input surface, and the amount of mitigation in the output surface.
    ///
    ///
    #[unsafe(super(NSObject))]
    #[derive(Debug, PartialEq, Eq, Hash)]
    #[cfg(feature = "objc2")]
    pub struct MAFlashingLightsProcessorResult;
);

#[cfg(feature = "objc2")]
extern_conformance!(
    unsafe impl NSObjectProtocol for MAFlashingLightsProcessorResult {}
);

#[cfg(feature = "objc2")]
impl MAFlashingLightsProcessorResult {
    extern_methods!(
        #[unsafe(method(surfaceProcessed))]
        #[unsafe(method_family = none)]
        pub unsafe fn surfaceProcessed(&self) -> bool;

        #[unsafe(method(mitigationLevel))]
        #[unsafe(method_family = none)]
        pub unsafe fn mitigationLevel(&self) -> c_float;

        #[unsafe(method(intensityLevel))]
        #[unsafe(method_family = none)]
        pub unsafe fn intensityLevel(&self) -> c_float;
    );
}

/// Methods declared on superclass `NSObject`.
#[cfg(feature = "objc2")]
impl MAFlashingLightsProcessorResult {
    extern_methods!(
        #[unsafe(method(init))]
        #[unsafe(method_family = init)]
        pub unsafe fn init(this: Allocated<Self>) -> Retained<Self>;

        #[unsafe(method(new))]
        #[unsafe(method_family = new)]
        pub unsafe fn new() -> Retained<Self>;
    );
}

/// Options for the flashing lights processor.
// NS_TYPED_EXTENSIBLE_ENUM
#[cfg(feature = "objc2-foundation")]
pub type MAFlashingLightsProcessorOptionKey = NSString;

#[cfg(feature = "objc2")]
extern_class!(
    /// A class that processes a framebuffer object to detect and dim sequences of flashing lights.
    ///
    /// ## Overview
    ///
    /// A device with the Dim Flashing Lights setting on automatically dims the brightness of flashing effect sequences when it detects them in video content. If your app performs custom video drawing instead of using [`AVFoundation`](https://developer.apple.com/documentation/avfoundation) APIs, you can use the [`MAFlashingLightsProcessor`](https://developer.apple.com/documentation/mediaaccessibility/maflashinglightsprocessor) class to detect and mitigate sequences of flashing effects in your video content.
    ///
    /// The following example shows how you might incorporate [`MAFlashingLightsProcessor`](https://developer.apple.com/documentation/mediaaccessibility/maflashinglightsprocessor) into code that uses [`Core Video`](https://developer.apple.com/documentation/corevideo) APIs.
    ///
    /// ```swift
    /// import MediaAccessibility
    /// import CoreVideo
    /// import OSLog
    ///
    /// private let processor = MAFlashingLightsProcessor()
    /// private let logger = Logger()
    ///
    /// func readVideoBuffer() {
    ///     
    ///     // Confirm that the Dim Flashing Lights setting is on before processing video.
    ///     if !MADimFlashingLightsEnabled() { return }
    ///
    ///     // Retrieve the CVPixelBuffer from your video content.
    ///     // ...
    ///     
    ///     // Get the IOSurface that backs the pixel buffer.
    ///     guard let inSurface = CVPixelBufferGetIOSurface(pixelBuffer)?.takeUnretainedValue() else {
    ///         logger.debug("Can't initialize input surface.")
    ///         return
    ///     }
    ///     
    ///     // Use the properties of the pixel buffer to initialize an output IOSurface.
    ///     guard var outSurface = IOSurface(properties: [
    ///         .width: CVPixelBufferGetWidth(pixelBuffer),
    ///         .height: CVPixelBufferGetHeight(pixelBuffer),
    ///         .bytesPerRow: CVPixelBufferGetWidth(pixelBuffer) * 4,
    ///         .bytesPerElement: 4,
    ///         .pixelFormat: CVPixelBufferGetPixelFormatType(pixelBuffer)
    ///     ]) as IOSurfaceRef? else {
    ///         logger.debug("Can't initialize output surface.")
    ///         return
    ///     }
    ///     
    ///     // Verify that the input IOSurface is compatible with the flashing lights processor.
    ///     if processor.canProcessSurface(inSurface) {
    ///         
    ///         // Analyze input IOSurface for flashing light sequences
    ///         // and write mitigated content to output IOSurface.
    ///         let result = processor.processSurface(inSurface, outSurface: &outSurface,
    ///                                               timestamp: CFAbsoluteTimeGetCurrent())
    ///         
    ///         if result.surfaceProcessed {
    ///             logger.debug("""
    ///             Processed content with flashing lights intensity \(result.intensityLevel)
    ///             and mitigated output with mitigation level \(result.mitigationLevel).
    ///             """)
    ///             
    ///             // Convert the mitigated output surface back to CVPixelBuffer
    ///             // and draw the video content.
    ///             // ...
    ///             
    ///         } else {
    ///             logger.debug("Can't process input surface.")
    ///         }
    ///     }
    /// }
    /// ```
    ///
    /// For more information, see [Flashing lights](https://developer.apple.com/documentation/mediaaccessibility/flashing-lights).
    ///
    ///
    #[unsafe(super(NSObject))]
    #[derive(Debug, PartialEq, Eq, Hash)]
    #[cfg(feature = "objc2")]
    pub struct MAFlashingLightsProcessor;
);

#[cfg(feature = "objc2")]
extern_conformance!(
    unsafe impl NSObjectProtocol for MAFlashingLightsProcessor {}
);

#[cfg(feature = "objc2")]
impl MAFlashingLightsProcessor {
    extern_methods!(
        #[cfg(feature = "objc2-io-surface")]
        /// Determines whether the flashing lights processor is able to process the content in the surface for flashing lights. This might be false on
        /// unsupported hardware or unsupported color spaces.
        ///
        /// Returns: A boolean result.
        #[unsafe(method(canProcessSurface:))]
        #[unsafe(method_family = none)]
        pub unsafe fn canProcessSurface(&self, surface: &IOSurfaceRef) -> bool;

        #[cfg(all(feature = "objc2-foundation", feature = "objc2-io-surface"))]
        /// Processes an inSurface by analyzing pixels for sequences of flashing lights and then darkens content to reduce the risk of discomfort from some users.
        /// The outSurface will contain the mitigated content.
        /// The timestamp indicates the time at which the surface will be shown in the video playback. FPS will be determined based on the values of the timestamps.
        /// Options dictionary for additional parameters.
        ///
        /// Returns: An object which indicates whether the surface was able to be processed, the amount of mitigation that was applied, and the intensitry level that was detected.
        ///
        /// # Safety
        ///
        /// `options` generic should be of the correct type.
        #[unsafe(method(processSurface:outSurface:timestamp:options:))]
        #[unsafe(method_family = none)]
        pub unsafe fn processSurface_outSurface_timestamp_options(
            &self,
            in_surface: &IOSurfaceRef,
            out_surface: &IOSurfaceRef,
            timestamp: CFAbsoluteTime,
            options: Option<&NSDictionary<MAFlashingLightsProcessorOptionKey, AnyObject>>,
        ) -> Retained<MAFlashingLightsProcessorResult>;
    );
}

/// Methods declared on superclass `NSObject`.
#[cfg(feature = "objc2")]
impl MAFlashingLightsProcessor {
    extern_methods!(
        #[unsafe(method(init))]
        #[unsafe(method_family = init)]
        pub unsafe fn init(this: Allocated<Self>) -> Retained<Self>;

        #[unsafe(method(new))]
        #[unsafe(method_family = new)]
        pub unsafe fn new() -> Retained<Self>;
    );
}
