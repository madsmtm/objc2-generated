//! This file has been automatically generated by `objc2`'s `header-translator`.
//! DO NOT EDIT
use core::ffi::*;
use core::ptr::NonNull;
use objc2::__framework_prelude::*;
#[cfg(feature = "objc2-core-foundation")]
use objc2_core_foundation::*;
use objc2_foundation::*;

use crate::*;

extern_class!(
    /// Stores information about a single update from a Metal display link instance.
    #[unsafe(super(NSObject))]
    #[derive(Debug, PartialEq, Eq, Hash)]
    pub struct CAMetalDisplayLinkUpdate;
);

extern_conformance!(
    unsafe impl NSObjectProtocol for CAMetalDisplayLinkUpdate {}
);

impl CAMetalDisplayLinkUpdate {
    extern_methods!(
        #[cfg(all(feature = "CAMetalLayer", feature = "objc2-metal"))]
        #[unsafe(method(drawable))]
        #[unsafe(method_family = none)]
        pub fn drawable(&self) -> Retained<ProtocolObject<dyn CAMetalDrawable>>;

        #[cfg(feature = "objc2-core-foundation")]
        #[unsafe(method(targetTimestamp))]
        #[unsafe(method_family = none)]
        pub fn targetTimestamp(&self) -> CFTimeInterval;

        #[cfg(feature = "objc2-core-foundation")]
        #[unsafe(method(targetPresentationTimestamp))]
        #[unsafe(method_family = none)]
        pub fn targetPresentationTimestamp(&self) -> CFTimeInterval;
    );
}

/// Methods declared on superclass `NSObject`.
impl CAMetalDisplayLinkUpdate {
    extern_methods!(
        #[unsafe(method(init))]
        #[unsafe(method_family = init)]
        pub fn init(this: Allocated<Self>) -> Retained<Self>;

        #[unsafe(method(new))]
        #[unsafe(method_family = new)]
        pub fn new() -> Retained<Self>;
    );
}

impl DefaultRetained for CAMetalDisplayLinkUpdate {
    #[inline]
    fn default_retained() -> Retained<Self> {
        Self::new()
    }
}

extern_protocol!(
    /// A protocol your app implements to respond to callbacks from Core Animation for a Metal display link.
    ///
    /// ## Overview
    ///
    /// Your app responds to the system on behalf of a [`CAMetalDisplayLink`](https://developer.apple.com/documentation/quartzcore/cametaldisplaylink) with this protocol. Implement a type that adopts the protocol and assign an instance of it to a display link’s [`delegate`](https://developer.apple.com/documentation/quartzcore/cametaldisplaylink/delegate) property.
    ///
    ///
    pub unsafe trait CAMetalDisplayLinkDelegate {
        #[unsafe(method(metalDisplayLink:needsUpdate:))]
        #[unsafe(method_family = none)]
        fn metalDisplayLink_needsUpdate(
            &self,
            link: &CAMetalDisplayLink,
            update: &CAMetalDisplayLinkUpdate,
        );
    }
);

extern_class!(
    /// A class your Metal app uses to register for callbacks to synchronize its animations for a display.
    ///
    /// ## Overview
    ///
    /// [`CAMetalDisplayLink`](https://developer.apple.com/documentation/quartzcore/cametaldisplaylink) instances are a specialized way to interact with variable-rate displays when you need more control over the timing window to render your app’s frames. Controlling the timing window and rendering delay for frames can help you achieve smoother frame rates and avoid visual artifacts.
    ///
    /// <div class="warning">
    ///
    /// ### Tip
    ///  When working with less visually intensive apps or apps which don’t use Metal, use [`CADisplayLink`](https://developer.apple.com/documentation/quartzcore/cadisplaylink) to handle variable refresh rates.
    ///
    ///
    ///
    /// </div>
    /// Your app initializes a new Metal display link by providing a target [`CAMetalLayer`](https://developer.apple.com/documentation/quartzcore/cametallayer). Set this instance’s [`delegate`](https://developer.apple.com/documentation/quartzcore/cametaldisplaylink/delegate) property to an implementation that encodes the rendering work for Metal to perform. With a set delegate, synchronize the display with a run loop to perform rendering on by calling the [`addToRunLoop:forMode:`](https://developer.apple.com/documentation/quartzcore/cametaldisplaylink/add(to:formode:)) method.
    ///
    /// Once you associate the display link with a run loop, the system calls the delegate’s [`metalDisplayLink:needsUpdate:`](https://developer.apple.com/documentation/quartzcore/cametaldisplaylinkdelegate/metaldisplaylink(_:needsupdate:)) method to request new frames. This method receives update requests based on the [`preferredFrameRateRange`](https://developer.apple.com/documentation/quartzcore/cametaldisplaylink/preferredframeraterange) and [`preferredFrameLatency`](https://developer.apple.com/documentation/quartzcore/cametaldisplaylink/preferredframelatency) of the display link. The system makes a best effort to make callbacks at appropriate times. Your app should complete any commits to the Metal device’s [`MTLCommandQueue`](https://developer.apple.com/documentation/metal/mtlcommandqueue) for rendering the display layer before calling [`present`](https://developer.apple.com/documentation/metal/mtldrawable/present()) on a drawable element.
    ///
    /// Your app can disable notifications by setting [`paused`](https://developer.apple.com/documentation/quartzcore/cametaldisplaylink/ispaused) to `true`. When your app finishes with a display link, call [`invalidate`](https://developer.apple.com/documentation/quartzcore/cametaldisplaylink/invalidate())to remove it from all run loops and the target.
    ///
    ///
    #[unsafe(super(NSObject))]
    #[derive(Debug, PartialEq, Eq, Hash)]
    pub struct CAMetalDisplayLink;
);

extern_conformance!(
    unsafe impl NSObjectProtocol for CAMetalDisplayLink {}
);

impl CAMetalDisplayLink {
    extern_methods!(
        #[cfg(all(feature = "CALayer", feature = "CAMetalLayer"))]
        #[unsafe(method(initWithMetalLayer:))]
        #[unsafe(method_family = init)]
        pub fn initWithMetalLayer(this: Allocated<Self>, layer: &CAMetalLayer) -> Retained<Self>;

        /// # Safety
        ///
        /// `runloop` possibly has additional threading requirements.
        #[unsafe(method(addToRunLoop:forMode:))]
        #[unsafe(method_family = none)]
        pub unsafe fn addToRunLoop_forMode(&self, runloop: &NSRunLoop, mode: &NSRunLoopMode);

        /// # Safety
        ///
        /// `runloop` possibly has additional threading requirements.
        #[unsafe(method(removeFromRunLoop:forMode:))]
        #[unsafe(method_family = none)]
        pub unsafe fn removeFromRunLoop_forMode(&self, runloop: &NSRunLoop, mode: &NSRunLoopMode);

        #[unsafe(method(invalidate))]
        #[unsafe(method_family = none)]
        pub fn invalidate(&self);

        #[unsafe(method(delegate))]
        #[unsafe(method_family = none)]
        pub fn delegate(&self) -> Option<Retained<ProtocolObject<dyn CAMetalDisplayLinkDelegate>>>;

        /// Setter for [`delegate`][Self::delegate].
        ///
        /// This is a [weak property][objc2::topics::weak_property].
        #[unsafe(method(setDelegate:))]
        #[unsafe(method_family = none)]
        pub fn setDelegate(
            &self,
            delegate: Option<&ProtocolObject<dyn CAMetalDisplayLinkDelegate>>,
        );

        #[unsafe(method(preferredFrameLatency))]
        #[unsafe(method_family = none)]
        pub fn preferredFrameLatency(&self) -> c_float;

        /// Setter for [`preferredFrameLatency`][Self::preferredFrameLatency].
        #[unsafe(method(setPreferredFrameLatency:))]
        #[unsafe(method_family = none)]
        pub fn setPreferredFrameLatency(&self, preferred_frame_latency: c_float);

        #[cfg(feature = "CAFrameRateRange")]
        #[unsafe(method(preferredFrameRateRange))]
        #[unsafe(method_family = none)]
        pub fn preferredFrameRateRange(&self) -> CAFrameRateRange;

        #[cfg(feature = "CAFrameRateRange")]
        /// Setter for [`preferredFrameRateRange`][Self::preferredFrameRateRange].
        #[unsafe(method(setPreferredFrameRateRange:))]
        #[unsafe(method_family = none)]
        pub fn setPreferredFrameRateRange(&self, preferred_frame_rate_range: CAFrameRateRange);

        #[unsafe(method(isPaused))]
        #[unsafe(method_family = none)]
        pub fn isPaused(&self) -> bool;

        /// Setter for [`isPaused`][Self::isPaused].
        #[unsafe(method(setPaused:))]
        #[unsafe(method_family = none)]
        pub fn setPaused(&self, paused: bool);
    );
}

/// Methods declared on superclass `NSObject`.
impl CAMetalDisplayLink {
    extern_methods!(
        #[unsafe(method(init))]
        #[unsafe(method_family = init)]
        pub fn init(this: Allocated<Self>) -> Retained<Self>;

        #[unsafe(method(new))]
        #[unsafe(method_family = new)]
        pub fn new() -> Retained<Self>;
    );
}

impl DefaultRetained for CAMetalDisplayLink {
    #[inline]
    fn default_retained() -> Retained<Self> {
        Self::new()
    }
}
