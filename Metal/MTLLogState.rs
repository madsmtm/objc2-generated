//! This file has been automatically generated by `objc2`'s `header-translator`.
//! DO NOT EDIT
use core::ffi::*;
use core::ptr::NonNull;
use objc2::__framework_prelude::*;
use objc2_foundation::*;

use crate::*;

/// The supported log levels for shader logging.
/// The level of the log entry.
// NS_ENUM
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord, Default)]
pub struct MTLLogLevel(pub NSInteger);
impl MTLLogLevel {
    /// The log level when the log level hasn’t been configured.
    #[doc(alias = "MTLLogLevelUndefined")]
    pub const Undefined: Self = Self(0);
    /// The log level that captures diagnostic information.
    #[doc(alias = "MTLLogLevelDebug")]
    pub const Debug: Self = Self(1);
    /// The log level that captures additional information.
    #[doc(alias = "MTLLogLevelInfo")]
    pub const Info: Self = Self(2);
    /// The log level that captures notifications.
    #[doc(alias = "MTLLogLevelNotice")]
    pub const Notice: Self = Self(3);
    /// The log level that captures error information.
    #[doc(alias = "MTLLogLevelError")]
    pub const Error: Self = Self(4);
    /// The log level that captures fault information.
    #[doc(alias = "MTLLogLevelFault")]
    pub const Fault: Self = Self(5);
}

unsafe impl Encode for MTLLogLevel {
    const ENCODING: Encoding = NSInteger::ENCODING;
}

unsafe impl RefEncode for MTLLogLevel {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}

extern_protocol!(
    /// A container for shader log messages.
    ///
    /// ## Overview
    ///
    /// Create an [`MTLCommandQueue`](https://developer.apple.com/documentation/metal/mtlcommandqueue) or [`MTLCommandBuffer`](https://developer.apple.com/documentation/metal/mtlcommandbuffer) with a log state to hold messages logged from shaders. Attach a log state to a command buffer by assigning it to the command buffer descriptor’s [`logState`](https://developer.apple.com/documentation/metal/mtlcommandbufferdescriptor/logstate). Similarly, to attach a log state to a command queue, use the command queue descriptor’s [`logState`](https://developer.apple.com/documentation/metal/mtlcommandqueuedescriptor/logstate).
    ///
    /// When you attach a log state to a command queue, the command queue shares the log state with all the command buffers it creates. If you attach different log states to a command buffer and command queue, then the system uses the state attached to the command buffer.
    ///
    /// Because logging incurs an overhead, regardless of whether the system prints messages, you must explicitly enable logging with [`enableLogging`](https://developer.apple.com/documentation/metal/mtlcompileoptions/enablelogging).
    ///
    ///
    pub unsafe trait MTLLogState: NSObjectProtocol + Send + Sync {
        #[cfg(feature = "block2")]
        /// Add a function block to handle log message output.
        /// In the absence of any handlers, log messages go through the default handler.
        ///
        /// # Safety
        ///
        /// `block` block must be sendable.
        #[unsafe(method(addLogHandler:))]
        #[unsafe(method_family = none)]
        unsafe fn addLogHandler(
            &self,
            block: &block2::DynBlock<
                dyn Fn(*mut NSString, *mut NSString, MTLLogLevel, NonNull<NSString>),
            >,
        );
    }
);

extern_class!(
    /// An interface that represents a log state configuration.
    ///
    /// ## Overview
    ///
    /// Configure the descriptor to create an [`MTLLogState`](https://developer.apple.com/documentation/metal/mtllogstate) by calling [`newLogStateWithDescriptor:error:`](https://developer.apple.com/documentation/metal/mtldevice/makelogstate(descriptor:)).
    ///
    /// If you’ve set the environment variables `MTL_LOG_BUFFER_SIZE` or `MTL_LOG_LEVEL`, then the system automatically enables logging. If any command buffer or command queue has an attached log state, then the system uses the log state’s settings instead of the environment variable values.
    ///
    ///
    #[unsafe(super(NSObject))]
    #[derive(Debug, PartialEq, Eq, Hash)]
    pub struct MTLLogStateDescriptor;
);

extern_conformance!(
    unsafe impl NSCopying for MTLLogStateDescriptor {}
);

unsafe impl CopyingHelper for MTLLogStateDescriptor {
    type Result = Self;
}

extern_conformance!(
    unsafe impl NSObjectProtocol for MTLLogStateDescriptor {}
);

impl MTLLogStateDescriptor {
    extern_methods!(
        /// level indicates the minimum level of the logs that will be printed.
        ///
        /// All the logs with level less than given level will be skipped on the GPU Side.
        #[unsafe(method(level))]
        #[unsafe(method_family = none)]
        pub fn level(&self) -> MTLLogLevel;

        /// Setter for [`level`][Self::level].
        #[unsafe(method(setLevel:))]
        #[unsafe(method_family = none)]
        pub fn setLevel(&self, level: MTLLogLevel);

        /// bufferSize indicates the size of the buffer where GPU will store the logging content from shaders. Minimum value is 1KB
        #[unsafe(method(bufferSize))]
        #[unsafe(method_family = none)]
        pub fn bufferSize(&self) -> NSInteger;

        /// Setter for [`bufferSize`][Self::bufferSize].
        ///
        /// # Safety
        ///
        /// This might not be bounds-checked.
        #[unsafe(method(setBufferSize:))]
        #[unsafe(method_family = none)]
        pub unsafe fn setBufferSize(&self, buffer_size: NSInteger);
    );
}

/// Methods declared on superclass `NSObject`.
impl MTLLogStateDescriptor {
    extern_methods!(
        #[unsafe(method(init))]
        #[unsafe(method_family = init)]
        pub fn init(this: Allocated<Self>) -> Retained<Self>;

        #[unsafe(method(new))]
        #[unsafe(method_family = new)]
        pub fn new() -> Retained<Self>;
    );
}

impl DefaultRetained for MTLLogStateDescriptor {
    #[inline]
    fn default_retained() -> Retained<Self> {
        Self::new()
    }
}

extern "C" {
    pub static MTLLogStateErrorDomain: &'static NSErrorDomain;
}

/// NSErrors raised when creating a logstate.
// NS_ENUM
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord)]
pub struct MTLLogStateError(pub NSUInteger);
impl MTLLogStateError {
    #[doc(alias = "MTLLogStateErrorInvalidSize")]
    pub const InvalidSize: Self = Self(1);
    #[doc(alias = "MTLLogStateErrorInvalid")]
    pub const Invalid: Self = Self(2);
}

unsafe impl Encode for MTLLogStateError {
    const ENCODING: Encoding = NSUInteger::ENCODING;
}

unsafe impl RefEncode for MTLLogStateError {
    const ENCODING_REF: Encoding = Encoding::Pointer(&Self::ENCODING);
}
