//! This file has been automatically generated by `objc2`'s `header-translator`.
//! DO NOT EDIT
use core::ffi::*;
use core::ptr::NonNull;
use objc2::__framework_prelude::*;
use objc2_foundation::*;

use crate::*;

extern_class!(
    /// Use within an application's `com.apple.photos.background-upload` extension to create and change ``PHAssetResourceUploadJob`` records.
    ///
    /// When the extension's principal class receives a call to `process` background uploads, it can create new ``PHAssetResourceUploadJob``s through calls to perform changes on a PHPhotoLibrary using ``PHAssetResourceUploadJobChangeRequest`` and any in-flight upload jobs can be handled by updating their state to mark them as acknowledged, or to be retried. The maximum number of jobs that can be in flight is limited to the ``PHAssetResourceUploadJob.jobLimit``.
    ///
    /// ``PHAssetResourceUploadJobChangeRequest`` can only be created or used within a photo library change block. For details on change blocks, see ``PHPhotoLibrary``.
    ///
    /// See also [Apple's documentation](https://developer.apple.com/documentation/photos/phassetresourceuploadjobchangerequest?language=objc)
    #[unsafe(super(PHChangeRequest, NSObject))]
    #[derive(Debug, PartialEq, Eq, Hash)]
    #[cfg(feature = "PHChangeRequest")]
    pub struct PHAssetResourceUploadJobChangeRequest;
);

#[cfg(feature = "PHChangeRequest")]
extern_conformance!(
    unsafe impl NSObjectProtocol for PHAssetResourceUploadJobChangeRequest {}
);

#[cfg(feature = "PHChangeRequest")]
impl PHAssetResourceUploadJobChangeRequest {
    extern_methods!(
        #[cfg(feature = "PHAssetResource")]
        /// Creates an asset resource upload job.
        ///
        /// If the number of jobs exceeds ``PHAssetResourceUploadJob/jobLimit`` the photo library ``performChanges`` request will fail with a ``PHPhotosErrorLimitExceeded`` error.
        /// To generate jobs after this limit is triggered, you must acknowledge succeeded/failed jobs, and wait for the registered/pending ones to finish uploading, which will make those jobs also succeeded/failed.
        ///
        /// - Parameter:
        /// - destination: the destination
        /// <doc
        /// ://com.apple.documentation/foundation/nsurlrequest> to which this asset resource will be sent.
        /// - resource: the asset resource to be uploaded.
        #[unsafe(method(createJobWithDestination:resource:))]
        #[unsafe(method_family = none)]
        pub unsafe fn createJobWithDestination_resource(
            destination: &NSURLRequest,
            resource: &PHAssetResource,
        );

        #[cfg(all(feature = "PHAssetResourceUploadJob", feature = "PHObject"))]
        /// Creates a request for modifying the specified upload job.
        ///
        /// - Parameter job: a job to be modified.
        #[unsafe(method(changeRequestForUploadJob:))]
        #[unsafe(method_family = none)]
        pub unsafe fn changeRequestForUploadJob(
            job: &PHAssetResourceUploadJob,
        ) -> Option<Retained<Self>>;

        /// Acknowledges a successful or failed job. Jobs must be acknowledged to free up space for ``PHAssetResourceUploadJob/jobLimit``.
        #[unsafe(method(acknowledge))]
        #[unsafe(method_family = none)]
        pub unsafe fn acknowledge(&self);

        /// Retries a job that is failed, unacknowledged, and has not been retried before. Successful retries also free up space for ``PHAssetResourceUploadJob/jobLimit``.
        #[unsafe(method(retryWithDestination:))]
        #[unsafe(method_family = none)]
        pub unsafe fn retryWithDestination(&self, destination: Option<&NSURLRequest>);
    );
}

/// Methods declared on superclass `NSObject`.
#[cfg(feature = "PHChangeRequest")]
impl PHAssetResourceUploadJobChangeRequest {
    extern_methods!(
        #[unsafe(method(init))]
        #[unsafe(method_family = init)]
        pub unsafe fn init(this: Allocated<Self>) -> Retained<Self>;

        #[unsafe(method(new))]
        #[unsafe(method_family = new)]
        pub unsafe fn new() -> Retained<Self>;
    );
}
