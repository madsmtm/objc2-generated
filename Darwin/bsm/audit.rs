//! This file has been automatically generated by `objc2`'s `header-translator`.
//! DO NOT EDIT
use core::ffi::*;

use crate::ffi::*;

pub type au_id_t = uid_t;

pub type au_asid_t = pid_t;

pub type au_event_t = u16;

pub type au_emod_t = u16;

pub type au_class_t = u32;

pub type au_asflgs_t = u64;

pub type au_ctlmode_t = c_uchar;

#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct au_tid {
    pub port: dev_t,
    pub machine: u32,
}

pub type au_tid_t = au_tid;

#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct au_tid_addr {
    pub at_port: dev_t,
    pub at_type: u32,
    pub at_addr: [u32; 4],
}

pub type au_tid_addr_t = au_tid_addr;

#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct au_mask {
    /// Success bits.
    pub am_success: c_uint,
    /// Failure bits.
    pub am_failure: c_uint,
}

pub type au_mask_t = au_mask;

#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct auditinfo {
    /// Audit user ID.
    pub ai_auid: au_id_t,
    /// Audit masks.
    pub ai_mask: au_mask_t,
    /// Terminal ID.
    pub ai_termid: au_tid_t,
    /// Audit session ID.
    pub ai_asid: au_asid_t,
}

pub type auditinfo_t = auditinfo;

#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct auditinfo_addr {
    /// Audit user ID.
    pub ai_auid: au_id_t,
    /// Audit masks.
    pub ai_mask: au_mask_t,
    /// Terminal ID.
    pub ai_termid: au_tid_addr_t,
    /// Audit session ID.
    pub ai_asid: au_asid_t,
    /// Audit session flags.
    pub ai_flags: au_asflgs_t,
}

pub type auditinfo_addr_t = auditinfo_addr;

#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct auditpinfo {
    /// ID of target process.
    pub ap_pid: pid_t,
    /// Audit user ID.
    pub ap_auid: au_id_t,
    /// Audit masks.
    pub ap_mask: au_mask_t,
    /// Terminal ID.
    pub ap_termid: au_tid_t,
    /// Audit session ID.
    pub ap_asid: au_asid_t,
}

pub type auditpinfo_t = auditpinfo;

#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct auditpinfo_addr {
    /// ID of target process.
    pub ap_pid: pid_t,
    /// Audit user ID.
    pub ap_auid: au_id_t,
    /// Audit masks.
    pub ap_mask: au_mask_t,
    /// Terminal ID.
    pub ap_termid: au_tid_addr_t,
    /// Audit session ID.
    pub ap_asid: au_asid_t,
    /// Audit session flags.
    pub ap_flags: au_asflgs_t,
}

pub type auditpinfo_addr_t = auditpinfo_addr;

#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct au_session {
    /// Ptr to full audit info.
    pub as_aia_p: *mut auditinfo_addr_t,
    /// Process Audit Masks.
    pub as_mask: au_mask_t,
}

pub type au_session_t = au_session;

#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct au_expire_after {
    /// Age after which trail files should be expired
    pub age: time_t,
    /// Aggregate trail size when files should be expired
    pub size: usize,
    /// Operator used with the above values to determine when files should be expired
    pub op_type: c_uchar,
}

pub type au_expire_after_t = au_expire_after;

/// Contents of token_t are opaque outside of libbsm.
pub type token_t = au_token;

/// Kernel audit queue control parameters:
/// Default:        Maximum:
/// aq_hiwater:    AQ_HIWATER (100)    AQ_MAXHIGH (10000)
/// aq_lowater:    AQ_LOWATER (10)
/// <aq
/// _hiwater
/// aq_bufsz:    AQ_BUFSZ (32767)    AQ_MAXBUFSZ (1048576)
/// aq_delay:    20            20000 (not used)
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct au_qctrl {
    /// Max # of audit recs in queue when
    ///
    /// threads with new ARs get blocked.
    pub aq_hiwater: c_int,
    /// # of audit recs in queue when
    ///
    /// blocked threads get unblocked.
    pub aq_lowater: c_int,
    /// Max size of audit record for audit(2).
    pub aq_bufsz: c_int,
    /// Queue delay (not used).
    pub aq_delay: c_int,
    /// Minimum filesystem percent free space.
    pub aq_minfree: c_int,
}

pub type au_qctrl_t = au_qctrl;

/// Structure for the audit statistics.
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct audit_stat {
    pub as_version: c_uint,
    pub as_numevent: c_uint,
    pub as_generated: c_int,
    pub as_nonattrib: c_int,
    pub as_kernel: c_int,
    pub as_audit: c_int,
    pub as_auditctl: c_int,
    pub as_enqueue: c_int,
    pub as_written: c_int,
    pub as_wblocked: c_int,
    pub as_rblocked: c_int,
    pub as_dropped: c_int,
    pub as_totalsize: c_int,
    pub as_memused: c_uint,
}

pub type au_stat_t = audit_stat;

/// Structure for the audit file statistics.
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct audit_fstat {
    pub af_filesz: u64,
    pub af_currsz: u64,
}

pub type au_fstat_t = audit_fstat;

/// Audit to event class mapping.
#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq)]
pub struct au_evclass_map {
    pub ec_number: au_event_t,
    pub ec_class: au_class_t,
}

pub type au_evclass_map_t = au_evclass_map;

/// Audit session flags for the ai_flags member of auditinfo_addr.
#[repr(transparent)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord)]
pub struct audit_session_flags(pub c_uint);
impl audit_session_flags {
    /// The initial session created by PID 1.
    pub const AU_SESSION_FLAG_IS_INITIAL: Self = Self(0x0001);
    /// The graphics subsystem (CoreGraphics, etc.) is available.
    pub const AU_SESSION_FLAG_HAS_GRAPHIC_ACCESS: Self = Self(0x0010);
    /// /dev/tty is available.
    pub const AU_SESSION_FLAG_HAS_TTY: Self = Self(0x0020);
    /// The session was created for a remote connection.
    pub const AU_SESSION_FLAG_IS_REMOTE: Self = Self(0x1000);
    /// The console and associated devices are available.
    pub const AU_SESSION_FLAG_HAS_CONSOLE_ACCESS: Self = Self(0x2000);
    /// An active, authenticated user is associated with the session.
    pub const AU_SESSION_FLAG_HAS_AUTHENTICATED: Self = Self(0x4000);
}

extern "C-unwind" {
    #[deprecated = "audit is deprecated"]
    pub fn audit(param1: *const c_void, param1: c_int) -> c_int;
}

extern "C-unwind" {
    #[deprecated = "audit is deprecated"]
    pub fn auditon(param1: c_int, param1: *mut c_void, param1: c_int) -> c_int;
}

extern "C-unwind" {
    #[deprecated = "audit is deprecated"]
    pub fn auditctl(param1: *const c_char) -> c_int;
}

extern "C-unwind" {
    pub fn getauid(param1: *mut au_id_t) -> c_int;
}

extern "C-unwind" {
    pub fn setauid(param1: *const au_id_t) -> c_int;
}

extern "C-unwind" {
    pub fn getaudit_addr(param1: *mut auditinfo_addr, param1: c_int) -> c_int;
}

extern "C-unwind" {
    pub fn setaudit_addr(param1: *const auditinfo_addr, param1: c_int) -> c_int;
}

extern "C-unwind" {
    /// getaudit()/setaudit() are deprecated and have been replaced with
    /// wrappers to the getaudit_addr()/setaudit_addr() syscalls above.
    #[deprecated]
    pub fn getaudit(param1: *mut auditinfo) -> c_int;
}

extern "C-unwind" {
    #[deprecated]
    pub fn setaudit(param1: *const auditinfo) -> c_int;
}

extern "C-unwind" {
    pub fn audit_session_self() -> mach_port_name_t;
}

extern "C-unwind" {
    pub fn audit_session_join(port: mach_port_name_t) -> au_asid_t;
}

extern "C-unwind" {
    pub fn audit_session_port(asid: au_asid_t, portname: *mut mach_port_name_t) -> c_int;
}
